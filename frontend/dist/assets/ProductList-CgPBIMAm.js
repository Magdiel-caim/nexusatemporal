import{j as e}from"./data-vendor-DkslvP0H.js";import{r as a}from"./react-vendor-C5Agepg6.js";import{s as b,u as g,w as O}from"./index-DNdWYF4P.js";import{z as i,aK as F,S as q,ai as w,a5 as j,d as L,aL as $,m as D}from"./ui-vendor-CNf7S7pz.js";function z({onEdit:N,refreshKey:f}){const[o,k]=a.useState([]),[v,u]=a.useState(!0),[x,S]=a.useState(""),[l,E]=a.useState(""),[n,P]=a.useState(!1),[m,C]=a.useState(!0);a.useEffect(()=>{h()},[f,l,n,m]);const h=async()=>{try{u(!0);const t=await b.getProducts({search:x||void 0,category:l||void 0,lowStock:n,isActive:m});k(t.data||[])}catch(t){console.error("Erro ao carregar produtos:",t),i.error("Erro ao carregar produtos")}finally{u(!1)}},T=()=>{h()},A=async t=>{if(confirm(`Tem certeza que deseja excluir o produto "${t.name}"?`))try{await b.deleteProduct(t.id),i.success("Produto excluído com sucesso"),h()}catch(s){console.error("Erro ao excluir produto:",s),i.error("Erro ao excluir produto")}},y=t=>t.currentStock===0?{text:"Sem estoque",color:"bg-red-100 text-red-800"}:t.currentStock<=t.minimumStock?{text:"Estoque baixo",color:"bg-yellow-100 text-yellow-800"}:{text:"Normal",color:"bg-green-100 text-green-800"},M=()=>{try{const t=o.map(r=>({Nome:r.name,SKU:r.sku||"","Código de Barras":r.barcode||"",Categoria:r.category,Unidade:r.unit,"Estoque Atual":r.currentStock,"Estoque Mínimo":r.minimumStock,"Estoque Máximo":r.maximumStock||"","Preço de Compra (R$)":r.purchasePrice?r.purchasePrice.toFixed(2):"","Preço de Venda (R$)":r.salePrice?r.salePrice.toFixed(2):"",Localização:r.location||"",Lote:r.batchNumber||"",Validade:r.expirationDate?new Date(r.expirationDate).toLocaleDateString("pt-BR"):"",Ativo:r.isActive?"Sim":"Não",Status:y(r).text})),s=g.book_new(),c=g.json_to_sheet(t),d=[{wch:30},{wch:15},{wch:18},{wch:15},{wch:10},{wch:15},{wch:15},{wch:15},{wch:18},{wch:18},{wch:20},{wch:15},{wch:12},{wch:8},{wch:15}];c["!cols"]=d,g.book_append_sheet(s,c,"Produtos");const p=`produtos_${new Date().toISOString().split("T")[0]}.xlsx`;O(s,p),i.success(`Arquivo ${p} exportado com sucesso!`)}catch(t){console.error("Erro ao exportar Excel:",t),i.error("Erro ao exportar arquivo Excel")}};return v?e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600"})}):e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"flex justify-end",children:e.jsxs("button",{onClick:M,disabled:o.length===0,className:"inline-flex items-center px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors shadow-sm disabled:opacity-50 disabled:cursor-not-allowed",title:"Exportar lista de produtos para Excel",children:[e.jsx(F,{className:"h-5 w-5 mr-2"}),"Exportar Excel"]})}),e.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-xl shadow-sm p-4 border border-gray-100 dark:border-gray-700",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[e.jsx("div",{className:"md:col-span-2",children:e.jsxs("div",{className:"relative",children:[e.jsx(q,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 h-5 w-5"}),e.jsx("input",{type:"text",value:x,onChange:t=>S(t.target.value),onKeyPress:t=>t.key==="Enter"&&T(),placeholder:"Buscar por nome, SKU ou código de barras...",className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent text-gray-900 bg-white placeholder-gray-400"})]})}),e.jsx("div",{children:e.jsxs("select",{value:l,onChange:t=>E(t.target.value),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent text-gray-900 bg-white",children:[e.jsx("option",{value:"",children:"Todas as categorias"}),e.jsx("option",{value:"MEDICAMENTO",children:"Medicamento"}),e.jsx("option",{value:"MATERIAL",children:"Material"}),e.jsx("option",{value:"EQUIPAMENTO",children:"Equipamento"}),e.jsx("option",{value:"COSMETICO",children:"Cosmético"}),e.jsx("option",{value:"SUPLEMENTO",children:"Suplemento"}),e.jsx("option",{value:"OUTRO",children:"Outro"})]})}),e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsxs("label",{className:"flex items-center space-x-2 cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:n,onChange:t=>P(t.target.checked),className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),e.jsx("span",{className:"text-sm text-gray-700",children:"Estoque baixo"})]}),e.jsxs("label",{className:"flex items-center space-x-2 cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:m,onChange:t=>C(t.target.checked),className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),e.jsx("span",{className:"text-sm text-gray-700",children:"Somente ativos"})]})]})]})}),o.length===0?e.jsxs("div",{className:"bg-white rounded-xl shadow-sm p-12 border border-gray-100 text-center",children:[e.jsx(w,{className:"h-16 w-16 text-gray-400 mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"Nenhum produto encontrado"}),e.jsx("p",{className:"text-gray-600",children:x||l||n?"Tente ajustar os filtros de busca":"Comece cadastrando seu primeiro produto"})]}):e.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-xl shadow-sm border border-gray-100 dark:border-gray-700 overflow-hidden",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-gray-50 dark:bg-gray-700 border-b border-gray-200 dark:border-gray-600",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:"Produto"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:"Categoria"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:"Estoque Atual"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:"Mín / Máx"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:"Status"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:"Preços"}),e.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:"Ações"})]})}),e.jsx("tbody",{className:"bg-white dark:bg-gray-800 divide-y divide-gray-200 dark:divide-gray-700",children:o.map(t=>{const s=y(t),c=t.currentStock<=t.minimumStock,d=t.currentStock===0;return e.jsxs("tr",{className:`hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors ${d?"bg-red-50":c?"bg-yellow-50":""}`,children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"flex-shrink-0 h-10 w-10 bg-blue-100 rounded-lg flex items-center justify-center",children:e.jsx(w,{className:"h-5 w-5 text-blue-600"})}),e.jsxs("div",{className:"ml-4",children:[e.jsx("div",{className:"text-sm font-medium text-gray-900 dark:text-white",children:t.name}),e.jsxs("div",{className:"text-sm text-gray-500 dark:text-gray-400",children:[t.sku&&`SKU: ${t.sku}`,t.barcode&&` • Código: ${t.barcode}`]})]})]})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("span",{className:"px-2 py-1 text-xs font-medium rounded-full bg-gray-100 dark:bg-gray-700 text-gray-800 dark:text-gray-200",children:t.category})}),e.jsxs("td",{className:"px-6 py-4 whitespace-nowrap",children:[e.jsxs("div",{className:"text-sm font-medium text-gray-900 dark:text-white",children:[t.currentStock," ",t.unit]}),t.location&&e.jsxs("div",{className:"text-sm text-gray-500 dark:text-gray-400",children:["Local: ",t.location]})]}),e.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500 dark:text-gray-400",children:[t.minimumStock," / ",t.maximumStock||"—"," ",t.unit]}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsxs("span",{className:`inline-flex items-center px-2 py-1 text-xs font-medium rounded-full ${s.color}`,children:[d?e.jsx(j,{className:"h-3 w-3 mr-1"}):c?e.jsx(j,{className:"h-3 w-3 mr-1"}):e.jsx(L,{className:"h-3 w-3 mr-1"}),s.text]})}),e.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500 dark:text-gray-400",children:[t.purchasePrice&&e.jsxs("div",{children:["Compra: R$ ",t.purchasePrice.toFixed(2)]}),t.salePrice&&e.jsxs("div",{children:["Venda: R$ ",t.salePrice.toFixed(2)]})]}),e.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium",children:[e.jsx("button",{onClick:()=>N(t),className:"text-blue-600 hover:text-blue-900 mr-4",title:"Editar",children:e.jsx($,{className:"h-5 w-5"})}),e.jsx("button",{onClick:()=>A(t),className:"text-red-600 hover:text-red-900",title:"Excluir",children:e.jsx(D,{className:"h-5 w-5"})})]})]},t.id)})})]})})}),o.length>0&&e.jsxs("div",{className:"text-sm text-gray-600 dark:text-gray-400 text-center",children:["Mostrando ",o.length," produto(s)"]})]})}export{z as default};
