import{j as e}from"./data-vendor-CPXAi296.js";import{r}from"./react-vendor-B1IcTyqJ.js";import{y as k}from"./index-B1IAEMCE.js";import{z as a,b0 as A,F as C,n as F,h as O,ao as S,ap as T}from"./ui-vendor-C8MD3-Ki.js";import{b as P,c as R}from"./exportService-DZ_DLewA.js";import"./exceljs.min-BlcZB2QI.js";function _({refreshKey:b}){const[s,j]=r.useState([]),[v,d]=r.useState(!0),[i,c]=r.useState(""),[n,x]=r.useState(""),[o,p]=r.useState(""),[l,u]=r.useState(""),[h,f]=r.useState(!1);r.useEffect(()=>{m()},[b,i,n]);const m=async()=>{try{d(!0);const t=await k.getMovements({limit:100,type:i||void 0,reason:n||void 0,startDate:o||void 0,endDate:l||void 0});j(t.data||[])}catch(t){console.error("Erro ao carregar movimentações:",t),a.error("Erro ao carregar movimentações")}finally{d(!1)}},N=()=>{o&&l?m():(o||l)&&a.error("Preencha ambas as datas")},w=()=>{c(""),x(""),p(""),u("")},E=async()=>{try{await P(s),a.success("Movimentações exportadas para Excel com sucesso!")}catch(t){console.error("Erro ao exportar Excel:",t),a.error("Erro ao exportar arquivo Excel")}},D=()=>{try{R(s),a.success("Movimentações exportadas para PDF com sucesso!")}catch(t){console.error("Erro ao exportar PDF:",t),a.error("Erro ao exportar arquivo PDF")}};return v?e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600"})}):e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex justify-end gap-3",children:[e.jsxs("button",{onClick:E,disabled:s.length===0,className:"inline-flex items-center px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors shadow-sm disabled:opacity-50 disabled:cursor-not-allowed",title:"Exportar lista de movimentações para Excel",children:[e.jsx(A,{className:"h-5 w-5 mr-2"}),"Exportar Excel"]}),e.jsxs("button",{onClick:D,disabled:s.length===0,className:"inline-flex items-center px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 transition-colors shadow-sm disabled:opacity-50 disabled:cursor-not-allowed",title:"Exportar lista de movimentações para PDF",children:[e.jsx(C,{className:"h-5 w-5 mr-2"}),"Exportar PDF"]})]}),e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl shadow-sm p-4 border border-gray-100 dark:border-gray-700",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("button",{onClick:()=>f(!h),className:"flex items-center space-x-2 text-gray-700 dark:text-gray-300 hover:text-gray-900 dark:hover:text-white",children:[e.jsx(F,{className:"h-5 w-5"}),e.jsx("span",{className:"font-medium",children:"Filtros"})]}),(i||n||o||l)&&e.jsx("button",{onClick:w,className:"text-sm text-red-600 hover:text-red-700",children:"Limpar filtros"})]}),h&&e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Tipo"}),e.jsxs("select",{value:i,onChange:t=>c(t.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent text-gray-900 bg-white",children:[e.jsx("option",{value:"",children:"Todos"}),e.jsx("option",{value:"ENTRADA",children:"Entrada"}),e.jsx("option",{value:"SAIDA",children:"Saída"}),e.jsx("option",{value:"AJUSTE",children:"Ajuste"}),e.jsx("option",{value:"DEVOLUCAO",children:"Devolução"}),e.jsx("option",{value:"PERDA",children:"Perda"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Motivo"}),e.jsxs("select",{value:n,onChange:t=>x(t.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent text-gray-900 bg-white",children:[e.jsx("option",{value:"",children:"Todos"}),e.jsx("option",{value:"COMPRA",children:"Compra"}),e.jsx("option",{value:"PROCEDIMENTO",children:"Procedimento"}),e.jsx("option",{value:"VENDA",children:"Venda"}),e.jsx("option",{value:"AJUSTE_INVENTARIO",children:"Ajuste de Inventário"}),e.jsx("option",{value:"DEVOLUCAO_FORNECEDOR",children:"Devolução Fornecedor"}),e.jsx("option",{value:"DEVOLUCAO_CLIENTE",children:"Devolução Cliente"}),e.jsx("option",{value:"PERDA",children:"Perda"}),e.jsx("option",{value:"VENCIMENTO",children:"Vencimento"}),e.jsx("option",{value:"DANO",children:"Dano"}),e.jsx("option",{value:"OUTRO",children:"Outro"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Data Inicial"}),e.jsx("input",{type:"date",value:o,onChange:t=>p(t.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent text-gray-900 bg-white"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Data Final"}),e.jsxs("div",{className:"flex space-x-2",children:[e.jsx("input",{type:"date",value:l,onChange:t=>u(t.target.value),className:"flex-1 px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent text-gray-900 bg-white"}),e.jsx("button",{onClick:N,className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:e.jsx(O,{className:"h-5 w-5"})})]})]})]})]}),e.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-xl shadow-sm border border-gray-100 dark:border-gray-700 overflow-hidden",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-gray-50 dark:bg-gray-700 border-b border-gray-200 dark:border-gray-600",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase",children:"Data"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase",children:"Produto"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase",children:"Tipo"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase",children:"Motivo"}),e.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 dark:text-gray-400 uppercase",children:"Quantidade"}),e.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 dark:text-gray-400 uppercase",children:"Estoque"})]})}),e.jsx("tbody",{className:"divide-y divide-gray-200 dark:divide-gray-700",children:s.map(t=>{var g,y;return e.jsxs("tr",{className:"hover:bg-gray-50 dark:hover:bg-gray-700",children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900 dark:text-white",children:new Date(t.createdAt).toLocaleString("pt-BR")}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900 dark:text-white",children:((g=t.product)==null?void 0:g.name)||"Produto não encontrado"}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsxs("span",{className:`inline-flex items-center px-2 py-1 text-xs font-medium rounded-full ${t.type==="ENTRADA"||t.type==="DEVOLUCAO"?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:[t.type==="ENTRADA"||t.type==="DEVOLUCAO"?e.jsx(S,{className:"h-3 w-3 mr-1"}):e.jsx(T,{className:"h-3 w-3 mr-1"}),t.type]})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500 dark:text-gray-400",children:t.reason}),e.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-right font-medium text-gray-900",children:[t.quantity," ",(y=t.product)==null?void 0:y.unit]}),e.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-right text-gray-500",children:[t.previousStock," → ",t.newStock]})]},t.id)})})]})})})]})}export{_ as default};
