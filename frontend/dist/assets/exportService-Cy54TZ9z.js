import{E as h}from"./exceljs.min-D00LKEnQ.js";import{E as c,b as d}from"./index-JoHuE8PE.js";async function m(r){const e=new h.Workbook,a=e.addWorksheet("Produtos");a.columns=[{header:"SKU",key:"sku",width:15},{header:"Nome",key:"name",width:30},{header:"Categoria",key:"category",width:15},{header:"Estoque Atual",key:"currentStock",width:15},{header:"Estoque Mínimo",key:"minimumStock",width:15},{header:"Unidade",key:"unit",width:10},{header:"Preço Compra",key:"purchasePrice",width:15},{header:"Preço Venda",key:"salePrice",width:15},{header:"Localização",key:"location",width:20},{header:"Status",key:"isActive",width:10}],a.getRow(1).font={bold:!0,color:{argb:"FFFFFFFF"}},a.getRow(1).fill={type:"pattern",pattern:"solid",fgColor:{argb:"FF3B82F6"}},a.getRow(1).alignment={vertical:"middle",horizontal:"center"},r.forEach(o=>{a.addRow({sku:o.sku||"N/A",name:o.name,category:o.category,currentStock:o.currentStock,minimumStock:o.minimumStock,unit:o.unit,purchasePrice:o.purchasePrice||0,salePrice:o.salePrice||0,location:o.location||"N/A",isActive:o.isActive?"Ativo":"Inativo"})}),a.eachRow((o,u)=>{if(u>1){const s=r[u-2];s.currentStock===0?o.fill={type:"pattern",pattern:"solid",fgColor:{argb:"FFFECACA"}}:s.currentStock<=s.minimumStock&&(o.fill={type:"pattern",pattern:"solid",fgColor:{argb:"FFFEF3C7"}})}}),a.getColumn("purchasePrice").numFmt="R$ #,##0.00",a.getColumn("salePrice").numFmt="R$ #,##0.00";const t=await e.xlsx.writeBuffer(),n=new Blob([t],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"}),l=URL.createObjectURL(n),i=document.createElement("a");i.href=l,i.download=`produtos_${new Date().toISOString().split("T")[0]}.xlsx`,i.click(),URL.revokeObjectURL(l)}function S(r){const e=new c;e.setFontSize(18),e.setTextColor(59,130,246),e.text("Relatório de Produtos",14,20),e.setFontSize(10),e.setTextColor(100),e.text(`Gerado em: ${new Date().toLocaleString("pt-BR")}`,14,28);const a=r.map(t=>[t.sku||"N/A",t.name,t.category,t.currentStock,t.minimumStock,t.unit,`R$ ${(t.purchasePrice||0).toFixed(2)}`,t.isActive?"Ativo":"Inativo"]);d(e,{head:[["SKU","Nome","Categoria","Estoque","Mín.","Un.","Preço","Status"]],body:a,startY:35,styles:{fontSize:8,cellPadding:2},headStyles:{fillColor:[59,130,246],textColor:255},alternateRowStyles:{fillColor:[245,247,250]},didDrawCell:t=>{if(t.section==="body"&&t.column.index===3){const n=r[t.row.index];n.currentStock===0?e.setFillColor(254,202,202):n.currentStock<=n.minimumStock&&e.setFillColor(254,243,199)}}}),e.save(`produtos_${new Date().toISOString().split("T")[0]}.pdf`)}async function p(r){const e=new h.Workbook,a=e.addWorksheet("Movimentações");a.columns=[{header:"Data",key:"date",width:20},{header:"Produto",key:"product",width:30},{header:"Tipo",key:"type",width:15},{header:"Motivo",key:"reason",width:20},{header:"Quantidade",key:"quantity",width:12},{header:"Estoque Anterior",key:"previousStock",width:15},{header:"Novo Estoque",key:"newStock",width:15},{header:"Valor Unit.",key:"unitPrice",width:15},{header:"Valor Total",key:"totalPrice",width:15},{header:"Observações",key:"notes",width:30}],a.getRow(1).font={bold:!0,color:{argb:"FFFFFFFF"}},a.getRow(1).fill={type:"pattern",pattern:"solid",fgColor:{argb:"FF10B981"}},a.getRow(1).alignment={vertical:"middle",horizontal:"center"},r.forEach(o=>{a.addRow({date:new Date(o.createdAt).toLocaleString("pt-BR"),product:o.productId,type:o.type,reason:o.reason,quantity:o.quantity,previousStock:o.previousStock,newStock:o.newStock,unitPrice:o.unitPrice||0,totalPrice:o.totalPrice||0,notes:o.notes||""})}),a.getColumn("unitPrice").numFmt="R$ #,##0.00",a.getColumn("totalPrice").numFmt="R$ #,##0.00";const t=await e.xlsx.writeBuffer(),n=new Blob([t],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"}),l=URL.createObjectURL(n),i=document.createElement("a");i.href=l,i.download=`movimentacoes_${new Date().toISOString().split("T")[0]}.xlsx`,i.click(),URL.revokeObjectURL(l)}function y(r){const e=new c({orientation:"landscape"});e.setFontSize(18),e.setTextColor(16,185,129),e.text("Relatório de Movimentações",14,20),e.setFontSize(10),e.setTextColor(100),e.text(`Gerado em: ${new Date().toLocaleString("pt-BR")}`,14,28);const a=r.map(t=>[new Date(t.createdAt).toLocaleDateString("pt-BR"),t.type,t.reason,t.quantity,t.previousStock,t.newStock,`R$ ${(t.totalPrice||0).toFixed(2)}`]);d(e,{head:[["Data","Tipo","Motivo","Qtd","Est. Ant.","Est. Novo","Valor"]],body:a,startY:35,styles:{fontSize:8,cellPadding:2},headStyles:{fillColor:[16,185,129],textColor:255},alternateRowStyles:{fillColor:[240,253,244]}}),e.save(`movimentacoes_${new Date().toISOString().split("T")[0]}.pdf`)}function f(r){const e=new c;e.setFontSize(18),e.setTextColor(239,68,68),e.text("Relatório de Alertas de Estoque",14,20),e.setFontSize(10),e.setTextColor(100),e.text(`Gerado em: ${new Date().toLocaleString("pt-BR")}`,14,28);const a=r.map(t=>[t.type,t.productId,t.currentStock||0,t.minimumStock||0,t.status,new Date(t.createdAt).toLocaleDateString("pt-BR")]);d(e,{head:[["Tipo","Produto","Estoque Atual","Estoque Mín.","Status","Data"]],body:a,startY:35,styles:{fontSize:9,cellPadding:3},headStyles:{fillColor:[239,68,68],textColor:255},alternateRowStyles:{fillColor:[254,242,242]}}),e.save(`alertas_${new Date().toISOString().split("T")[0]}.pdf`)}export{S as a,p as b,y as c,f as d,m as e};
