import{j as e}from"./data-vendor-DRb15VUq.js";import{r as o}from"./react-vendor-Clsx5AbG.js";import{H as v,y as c}from"./index-eTeodJu_.js";import{z as s,F as N,d as w,ae as E}from"./ui-vendor-BugANens.js";import{d as A}from"./exportService-BV9KZBTA.js";import"./exceljs.min-CERwl7y6.js";function I({refreshKey:x,onRefresh:i}){const[a,u]=o.useState([]),[g,d]=o.useState(!0),[l,p]=o.useState(v.ACTIVE);o.useEffect(()=>{h()},[x,l]);const h=async()=>{try{d(!0);const r=await c.getAlerts({status:l||void 0,limit:100});u(r.data||[])}catch(r){console.error("Erro ao carregar alertas:",r),s.error("Erro ao carregar alertas")}finally{d(!1)}},b=async r=>{const t=prompt("Digite a resolução do alerta:");if(t)try{await c.resolveAlert(r.id,t),s.success("Alerta resolvido com sucesso!"),i()}catch{s.error("Erro ao resolver alerta")}},y=async r=>{if(confirm("Tem certeza que deseja ignorar este alerta?"))try{await c.ignoreAlert(r.id),s.success("Alerta ignorado"),i()}catch{s.error("Erro ao ignorar alerta")}},j=r=>{switch(r){case"LOW_STOCK":return"bg-yellow-100 text-yellow-800 border-yellow-200";case"OUT_OF_STOCK":return"bg-red-100 text-red-800 border-red-200";case"EXPIRING_SOON":return"bg-orange-100 text-orange-800 border-orange-200";case"EXPIRED":return"bg-gray-100 text-gray-800 border-gray-200";default:return"bg-blue-100 text-blue-800 border-blue-200"}},f=()=>{try{A(a),s.success("Alertas exportados para PDF com sucesso!")}catch(r){console.error("Erro ao exportar PDF:",r),s.error("Erro ao exportar arquivo PDF")}};return g?e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600"})}):e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"flex justify-end",children:e.jsxs("button",{onClick:f,disabled:a.length===0,className:"inline-flex items-center px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 transition-colors shadow-sm disabled:opacity-50 disabled:cursor-not-allowed",title:"Exportar lista de alertas para PDF",children:[e.jsx(N,{className:"h-5 w-5 mr-2"}),"Exportar PDF"]})}),e.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-xl shadow-sm p-4 border border-gray-100 dark:border-gray-700",children:e.jsxs("select",{value:l,onChange:r=>p(r.target.value),className:"px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent text-gray-900 bg-white",children:[e.jsx("option",{value:"",children:"Todos os status"}),e.jsx("option",{value:"ACTIVE",children:"Ativos"}),e.jsx("option",{value:"RESOLVED",children:"Resolvidos"}),e.jsx("option",{value:"IGNORED",children:"Ignorados"})]})}),a.length===0?e.jsxs("div",{className:"bg-white rounded-xl shadow-sm p-12 border border-gray-100 text-center",children:[e.jsx(w,{className:"h-16 w-16 text-green-500 mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"Nenhum alerta encontrado"}),e.jsx("p",{className:"text-gray-600",children:"Todos os itens estão dentro dos parâmetros normais"})]}):e.jsx("div",{className:"space-y-3",children:a.map(r=>{var t,n,m;return e.jsx("div",{className:`rounded-xl shadow-sm p-6 border-2 ${j(r.type)}`,children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center space-x-3 mb-2",children:[e.jsx(E,{className:"h-5 w-5"}),e.jsx("h3",{className:"font-bold text-lg",children:(t=r.product)==null?void 0:t.name}),e.jsx("span",{className:"px-2 py-1 text-xs font-medium rounded-full bg-white bg-opacity-50",children:r.type.replace("_"," ")})]}),e.jsx("p",{className:"text-sm mb-3",children:r.message}),r.currentStock!==void 0&&e.jsxs("p",{className:"text-sm font-medium",children:["Estoque atual: ",r.currentStock," ",(n=r.product)==null?void 0:n.unit,r.minimumStock&&` • Mínimo: ${r.minimumStock} ${(m=r.product)==null?void 0:m.unit}`]}),e.jsxs("p",{className:"text-xs mt-2 opacity-75",children:["Criado em: ",new Date(r.createdAt).toLocaleString("pt-BR")]})]}),r.status==="ACTIVE"&&e.jsxs("div",{className:"flex space-x-2 ml-4",children:[e.jsx("button",{onClick:()=>b(r),className:"px-3 py-1 bg-green-600 text-white text-sm rounded-lg hover:bg-green-700 transition-colors",children:"Resolver"}),e.jsx("button",{onClick:()=>y(r),className:"px-3 py-1 bg-gray-600 text-white text-sm rounded-lg hover:bg-gray-700 transition-colors",children:"Ignorar"})]})]})},r.id)})})]})}export{I as default};
