import{j as e}from"./data-vendor-CPXAi296.js";import{r as s}from"./react-vendor-B1IcTyqJ.js";import{J as h}from"./index-C912A6CL.js";import{z as a,b3 as T,F as O,u as M,P as g,j as p,e as A,a5 as D,s as q}from"./ui-vendor-CGldjw86.js";import{e as L,a as $}from"./exportService-DJdCKWFj.js";import"./exceljs.min-BlcZB2QI.js";function J({onEdit:y,refreshKey:b}){const[t,j]=s.useState([]),[N,x]=s.useState(!0),[i,f]=s.useState(""),[o,w]=s.useState(""),[c,k]=s.useState(!1),[d,v]=s.useState(!0);s.useEffect(()=>{n()},[b,o,c,d]);const n=async()=>{try{x(!0);const r=await h.getProducts({search:i||void 0,category:o||void 0,lowStock:c,isActive:d});j(r.data||[])}catch(r){console.error("Erro ao carregar produtos:",r),a.error("Erro ao carregar produtos")}finally{x(!1)}},E=()=>{n()},S=async r=>{if(confirm(`Tem certeza que deseja excluir o produto "${r.name}"?`))try{await h.deleteProduct(r.id),a.success("Produto excluído com sucesso"),n()}catch(l){console.error("Erro ao excluir produto:",l),a.error("Erro ao excluir produto")}},P=r=>r.currentStock===0?{text:"Sem estoque",color:"bg-red-100 text-red-800"}:r.currentStock<=r.minimumStock?{text:"Estoque baixo",color:"bg-yellow-100 text-yellow-800"}:{text:"Normal",color:"bg-green-100 text-green-800"},C=async()=>{try{await L(t),a.success("Produtos exportados para Excel com sucesso!")}catch(r){console.error("Erro ao exportar Excel:",r),a.error("Erro ao exportar arquivo Excel")}},F=()=>{try{$(t),a.success("Produtos exportados para PDF com sucesso!")}catch(r){console.error("Erro ao exportar PDF:",r),a.error("Erro ao exportar arquivo PDF")}};return N?e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600"})}):e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex justify-end gap-3",children:[e.jsxs("button",{onClick:C,disabled:t.length===0,className:"inline-flex items-center px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors shadow-sm disabled:opacity-50 disabled:cursor-not-allowed",title:"Exportar lista de produtos para Excel",children:[e.jsx(T,{className:"h-5 w-5 mr-2"}),"Exportar Excel"]}),e.jsxs("button",{onClick:F,disabled:t.length===0,className:"inline-flex items-center px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 transition-colors shadow-sm disabled:opacity-50 disabled:cursor-not-allowed",title:"Exportar lista de produtos para PDF",children:[e.jsx(O,{className:"h-5 w-5 mr-2"}),"Exportar PDF"]})]}),e.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-xl shadow-sm p-4 border border-gray-100 dark:border-gray-700",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[e.jsx("div",{className:"md:col-span-2",children:e.jsxs("div",{className:"relative",children:[e.jsx(M,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 h-5 w-5"}),e.jsx("input",{type:"text",value:i,onChange:r=>f(r.target.value),onKeyPress:r=>r.key==="Enter"&&E(),placeholder:"Buscar por nome, SKU ou código de barras...",className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent text-gray-900 bg-white placeholder-gray-400"})]})}),e.jsx("div",{children:e.jsxs("select",{value:o,onChange:r=>w(r.target.value),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent text-gray-900 bg-white",children:[e.jsx("option",{value:"",children:"Todas as categorias"}),e.jsx("option",{value:"MEDICAMENTO",children:"Medicamento"}),e.jsx("option",{value:"MATERIAL",children:"Material"}),e.jsx("option",{value:"EQUIPAMENTO",children:"Equipamento"}),e.jsx("option",{value:"COSMETICO",children:"Cosmético"}),e.jsx("option",{value:"SUPLEMENTO",children:"Suplemento"}),e.jsx("option",{value:"OUTRO",children:"Outro"})]})}),e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsxs("label",{className:"flex items-center space-x-2 cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:c,onChange:r=>k(r.target.checked),className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),e.jsx("span",{className:"text-sm text-gray-700",children:"Estoque baixo"})]}),e.jsxs("label",{className:"flex items-center space-x-2 cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:d,onChange:r=>v(r.target.checked),className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),e.jsx("span",{className:"text-sm text-gray-700",children:"Somente ativos"})]})]})]})}),t.length===0?e.jsxs("div",{className:"bg-white rounded-xl shadow-sm p-12 border border-gray-100 text-center",children:[e.jsx(g,{className:"h-16 w-16 text-gray-400 mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"Nenhum produto encontrado"}),e.jsx("p",{className:"text-gray-600",children:i||o||c?"Tente ajustar os filtros de busca":"Comece cadastrando seu primeiro produto"})]}):e.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-xl shadow-sm border border-gray-100 dark:border-gray-700 overflow-hidden",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-gray-50 dark:bg-gray-700 border-b border-gray-200 dark:border-gray-600",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:"Produto"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:"Categoria"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:"Estoque Atual"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:"Mín / Máx"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:"Status"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:"Preços"}),e.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:"Ações"})]})}),e.jsx("tbody",{className:"bg-white dark:bg-gray-800 divide-y divide-gray-200 dark:divide-gray-700",children:t.map(r=>{const l=P(r),m=r.currentStock<=r.minimumStock,u=r.currentStock===0;return e.jsxs("tr",{className:`hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors ${u?"bg-red-50":m?"bg-yellow-50":""}`,children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"flex-shrink-0 h-10 w-10 bg-blue-100 rounded-lg flex items-center justify-center",children:e.jsx(g,{className:"h-5 w-5 text-blue-600"})}),e.jsxs("div",{className:"ml-4",children:[e.jsx("div",{className:"text-sm font-medium text-gray-900 dark:text-white",children:r.name}),e.jsxs("div",{className:"text-sm text-gray-500 dark:text-gray-400",children:[r.sku&&`SKU: ${r.sku}`,r.barcode&&` • Código: ${r.barcode}`]})]})]})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("span",{className:"px-2 py-1 text-xs font-medium rounded-full bg-gray-100 dark:bg-gray-700 text-gray-800 dark:text-gray-200",children:r.category})}),e.jsxs("td",{className:"px-6 py-4 whitespace-nowrap",children:[e.jsxs("div",{className:"text-sm font-medium text-gray-900 dark:text-white",children:[r.currentStock," ",r.unit]}),r.location&&e.jsxs("div",{className:"text-sm text-gray-500 dark:text-gray-400",children:["Local: ",r.location]})]}),e.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500 dark:text-gray-400",children:[r.minimumStock," / ",r.maximumStock||"—"," ",r.unit]}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsxs("span",{className:`inline-flex items-center px-2 py-1 text-xs font-medium rounded-full ${l.color}`,children:[u?e.jsx(p,{className:"h-3 w-3 mr-1"}):m?e.jsx(p,{className:"h-3 w-3 mr-1"}):e.jsx(A,{className:"h-3 w-3 mr-1"}),l.text]})}),e.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500 dark:text-gray-400",children:[r.purchasePrice&&e.jsxs("div",{children:["Compra: R$ ",Number(r.purchasePrice).toFixed(2)]}),r.salePrice&&e.jsxs("div",{children:["Venda: R$ ",Number(r.salePrice).toFixed(2)]})]}),e.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium",children:[e.jsx("button",{onClick:()=>y(r),className:"text-blue-600 hover:text-blue-900 mr-4",title:"Editar",children:e.jsx(D,{className:"h-5 w-5"})}),e.jsx("button",{onClick:()=>S(r),className:"text-red-600 hover:text-red-900",title:"Excluir",children:e.jsx(q,{className:"h-5 w-5"})})]})]},r.id)})})]})})}),t.length>0&&e.jsxs("div",{className:"text-sm text-gray-600 dark:text-gray-400 text-center",children:["Mostrando ",t.length," produto(s)"]})]})}export{J as default};
