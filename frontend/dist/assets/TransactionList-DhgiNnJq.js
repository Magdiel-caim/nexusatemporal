import{j as e}from"./data-vendor-DBjWdmlc.js";import{r as i}from"./react-vendor-C7NvnInC.js";import{f as x}from"./index-8goJQ604.js";import{ap as o,t as L,K as A,r as B,u as I,D as q,e as V,H as _,ah as $,s as z,R as X,b8 as H,h as K,g as O}from"./ui-vendor-ChsCYMgo.js";function W({onEditTransaction:h,onCreateTransaction:g,defaultFilters:r,title:j}){const[d,k]=i.useState([]),[v,y]=i.useState(!0),[u,N]=i.useState(!1),[s,p]=i.useState({type:(r==null?void 0:r.type)||"",status:(r==null?void 0:r.status)||"",category:(r==null?void 0:r.category)||"",paymentMethod:(r==null?void 0:r.paymentMethod)||"",search:(r==null?void 0:r.search)||"",dateFrom:(r==null?void 0:r.dateFrom)||"",dateTo:(r==null?void 0:r.dateTo)||"",dueDateFrom:(r==null?void 0:r.dueDateFrom)||"",dueDateTo:(r==null?void 0:r.dueDateTo)||""});i.useEffect(()=>{n()},[]),i.useEffect(()=>{n()},[s]);const n=async()=>{try{y(!0);const a=await x.getTransactions({type:s.type||void 0,status:s.status||void 0,category:s.category||void 0,paymentMethod:s.paymentMethod||void 0,search:s.search||void 0,dateFrom:s.dateFrom||void 0,dateTo:s.dateTo||void 0,dueDateFrom:s.dueDateFrom||void 0,dueDateTo:s.dueDateTo||void 0});k(a)}catch(a){o.error("Erro ao carregar transações: "+a.message)}finally{y(!1)}},c=(a,t)=>{p(l=>({...l,[a]:t}))},w=()=>{n()},f=()=>{p({type:"",status:"",category:"",paymentMethod:"",search:"",dateFrom:"",dateTo:"",dueDateFrom:"",dueDateTo:""}),setTimeout(()=>n(),100)},T=async a=>{try{await x.confirmTransaction(a,{paymentDate:new Date().toISOString().split("T")[0]}),o.success("Transação confirmada com sucesso!"),n()}catch(t){o.error("Erro ao confirmar transação: "+t.message)}},C=async a=>{const t=prompt("Motivo do cancelamento:");if(t)try{await x.cancelTransaction(a,t),o.success("Transação cancelada com sucesso!"),n()}catch(l){o.error("Erro ao cancelar transação: "+l.message)}},D=async a=>{const t=prompt("Motivo do estorno:");if(t)try{await x.reverseTransaction(a,t),o.success("Transação estornada com sucesso!"),n()}catch(l){o.error("Erro ao estornar transação: "+l.message)}},S=async a=>{if(confirm("Tem certeza que deseja excluir esta transação?"))try{await x.deleteTransaction(a),o.success("Transação excluída com sucesso!"),n()}catch(t){o.error("Erro ao excluir transação: "+t.message)}},m=a=>new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format(a),b=a=>new Date(a).toLocaleDateString("pt-BR"),E=a=>{switch(a){case"receita":return e.jsx(O,{className:"w-4 h-4 text-green-600"});case"despesa":return e.jsx(K,{className:"w-4 h-4 text-red-600"});case"transferencia":return e.jsx(H,{className:"w-4 h-4 text-blue-600"})}},M=a=>{const t={pendente:"bg-yellow-100 text-yellow-800 dark:bg-yellow-900 dark:text-yellow-200",confirmada:"bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-200",cancelada:"bg-red-100 text-red-800 dark:bg-red-900 dark:text-red-200",estornada:"bg-purple-100 text-purple-800 dark:bg-purple-900 dark:text-purple-200"},l={pendente:"Pendente",confirmada:"Confirmada",cancelada:"Cancelada",estornada:"Estornada"};return e.jsx("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${t[a]}`,children:l[a]})},R=a=>({receita:"Receita",despesa:"Despesa",transferencia:"Transferência"})[a],P=()=>{o.success("Exportação em desenvolvimento...")};return v?e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"})}):e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-900 dark:text-white",children:j||"Transações"}),e.jsxs("span",{className:"text-sm text-gray-500 dark:text-gray-400",children:[d.length," registro(s)"]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsxs("button",{onClick:()=>N(!u),className:"inline-flex items-center px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm text-sm font-medium text-gray-700 dark:text-gray-300 bg-white dark:bg-gray-800 hover:bg-gray-50 dark:hover:bg-gray-700",children:[e.jsx(L,{className:"w-4 h-4 mr-2"}),"Filtros"]}),e.jsxs("button",{onClick:P,className:"inline-flex items-center px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm text-sm font-medium text-gray-700 dark:text-gray-300 bg-white dark:bg-gray-800 hover:bg-gray-50 dark:hover:bg-gray-700",children:[e.jsx(A,{className:"w-4 h-4 mr-2"}),"Exportar"]}),g&&e.jsxs("button",{onClick:g,className:"inline-flex items-center px-4 py-2 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-blue-600 hover:bg-blue-700",children:[e.jsx(B,{className:"w-4 h-4 mr-2"}),"Nova Transação"]})]})]}),u&&e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700 p-4 space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Buscar"}),e.jsxs("div",{className:"relative",children:[e.jsx(I,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-4 h-4 text-gray-400"}),e.jsx("input",{type:"text",value:s.search,onChange:a=>c("search",a.target.value),placeholder:"Descrição...",className:"pl-10 w-full rounded-md border-gray-300 dark:border-gray-600 dark:bg-gray-700 text-gray-900 dark:text-white shadow-sm focus:border-blue-500 focus:ring-blue-500"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Tipo"}),e.jsxs("select",{value:s.type,onChange:a=>c("type",a.target.value),className:"w-full rounded-md border-gray-300 dark:border-gray-600 dark:bg-gray-700 text-gray-900 dark:text-white shadow-sm focus:border-blue-500 focus:ring-blue-500",children:[e.jsx("option",{value:"",children:"Todos"}),e.jsx("option",{value:"receita",children:"Receita"}),e.jsx("option",{value:"despesa",children:"Despesa"}),e.jsx("option",{value:"transferencia",children:"Transferência"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Status"}),e.jsxs("select",{value:s.status,onChange:a=>c("status",a.target.value),className:"w-full rounded-md border-gray-300 dark:border-gray-600 dark:bg-gray-700 text-gray-900 dark:text-white shadow-sm focus:border-blue-500 focus:ring-blue-500",children:[e.jsx("option",{value:"",children:"Todos"}),e.jsx("option",{value:"pendente",children:"Pendente"}),e.jsx("option",{value:"confirmada",children:"Confirmada"}),e.jsx("option",{value:"cancelada",children:"Cancelada"}),e.jsx("option",{value:"estornada",children:"Estornada"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Pagamento"}),e.jsxs("select",{value:s.paymentMethod,onChange:a=>c("paymentMethod",a.target.value),className:"w-full rounded-md border-gray-300 dark:border-gray-600 dark:bg-gray-700 text-gray-900 dark:text-white shadow-sm focus:border-blue-500 focus:ring-blue-500",children:[e.jsx("option",{value:"",children:"Todos"}),e.jsx("option",{value:"pix",children:"PIX"}),e.jsx("option",{value:"dinheiro",children:"Dinheiro"}),e.jsx("option",{value:"cartao_credito",children:"Cartão de Crédito"}),e.jsx("option",{value:"cartao_debito",children:"Cartão de Débito"}),e.jsx("option",{value:"boleto",children:"Boleto"}),e.jsx("option",{value:"transferencia",children:"Transferência"}),e.jsx("option",{value:"cheque",children:"Cheque"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Vencimento De"}),e.jsx("input",{type:"date",value:s.dueDateFrom,onChange:a=>c("dueDateFrom",a.target.value),className:"w-full rounded-md border-gray-300 dark:border-gray-600 dark:bg-gray-700 text-gray-900 dark:text-white shadow-sm focus:border-blue-500 focus:ring-blue-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Vencimento Até"}),e.jsx("input",{type:"date",value:s.dueDateTo,onChange:a=>c("dueDateTo",a.target.value),className:"w-full rounded-md border-gray-300 dark:border-gray-600 dark:bg-gray-700 text-gray-900 dark:text-white shadow-sm focus:border-blue-500 focus:ring-blue-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Pagamento De"}),e.jsx("input",{type:"date",value:s.dateFrom,onChange:a=>c("dateFrom",a.target.value),className:"w-full rounded-md border-gray-300 dark:border-gray-600 dark:bg-gray-700 text-gray-900 dark:text-white shadow-sm focus:border-blue-500 focus:ring-blue-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Pagamento Até"}),e.jsx("input",{type:"date",value:s.dateTo,onChange:a=>c("dateTo",a.target.value),className:"w-full rounded-md border-gray-300 dark:border-gray-600 dark:bg-gray-700 text-gray-900 dark:text-white shadow-sm focus:border-blue-500 focus:ring-blue-500"})]})]}),e.jsxs("div",{className:"flex items-center justify-end space-x-2",children:[e.jsx("button",{onClick:f,className:"px-4 py-2 text-sm font-medium text-gray-700 dark:text-gray-300 hover:text-gray-900 dark:hover:text-white",children:"Limpar"}),e.jsx("button",{onClick:w,className:"px-4 py-2 bg-blue-600 text-white text-sm font-medium rounded-md hover:bg-blue-700",children:"Aplicar Filtros"})]})]}),e.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700 overflow-hidden",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200 dark:divide-gray-700",children:[e.jsx("thead",{className:"bg-gray-50 dark:bg-gray-900",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:"Tipo"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:"Descrição"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:"Valor"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:"Vencimento"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:"Pagamento"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:"Status"}),e.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:"Ações"})]})}),e.jsx("tbody",{className:"bg-white dark:bg-gray-800 divide-y divide-gray-200 dark:divide-gray-700",children:d.length===0?e.jsx("tr",{children:e.jsxs("td",{colSpan:7,className:"px-6 py-12 text-center",children:[e.jsx(q,{className:"mx-auto h-12 w-12 text-gray-400"}),e.jsx("h3",{className:"mt-2 text-sm font-medium text-gray-900 dark:text-white",children:"Nenhuma transação encontrada"}),e.jsx("p",{className:"mt-1 text-sm text-gray-500 dark:text-gray-400",children:g?"Comece criando uma nova transação.":"Ajuste os filtros para ver resultados."})]})}):d.map(a=>e.jsxs("tr",{className:"hover:bg-gray-50 dark:hover:bg-gray-700",children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsxs("div",{className:"flex items-center",children:[E(a.type),e.jsx("span",{className:"ml-2 text-sm text-gray-900 dark:text-white",children:R(a.type)})]})}),e.jsxs("td",{className:"px-6 py-4",children:[e.jsx("div",{className:"text-sm text-gray-900 dark:text-white",children:a.description}),a.lead&&e.jsxs("div",{className:"text-xs text-gray-500 dark:text-gray-400",children:["Lead: ",a.lead.fullName]}),a.supplier&&e.jsxs("div",{className:"text-xs text-gray-500 dark:text-gray-400",children:["Fornecedor: ",a.supplier.name]})]}),e.jsxs("td",{className:"px-6 py-4 whitespace-nowrap",children:[e.jsx("div",{className:`text-sm font-medium ${a.type==="receita"?"text-green-600 dark:text-green-400":a.type==="despesa"?"text-red-600 dark:text-red-400":"text-blue-600 dark:text-blue-400"}`,children:m(a.amount)}),a.isInstallment&&e.jsxs("div",{className:"text-xs text-gray-500 dark:text-gray-400",children:[a.installmentNumber,"/",a.totalInstallments]})]}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900 dark:text-white",children:b(a.dueDate)}),e.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900 dark:text-white",children:[a.paymentDate?b(a.paymentDate):"-",a.paymentMethod&&e.jsx("div",{className:"text-xs text-gray-500 dark:text-gray-400 capitalize",children:a.paymentMethod.replace("_"," ")})]}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:M(a.status)}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium",children:e.jsxs("div",{className:"flex items-center justify-end space-x-2",children:[a.status==="pendente"&&e.jsxs(e.Fragment,{children:[e.jsx("button",{onClick:()=>T(a.id),className:"text-green-600 hover:text-green-900 dark:text-green-400 dark:hover:text-green-300",title:"Confirmar",children:e.jsx(V,{className:"w-4 h-4"})}),e.jsx("button",{onClick:()=>C(a.id),className:"text-red-600 hover:text-red-900 dark:text-red-400 dark:hover:text-red-300",title:"Cancelar",children:e.jsx(_,{className:"w-4 h-4"})}),h&&e.jsx("button",{onClick:()=>h(a),className:"text-blue-600 hover:text-blue-900 dark:text-blue-400 dark:hover:text-blue-300",title:"Editar",children:e.jsx($,{className:"w-4 h-4"})}),e.jsx("button",{onClick:()=>S(a.id),className:"text-gray-600 hover:text-gray-900 dark:text-gray-400 dark:hover:text-gray-300",title:"Excluir",children:e.jsx(z,{className:"w-4 h-4"})})]}),a.status==="confirmada"&&e.jsx("button",{onClick:()=>D(a.id),className:"text-purple-600 hover:text-purple-900 dark:text-purple-400 dark:hover:text-purple-300",title:"Estornar",children:e.jsx(X,{className:"w-4 h-4"})})]})})]},a.id))})]})})}),d.length>0&&e.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700 p-4",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Total Receitas"}),e.jsx("div",{className:"text-lg font-semibold text-green-600 dark:text-green-400",children:m(d.filter(a=>a.type==="receita").reduce((a,t)=>a+t.amount,0))})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Total Despesas"}),e.jsx("div",{className:"text-lg font-semibold text-red-600 dark:text-red-400",children:m(d.filter(a=>a.type==="despesa").reduce((a,t)=>a+t.amount,0))})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Saldo"}),e.jsx("div",{className:`text-lg font-semibold ${d.filter(a=>a.type==="receita").reduce((a,t)=>a+t.amount,0)-d.filter(a=>a.type==="despesa").reduce((a,t)=>a+t.amount,0)>=0?"text-green-600 dark:text-green-400":"text-red-600 dark:text-red-400"}`,children:m(d.filter(a=>a.type==="receita").reduce((a,t)=>a+t.amount,0)-d.filter(a=>a.type==="despesa").reduce((a,t)=>a+t.amount,0))})]})]})})]})}export{W as default};
