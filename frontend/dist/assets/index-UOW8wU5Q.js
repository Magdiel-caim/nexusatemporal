var _n=Object.defineProperty;var On=(t,e,s)=>e in t?_n(t,e,{enumerable:!0,configurable:!0,writable:!0,value:s}):t[e]=s;var Qs=(t,e,s)=>On(t,typeof e!="symbol"?e+"":e,s);import{a as Ln,c as Mn,j as r,Q as Dn,b as Pn}from"./data-vendor-C706I2UW.js";import{a as Be,r as u,u as Vt,L as Lt,R as z,b as Rr,N as Tr,B as In,c as Bn,d as te}from"./react-vendor-CDqR2DTq.js";import{z as _,U as ls,a as Wn,T as qn,b as Fn,D as _r,B as Ks,A as $n,c as Gs,C as ds,d as Vn,X as dt,e as Qe,f as us,g as Ue,h as ks,M as Mt,i as Or,j as zn,k as Cs,P as zt,F as Lr,l as Yn,m as Un,S as Mr,n as Hn,o as Xn,L as Qn,p as Kn,q as Gn,r as hs,s as Jn,Q as Zn,t as ea,R as ta,V as sa,u as ra,v as na,w as aa,I as oa,x as ia,y as ca,E as la,G as Js,H as da,J as ua,K as ha,N as ma,O as fa,W as ga,Y as pa,Z as Zs,_ as xa}from"./ui-vendor-uawlxC_H.js";(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))n(a);new MutationObserver(a=>{for(const o of a)if(o.type==="childList")for(const i of o.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&n(i)}).observe(document,{childList:!0,subtree:!0});function s(a){const o={};return a.integrity&&(o.integrity=a.integrity),a.referrerPolicy&&(o.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?o.credentials="include":a.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function n(a){if(a.ep)return;a.ep=!0;const o=s(a);fetch(a.href,o)}})();var ms={},er=Be;ms.createRoot=er.createRoot,ms.hydrateRoot=er.hydrateRoot;const ya="https://api.nexusatemporal.com.br/api",k=Ln.create({baseURL:ya,headers:{"Content-Type":"application/json"}});k.interceptors.request.use(t=>{const e=localStorage.getItem("token");return e&&(t.headers.Authorization=`Bearer ${e}`),t},t=>Promise.reject(t));k.interceptors.response.use(t=>t,t=>{var e,s,n;return((e=t.response)==null?void 0:e.status)===401?(localStorage.removeItem("token"),localStorage.removeItem("user"),window.location.href="/login",_.error("Sess√£o expirada. Fa√ßa login novamente.")):((s=t.response)==null?void 0:s.status)===403?_.error("Voc√™ n√£o tem permiss√£o para acessar este recurso."):((n=t.response)==null?void 0:n.status)>=500&&_.error("Erro no servidor. Tente novamente mais tarde."),Promise.reject(t)});const ce={async login(t){const{data:e}=await k.post("/auth/login",t);return{user:e.data.user,token:e.data.accessToken,refreshToken:e.data.refreshToken}},async register(t){const{data:e}=await k.post("/auth/register",t);return{user:e.data,token:"",refreshToken:""}},async logout(){await k.post("/auth/logout"),localStorage.removeItem("token"),localStorage.removeItem("user")},async getProfile(){const{data:t}=await k.get("/auth/profile");return t},async refreshToken(t){const{data:e}=await k.post("/auth/refresh",{refreshToken:t});return e},async forgotPassword(t){await k.post("/auth/forgot-password",{email:t})},async resetPassword(t,e){await k.post("/auth/reset-password",{token:t,password:e})},setToken(t){localStorage.setItem("token",t)},getToken(){return localStorage.getItem("token")},setUser(t){localStorage.setItem("user",JSON.stringify(t))},getUser(){const t=localStorage.getItem("user");return t?JSON.parse(t):null}},ft=Mn(t=>({user:ce.getUser(),token:ce.getToken(),isAuthenticated:!!ce.getToken(),isLoading:!1,login:async e=>{var s,n;t({isLoading:!0});try{const{user:a,token:o}=await ce.login(e);ce.setToken(o),ce.setUser(a),t({user:a,token:o,isAuthenticated:!0,isLoading:!1}),_.success("Login realizado com sucesso!")}catch(a){throw t({isLoading:!1}),_.error(((n=(s=a.response)==null?void 0:s.data)==null?void 0:n.error)||"Erro ao fazer login"),a}},register:async e=>{var s,n;t({isLoading:!0});try{const{user:a,token:o}=await ce.register(e);ce.setToken(o),ce.setUser(a),t({user:a,token:o,isAuthenticated:!0,isLoading:!1}),_.success("Conta criada com sucesso!")}catch(a){throw t({isLoading:!1}),_.error(((n=(s=a.response)==null?void 0:s.data)==null?void 0:n.error)||"Erro ao criar conta"),a}},logout:async()=>{try{await ce.logout()}catch(e){console.error("Erro ao fazer logout:",e)}finally{t({user:null,token:null,isAuthenticated:!1}),_.success("Logout realizado com sucesso!")}},loadUser:()=>{const e=ce.getUser(),s=ce.getToken();t({user:e,token:s,isAuthenticated:!!s})}})),Ss="/assets/logo-full-B3Op3OHa.png";function ba(){const[t,e]=u.useState(""),[s,n]=u.useState(""),{login:a,isLoading:o}=ft(),i=Vt(),c=async l=>{l.preventDefault();try{await a({email:t,password:s}),i("/dashboard")}catch{}};return r.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gradient-to-br from-primary-50 to-primary-100 dark:from-gray-900 dark:to-gray-800",children:r.jsx("div",{className:"w-full max-w-md",children:r.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-2xl shadow-xl p-8",children:[r.jsxs("div",{className:"text-center mb-8",children:[r.jsx("img",{src:Ss,alt:"Nexus Atemporal",className:"h-20 mx-auto mb-4"}),r.jsx("p",{className:"text-gray-600 dark:text-gray-400 text-sm",children:"Sistema de Gest√£o para Cl√≠nicas"})]}),r.jsxs("form",{onSubmit:c,className:"space-y-6",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Email"}),r.jsx("input",{type:"email",value:t,onChange:l=>e(l.target.value),className:"input-field",placeholder:"seu@email.com",required:!0,autoFocus:!0})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Senha"}),r.jsx("input",{type:"password",value:s,onChange:l=>n(l.target.value),className:"input-field",placeholder:"‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢",required:!0})]}),r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsxs("label",{className:"flex items-center",children:[r.jsx("input",{type:"checkbox",className:"rounded border-gray-300 text-primary-600 focus:ring-primary-500"}),r.jsx("span",{className:"ml-2 text-sm text-gray-600 dark:text-gray-400",children:"Lembrar-me"})]}),r.jsx(Lt,{to:"/forgot-password",className:"text-sm text-primary-600 hover:text-primary-700",children:"Esqueceu a senha?"})]}),r.jsx("button",{type:"submit",disabled:o,className:"btn-primary w-full",children:o?"Entrando...":"Entrar"})]}),r.jsx("div",{className:"mt-6 text-center",children:r.jsxs("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:["N√£o tem uma conta?"," ",r.jsx(Lt,{to:"/register",className:"font-medium text-primary-600 hover:text-primary-700",children:"Criar conta"})]})})]})})})}function va(){const[t,e]=u.useState(""),[s,n]=u.useState(""),[a,o]=u.useState(""),[i,c]=u.useState(""),[l,h]=u.useState(""),{register:d,isLoading:f}=ft(),m=Vt(),y=async N=>{if(N.preventDefault(),i!==l){alert("As senhas n√£o coincidem");return}try{await d({name:t,email:s,phone:a,password:i}),m("/dashboard")}catch{}};return r.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gradient-to-br from-primary-50 to-primary-100 dark:from-gray-900 dark:to-gray-800 py-12",children:r.jsx("div",{className:"w-full max-w-md",children:r.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-2xl shadow-xl p-8",children:[r.jsxs("div",{className:"text-center mb-8",children:[r.jsx("img",{src:Ss,alt:"Nexus Atemporal",className:"h-16 mx-auto mb-4"}),r.jsx("h2",{className:"text-xl font-semibold text-gray-900 dark:text-white mb-1",children:"Criar Conta"}),r.jsx("p",{className:"text-gray-600 dark:text-gray-400 text-sm",children:"Preencha os dados para come√ßar"})]}),r.jsxs("form",{onSubmit:y,className:"space-y-5",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Nome Completo"}),r.jsx("input",{type:"text",value:t,onChange:N=>e(N.target.value),className:"input-field",placeholder:"Seu nome",required:!0,autoFocus:!0})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Email"}),r.jsx("input",{type:"email",value:s,onChange:N=>n(N.target.value),className:"input-field",placeholder:"seu@email.com",required:!0})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Telefone"}),r.jsx("input",{type:"tel",value:a,onChange:N=>o(N.target.value),className:"input-field",placeholder:"(00) 00000-0000"})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Senha"}),r.jsx("input",{type:"password",value:i,onChange:N=>c(N.target.value),className:"input-field",placeholder:"‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢",required:!0,minLength:6})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Confirmar Senha"}),r.jsx("input",{type:"password",value:l,onChange:N=>h(N.target.value),className:"input-field",placeholder:"‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢",required:!0,minLength:6})]}),r.jsx("button",{type:"submit",disabled:f,className:"btn-primary w-full",children:f?"Criando conta...":"Criar Conta"})]}),r.jsx("div",{className:"mt-6 text-center",children:r.jsxs("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:["J√° tem uma conta?"," ",r.jsx(Lt,{to:"/login",className:"font-medium text-primary-600 hover:text-primary-700",children:"Fazer login"})]})})]})})})}const fe={async getPipelines(){const{data:t}=await k.get("/leads/pipelines");return t},async getPipeline(t){const{data:e}=await k.get(`/leads/pipelines/${t}`);return e},async createPipeline(t){const{data:e}=await k.post("/leads/pipelines",t);return e},async updatePipeline(t,e){const{data:s}=await k.put(`/leads/pipelines/${t}`,e);return s},async deletePipeline(t){await k.delete(`/leads/pipelines/${t}`)},async createStage(t){const{data:e}=await k.post("/leads/stages",t);return e},async updateStage(t,e){const{data:s}=await k.put(`/leads/stages/${t}`,e);return s},async deleteStage(t){await k.delete(`/leads/stages/${t}`)},async reorderStages(t){await k.post("/leads/stages/reorder",{stageOrders:t})},async getLeads(t){const{data:e}=await k.get("/leads/leads",{params:t});return e},async getLead(t){const{data:e}=await k.get(`/leads/leads/${t}`);return e},async createLead(t){const{data:e}=await k.post("/leads/leads",t);return e},async updateLead(t,e){const{data:s}=await k.put(`/leads/leads/${t}`,e);return s},async deleteLead(t){await k.delete(`/leads/leads/${t}`)},async moveLeadToStage(t,e){const{data:s}=await k.post(`/leads/leads/${t}/move`,{stageId:e});return s},async bulkUpdateLeads(t,e){const{data:s}=await k.post("/leads/leads/bulk-update",{leadIds:t,data:e});return s},async getLeadActivities(t){const{data:e}=await k.get(`/leads/leads/${t}/activities`);return e},async createActivity(t,e){const{data:s}=await k.post(`/leads/leads/${t}/activities`,e);return s},async completeActivity(t){const{data:e}=await k.put(`/leads/activities/${t}/complete`);return e},async getLeadStats(){const{data:t}=await k.get("/leads/leads/stats");return t},async getProcedures(){const{data:t}=await k.get("/leads/procedures");return t},async getProcedure(t){const{data:e}=await k.get(`/leads/procedures/${t}`);return e},async createProcedure(t){const{data:e}=await k.post("/leads/procedures",t);return e},async updateProcedure(t,e){const{data:s}=await k.put(`/leads/procedures/${t}`,e);return s},async deleteProcedure(t){await k.delete(`/leads/procedures/${t}`)}};function wa(){const{user:t}=ft(),e=Vt(),[s,n]=u.useState(!0),[a,o]=u.useState({newLeads:0,totalPatients:0,avgAttendanceTime:0,conversionRate:0,avgTicket:0,uptime:99.9,attendancesByClinic:{moema:0,avPaulista:0}}),[i,c]=u.useState([]),[l,h]=u.useState(!1),[d,f]=u.useState([]),[m,y]=u.useState([]),[N,v]=u.useState(0);u.useEffect(()=>{C()},[]);const C=async()=>{try{n(!0);const p=await fe.getLeads(),S=new Date;S.setHours(0,0,0,0);const g=p.filter(M=>{const $=new Date(M.createdAt);return $.setHours(0,0,0,0),$.getTime()===S.getTime()}),T=new Date;T.setDate(T.getDate()-2);const A=p.filter(M=>!M.activities||M.activities.length===0?!0:new Date(M.activities[0].createdAt)<T),E=p.filter(M=>{var $;return(($=M.stage)==null?void 0:$.name)==="Fechado"}),D=p.length>0?E.length/p.length*100:0,q=E.reduce((M,$)=>M+($.estimatedValue||0),0),W=E.length>0?q/E.length:0,Q=p.filter(M=>{var $;return M.attendanceLocation==="clinic"||(($=M.city)==null?void 0:$.toLowerCase().includes("moema"))}),G=p.filter(M=>{var $;return($=M.city)==null?void 0:$.toLowerCase().includes("paulista")});o({newLeads:g.length,totalPatients:p.length,avgAttendanceTime:45,conversionRate:Math.round(D),avgTicket:W,uptime:99.9,attendancesByClinic:{moema:Q.length,avPaulista:G.length}}),c(g.slice(0,10)),v(A.length),f([{id:"1",type:"lead",title:"Novo lead cadastrado",description:g.length>0?g[0].name:"Aguardando novos leads",time:"H√° 5 minutos",color:"bg-blue-100 text-blue-600"},{id:"2",type:"appointment",title:"Agendamento confirmado",description:"Cliente confirmou consulta para amanh√£",time:"H√° 15 minutos",color:"bg-green-100 text-green-600"},{id:"3",type:"payment",title:"Pagamento recebido",description:"R$ 350,00 via PIX",time:"H√° 1 hora",color:"bg-purple-100 text-purple-600"}]),y([{id:"1",patientName:"Maria Silva",doctorName:"Dr. Jo√£o Santos",room:"Sala 1",procedure:"Consulta Inicial",status:"em_atendimento"},{id:"2",patientName:"Pedro Oliveira",doctorName:"Dra. Ana Costa",room:"Sala 2",procedure:"Retorno",status:"aguardando"}])}catch(p){console.error("Erro ao carregar dashboard:",p),_.error("Erro ao carregar dados do dashboard")}finally{n(!1)}},b=p=>({aguardando:"Aguardando",em_atendimento:"Em Atendimento",finalizado:"Finalizado",retorno_marcado:"Retorno Marcado"})[p]||p,x=p=>({aguardando:"bg-yellow-100 text-yellow-800",em_atendimento:"bg-blue-100 text-blue-800",finalizado:"bg-green-100 text-green-800",retorno_marcado:"bg-purple-100 text-purple-800"})[p]||"bg-gray-100 text-gray-800";return s?r.jsx("div",{className:"flex items-center justify-center h-screen",children:r.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-primary-600"})}):r.jsxs("div",{className:"space-y-6",children:[r.jsxs("div",{children:[r.jsxs("h1",{className:"text-3xl font-bold text-gray-900 dark:text-white mb-2",children:["Bem-vindo, ",t==null?void 0:t.name,"!"]}),r.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:"Vis√£o geral do seu sistema Nexus"})]}),r.jsx("div",{onClick:()=>h(!0),className:"bg-gradient-to-r from-primary-600 to-primary-700 rounded-lg p-6 cursor-pointer hover:from-primary-700 hover:to-primary-800 transition-all shadow-lg",children:r.jsxs("div",{className:"flex items-center justify-between text-white",children:[r.jsxs("div",{children:[r.jsx("p",{className:"text-sm opacity-90 mb-1",children:"Novos Leads Hoje"}),r.jsx("p",{className:"text-4xl font-bold",children:a.newLeads}),r.jsx("p",{className:"text-sm mt-2 opacity-90",children:"Clique para ver detalhes"})]}),r.jsx("div",{className:"bg-white/20 p-4 rounded-full",children:r.jsx(ls,{size:40})})]})}),r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[r.jsx("div",{className:"card",children:r.jsxs("div",{className:"flex items-start justify-between",children:[r.jsxs("div",{children:[r.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 mb-1",children:"Total de Pacientes"}),r.jsx("p",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:a.totalPatients}),r.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Atendidos pela cl√≠nica"})]}),r.jsx("div",{className:"p-3 rounded-lg bg-blue-100 dark:bg-blue-900/20",children:r.jsx(Wn,{className:"text-blue-600",size:24})})]})}),r.jsx("div",{className:"card",children:r.jsxs("div",{className:"flex items-start justify-between",children:[r.jsxs("div",{children:[r.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 mb-1",children:"Tempo M√©dio"}),r.jsxs("p",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:[a.avgAttendanceTime,"min"]}),r.jsx("p",{className:"text-xs text-green-600 mt-1",children:"-5min vs m√™s anterior"})]}),r.jsx("div",{className:"p-3 rounded-lg bg-orange-100 dark:bg-orange-900/20",children:r.jsx(qn,{className:"text-orange-600",size:24})})]})}),r.jsx("div",{className:"card",children:r.jsxs("div",{className:"flex items-start justify-between",children:[r.jsxs("div",{children:[r.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 mb-1",children:"Taxa de Convers√£o"}),r.jsxs("p",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:[a.conversionRate,"%"]}),r.jsx("p",{className:"text-xs text-green-600 mt-1",children:"Lead ‚Üí Fechado"})]}),r.jsx("div",{className:"p-3 rounded-lg bg-green-100 dark:bg-green-900/20",children:r.jsx(Fn,{className:"text-green-600",size:24})})]})}),r.jsx("div",{className:"card",children:r.jsxs("div",{className:"flex items-start justify-between",children:[r.jsxs("div",{children:[r.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 mb-1",children:"Ticket M√©dio"}),r.jsx("p",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format(a.avgTicket)}),r.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Por cliente fechado"})]}),r.jsx("div",{className:"p-3 rounded-lg bg-purple-100 dark:bg-purple-900/20",children:r.jsx(_r,{className:"text-purple-600",size:24})})]})})]}),r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[r.jsx("div",{className:"card",children:r.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[r.jsx("div",{className:"p-2 rounded-lg bg-indigo-100",children:r.jsx(Ks,{className:"text-indigo-600",size:20})}),r.jsxs("div",{children:[r.jsx("p",{className:"text-sm text-gray-600",children:"Moema"}),r.jsx("p",{className:"text-xl font-bold",children:a.attendancesByClinic.moema})]})]})}),r.jsx("div",{className:"card",children:r.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[r.jsx("div",{className:"p-2 rounded-lg bg-indigo-100",children:r.jsx(Ks,{className:"text-indigo-600",size:20})}),r.jsxs("div",{children:[r.jsx("p",{className:"text-sm text-gray-600",children:"AV Paulista"}),r.jsx("p",{className:"text-xl font-bold",children:a.attendancesByClinic.avPaulista})]})]})}),r.jsx("div",{className:"card",children:r.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[r.jsx("div",{className:"p-2 rounded-lg bg-green-100",children:r.jsx($n,{className:"text-green-600",size:20})}),r.jsxs("div",{children:[r.jsx("p",{className:"text-sm text-gray-600",children:"Uptime"}),r.jsxs("p",{className:"text-xl font-bold",children:[a.uptime,"%"]})]})]})})]}),r.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[r.jsxs("div",{className:"card",children:[r.jsxs("h2",{className:"text-xl font-bold mb-4 flex items-center gap-2",children:[r.jsx(Gs,{className:"text-orange-600",size:24}),"Alertas"]}),r.jsxs("div",{className:"space-y-3",children:[N>0&&r.jsx("div",{className:"p-4 bg-orange-50 border border-orange-200 rounded-lg",children:r.jsxs("div",{className:"flex items-start gap-3",children:[r.jsx(Gs,{className:"text-orange-600 flex-shrink-0 mt-0.5",size:20}),r.jsxs("div",{children:[r.jsxs("p",{className:"font-medium text-orange-900",children:[N," Lead",N>1?"s":""," sem resposta"]}),r.jsx("p",{className:"text-sm text-orange-700 mt-1",children:"Existem leads aguardando retorno h√° mais de 2 dias"})]})]})}),N===0&&r.jsxs("div",{className:"text-center py-8 text-gray-500",children:[r.jsx(ds,{className:"mx-auto mb-2 text-green-600",size:40}),r.jsx("p",{children:"Nenhum alerta no momento"})]})]})]}),r.jsxs("div",{className:"card",children:[r.jsx("h2",{className:"text-xl font-bold mb-4",children:"Atividades Recentes"}),r.jsx("div",{className:"space-y-3",children:d.map(p=>r.jsxs("div",{className:"flex items-start gap-3 p-3 bg-gray-50 dark:bg-gray-700/50 rounded-lg",children:[r.jsx("div",{className:`w-2 h-2 rounded-full mt-2 flex-shrink-0 ${p.color.split(" ")[0]}`}),r.jsxs("div",{className:"flex-1 min-w-0",children:[r.jsx("p",{className:"text-sm font-medium text-gray-900 dark:text-white truncate",children:p.title}),r.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400 truncate",children:p.description}),r.jsx("p",{className:"text-xs text-gray-400 mt-1",children:p.time})]})]},p.id))})]})]}),r.jsxs("div",{className:"card",children:[r.jsx("h2",{className:"text-xl font-bold mb-4",children:"Atendimentos Hoje"}),r.jsx("div",{className:"overflow-x-auto",children:r.jsxs("table",{className:"min-w-full divide-y divide-gray-200 dark:divide-gray-700",children:[r.jsx("thead",{className:"bg-gray-50 dark:bg-gray-800",children:r.jsxs("tr",{children:[r.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Paciente"}),r.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"M√©dico"}),r.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Sala"}),r.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Procedimento"}),r.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"})]})}),r.jsx("tbody",{className:"bg-white dark:bg-gray-900 divide-y divide-gray-200 dark:divide-gray-700",children:m.length===0?r.jsx("tr",{children:r.jsx("td",{colSpan:5,className:"px-6 py-8 text-center text-gray-500",children:"Nenhum atendimento agendado para hoje"})}):m.map(p=>r.jsxs("tr",{className:"hover:bg-gray-50 dark:hover:bg-gray-800",children:[r.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900 dark:text-white",children:p.patientName}),r.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500 dark:text-gray-400",children:p.doctorName}),r.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500 dark:text-gray-400",children:p.room}),r.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500 dark:text-gray-400",children:p.procedure}),r.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:r.jsx("span",{className:`px-2 py-1 text-xs font-medium rounded-full ${x(p.status)}`,children:b(p.status)})})]},p.id))})]})})]}),l&&r.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center p-4",children:r.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg max-w-4xl w-full max-h-[80vh] overflow-hidden",children:[r.jsx("div",{className:"p-6 border-b border-gray-200 dark:border-gray-700",children:r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsxs("h3",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:["Novos Leads Hoje (",i.length,")"]}),r.jsx("button",{onClick:()=>h(!1),className:"text-gray-400 hover:text-gray-600 dark:hover:text-gray-300",children:r.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]})}),r.jsx("div",{className:"p-6 overflow-y-auto max-h-[calc(80vh-120px)]",children:i.length===0?r.jsxs("div",{className:"text-center py-12 text-gray-500",children:[r.jsx(ls,{className:"mx-auto mb-3 opacity-50",size:48}),r.jsx("p",{children:"Nenhum lead novo hoje"})]}):r.jsx("div",{className:"space-y-3",children:i.map(p=>r.jsx("div",{onClick:()=>{h(!1),e("/leads",{state:{openLeadId:p.id}})},className:"p-4 border border-gray-200 dark:border-gray-700 rounded-lg hover:bg-gray-50 dark:hover:bg-gray-700 cursor-pointer transition-colors",children:r.jsxs("div",{className:"flex items-start justify-between",children:[r.jsxs("div",{className:"flex-1",children:[r.jsx("h4",{className:"font-semibold text-gray-900 dark:text-white",children:p.name}),r.jsxs("div",{className:"flex items-center gap-4 mt-2 text-sm text-gray-600 dark:text-gray-400",children:[p.phone&&r.jsxs("span",{children:["üìû ",p.phone]}),p.procedure&&r.jsx("span",{children:p.procedure.name}),p.estimatedValue&&r.jsx("span",{className:"text-green-600 font-medium",children:new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format(p.estimatedValue)})]})]}),r.jsx(Vn,{className:"text-gray-400",size:20})]})},p.id))})}),r.jsx("div",{className:"p-4 border-t border-gray-200 dark:border-gray-700 bg-gray-50 dark:bg-gray-900",children:r.jsx("button",{onClick:()=>{h(!1),e("/leads")},className:"w-full btn-primary",children:"Ver Todos os Leads"})})]})})]})}function Dr({isOpen:t,onClose:e,title:s,children:n,size:a="md"}){if(u.useEffect(()=>{const c=l=>{l.key==="Escape"&&e()};if(t){document.addEventListener("keydown",c);const l=document.body.style.overflow;return document.body.style.overflow="hidden",()=>{document.removeEventListener("keydown",c),document.body.style.overflow=l}}},[t,e]),!t)return null;const o={sm:"max-w-md",md:"max-w-2xl",lg:"max-w-4xl",xl:"max-w-6xl"},i=r.jsxs("div",{className:"fixed inset-0 z-[9999] flex items-center justify-center p-4 overflow-y-auto",children:[r.jsx("div",{className:"fixed inset-0 bg-black/50",onClick:e,"aria-hidden":"true"}),r.jsxs("div",{className:`relative w-full ${o[a]} bg-white rounded-lg shadow-2xl z-[10000] my-8`,onClick:c=>c.stopPropagation(),children:[r.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-gray-200",children:[r.jsx("h3",{className:"text-xl font-semibold text-gray-900",children:s}),r.jsx("button",{onClick:e,className:"text-gray-400 hover:text-gray-600 transition-colors p-1 rounded-md hover:bg-gray-100",type:"button",children:r.jsx(dt,{size:24})})]}),r.jsx("div",{className:"p-6 max-h-[calc(100vh-16rem)] overflow-y-auto",children:n})]})]});return Be.createPortal(i,document.body)}const Pr={async getUsers(){const{data:t}=await k.get("/auth/users");return t.data}};function ja({onSubmit:t,onCancel:e,initialData:s,stages:n}){var C,b,x,p,S;const[a,o]=u.useState(!1),[i,c]=u.useState([]),[l,h]=u.useState([]),[d,f]=u.useState({name:(s==null?void 0:s.name)||"",email:(s==null?void 0:s.email)||"",phone:(s==null?void 0:s.phone)||"",phone2:(s==null?void 0:s.phone2)||"",whatsapp:(s==null?void 0:s.whatsapp)||"",neighborhood:(s==null?void 0:s.neighborhood)||"",city:(s==null?void 0:s.city)||"",state:(s==null?void 0:s.state)||"",stageId:(s==null?void 0:s.stageId)||((C=n[0])==null?void 0:C.id)||"",procedureId:(s==null?void 0:s.procedureId)||((b=s==null?void 0:s.procedure)==null?void 0:b.id)||"",assignedToId:((x=s==null?void 0:s.assignedTo)==null?void 0:x.id)||"",source:(s==null?void 0:s.source)||"website",channel:(s==null?void 0:s.channel)||"whatsapp",clientStatus:(s==null?void 0:s.clientStatus)||"conversa_iniciada",attendanceLocation:(s==null?void 0:s.attendanceLocation)||"moema",estimatedValue:(s==null?void 0:s.estimatedValue)||"",expectedCloseDate:((p=s==null?void 0:s.expectedCloseDate)==null?void 0:p.split("T")[0])||"",notes:(s==null?void 0:s.notes)||"",tags:((S=s==null?void 0:s.tags)==null?void 0:S.join(", "))||""});u.useEffect(()=>{m(),y()},[]);const m=async()=>{try{const g=await fe.getProcedures();c(g)}catch(g){console.error("Erro ao carregar procedimentos:",g)}},y=async()=>{try{const g=await Pr.getUsers();h(g)}catch(g){console.error("Erro ao carregar usu√°rios:",g)}},N=async g=>{if(g.preventDefault(),!d.name.trim()){_.error("Nome √© obrigat√≥rio");return}if(!d.stageId){_.error("Selecione um est√°gio");return}o(!0);try{const T={...d,procedureId:d.procedureId||void 0,assignedToId:d.assignedToId||void 0,email:d.email||void 0,phone:d.phone||void 0,phone2:d.phone2||void 0,whatsapp:d.whatsapp||void 0,neighborhood:d.neighborhood||void 0,city:d.city||void 0,state:d.state||void 0,expectedCloseDate:d.expectedCloseDate||void 0,estimatedValue:d.estimatedValue?parseFloat(d.estimatedValue):void 0,tags:d.tags?d.tags.split(",").map(A=>A.trim()).filter(Boolean):[],notes:d.notes||void 0};await t(T),_.success(s?"Lead atualizado com sucesso":"Lead criado com sucesso")}catch(T){_.error(T.message||"Erro ao salvar lead")}finally{o(!1)}},v=(g,T)=>{f(A=>({...A,[g]:T}))};return r.jsxs("form",{onSubmit:N,className:"space-y-6",children:[r.jsxs("div",{children:[r.jsx("h4",{className:"text-sm font-semibold text-gray-700 mb-4",children:"Informa√ß√µes B√°sicas"}),r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[r.jsxs("div",{children:[r.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Nome do Lead ",r.jsx("span",{className:"text-red-500",children:"*"})]}),r.jsx("input",{type:"text",value:d.name,onChange:g=>v("name",g.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500",placeholder:"Nome completo",required:!0})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Email"}),r.jsx("input",{type:"email",value:d.email,onChange:g=>v("email",g.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500",placeholder:"email@exemplo.com"})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Telefone"}),r.jsx("input",{type:"tel",value:d.phone,onChange:g=>v("phone",g.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500",placeholder:"(00) 00000-0000"})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Telefone 2"}),r.jsx("input",{type:"tel",value:d.phone2,onChange:g=>v("phone2",g.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500",placeholder:"(00) 00000-0000"})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"WhatsApp"}),r.jsx("input",{type:"tel",value:d.whatsapp,onChange:g=>v("whatsapp",g.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500",placeholder:"(00) 00000-0000"})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Bairro"}),r.jsx("input",{type:"text",value:d.neighborhood,onChange:g=>v("neighborhood",g.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500",placeholder:"Bairro"})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Cidade"}),r.jsx("input",{type:"text",value:d.city,onChange:g=>v("city",g.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500",placeholder:"Cidade"})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Estado"}),r.jsxs("select",{value:d.state,onChange:g=>v("state",g.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500",children:[r.jsx("option",{value:"",children:"Selecione"}),r.jsx("option",{value:"AC",children:"Acre"}),r.jsx("option",{value:"AL",children:"Alagoas"}),r.jsx("option",{value:"AP",children:"Amap√°"}),r.jsx("option",{value:"AM",children:"Amazonas"}),r.jsx("option",{value:"BA",children:"Bahia"}),r.jsx("option",{value:"CE",children:"Cear√°"}),r.jsx("option",{value:"DF",children:"Distrito Federal"}),r.jsx("option",{value:"ES",children:"Esp√≠rito Santo"}),r.jsx("option",{value:"GO",children:"Goi√°s"}),r.jsx("option",{value:"MA",children:"Maranh√£o"}),r.jsx("option",{value:"MT",children:"Mato Grosso"}),r.jsx("option",{value:"MS",children:"Mato Grosso do Sul"}),r.jsx("option",{value:"MG",children:"Minas Gerais"}),r.jsx("option",{value:"PA",children:"Par√°"}),r.jsx("option",{value:"PB",children:"Para√≠ba"}),r.jsx("option",{value:"PR",children:"Paran√°"}),r.jsx("option",{value:"PE",children:"Pernambuco"}),r.jsx("option",{value:"PI",children:"Piau√≠"}),r.jsx("option",{value:"RJ",children:"Rio de Janeiro"}),r.jsx("option",{value:"RN",children:"Rio Grande do Norte"}),r.jsx("option",{value:"RS",children:"Rio Grande do Sul"}),r.jsx("option",{value:"RO",children:"Rond√¥nia"}),r.jsx("option",{value:"RR",children:"Roraima"}),r.jsx("option",{value:"SC",children:"Santa Catarina"}),r.jsx("option",{value:"SP",children:"S√£o Paulo"}),r.jsx("option",{value:"SE",children:"Sergipe"}),r.jsx("option",{value:"TO",children:"Tocantins"})]})]}),r.jsxs("div",{children:[r.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Est√°gio ",r.jsx("span",{className:"text-red-500",children:"*"})]}),r.jsx("select",{value:d.stageId,onChange:g=>v("stageId",g.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500",required:!0,children:n.map(g=>r.jsx("option",{value:g.id,children:g.name},g.id))})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Procedimento"}),r.jsxs("select",{value:d.procedureId,onChange:g=>v("procedureId",g.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500",children:[r.jsx("option",{value:"",children:"Selecione um procedimento"}),i.map(g=>{const T=g.price?Number(g.price):null;return r.jsxs("option",{value:g.id,children:[g.name," ",T?`- R$ ${T.toFixed(2)}`:""]},g.id)})]})]}),r.jsxs("div",{children:[r.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Respons√°vel ",r.jsx("span",{className:"text-xs text-gray-500",children:"(Atendimento)"})]}),r.jsxs("select",{value:d.assignedToId,onChange:g=>v("assignedToId",g.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500",children:[r.jsx("option",{value:"",children:"Selecione um respons√°vel"}),l.map(g=>r.jsxs("option",{value:g.id,children:[g.name," (",g.email,")"]},g.id))]})]})]})]}),r.jsxs("div",{children:[r.jsx("h4",{className:"text-sm font-semibold text-gray-700 mb-4",children:"Detalhes da Venda"}),r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Origem"}),r.jsxs("select",{value:d.source,onChange:g=>v("source",g.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500",children:[r.jsx("option",{value:"website",children:"Website"}),r.jsx("option",{value:"referral",children:"Indica√ß√£o"}),r.jsx("option",{value:"social_media",children:"Redes Sociais"}),r.jsx("option",{value:"email",children:"Email"}),r.jsx("option",{value:"phone",children:"Telefone"}),r.jsx("option",{value:"other",children:"Outro"})]})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Canal"}),r.jsxs("select",{value:d.channel,onChange:g=>v("channel",g.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500",children:[r.jsx("option",{value:"whatsapp",children:"WhatsApp"}),r.jsx("option",{value:"instagram",children:"Instagram"}),r.jsx("option",{value:"facebook",children:"Facebook"}),r.jsx("option",{value:"site",children:"Site"}),r.jsx("option",{value:"campanha",children:"Campanha"}),r.jsx("option",{value:"bairro",children:"Bairro"}),r.jsx("option",{value:"indicacao",children:"Indica√ß√£o"})]})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Situa√ß√£o do Cliente"}),r.jsxs("select",{value:d.clientStatus,onChange:g=>v("clientStatus",g.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500",children:[r.jsx("option",{value:"conversa_iniciada",children:"Conversa Iniciada"}),r.jsx("option",{value:"cliente_potencial",children:"Cliente Potencial"}),r.jsx("option",{value:"sem_potencial",children:"Sem Potencial"}),r.jsx("option",{value:"contatar_futuro",children:"Contatar no Futuro"}),r.jsx("option",{value:"sem_retorno",children:"Sem Retorno"}),r.jsx("option",{value:"pre_qualificado",children:"Pr√© Qualificado"}),r.jsx("option",{value:"qualificado",children:"Qualificado"})]})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Local de Atendimento"}),r.jsxs("select",{value:d.attendanceLocation,onChange:g=>v("attendanceLocation",g.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500",children:[r.jsx("option",{value:"moema",children:"Moema"}),r.jsx("option",{value:"av_paulista",children:"Av. Paulista"})]})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Valor Estimado"}),r.jsx("input",{type:"number",step:"0.01",value:d.estimatedValue,onChange:g=>v("estimatedValue",g.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500",placeholder:"0.00"})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Data de Fechamento Esperada"}),r.jsx("input",{type:"date",value:d.expectedCloseDate,onChange:g=>v("expectedCloseDate",g.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500"})]})]})]}),r.jsxs("div",{children:[r.jsx("h4",{className:"text-sm font-semibold text-gray-700 mb-4",children:"Informa√ß√µes Adicionais"}),r.jsxs("div",{className:"space-y-4",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Tags"}),r.jsx("input",{type:"text",value:d.tags,onChange:g=>v("tags",g.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500",placeholder:"Separadas por v√≠rgula: tag1, tag2, tag3"}),r.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Separe as tags com v√≠rgulas"})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Observa√ß√µes"}),r.jsx("textarea",{value:d.notes,onChange:g=>v("notes",g.target.value),rows:4,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500",placeholder:"Adicione observa√ß√µes sobre este lead..."})]})]})]}),r.jsxs("div",{className:"flex justify-end gap-3 pt-4 border-t border-gray-200",children:[r.jsx("button",{type:"button",onClick:e,className:"px-4 py-2 text-gray-700 bg-white border border-gray-300 rounded-lg hover:bg-gray-50",disabled:a,children:"Cancelar"}),r.jsx("button",{type:"submit",className:"px-4 py-2 text-white bg-primary-600 rounded-lg hover:bg-primary-700 disabled:opacity-50",disabled:a,children:a?"Salvando...":s?"Atualizar Lead":"Criar Lead"})]})]})}function B(t){const e=Object.prototype.toString.call(t);return t instanceof Date||typeof t=="object"&&e==="[object Date]"?new t.constructor(+t):typeof t=="number"||e==="[object Number]"||typeof t=="string"||e==="[object String]"?new Date(t):new Date(NaN)}function Me(t,e){return t instanceof Date?new t.constructor(e):new Date(e)}const Ir=6048e5,Na=864e5,kt=43200,tr=1440;let ka={};function gt(){return ka}function ut(t,e){var c,l,h,d;const s=gt(),n=(e==null?void 0:e.weekStartsOn)??((l=(c=e==null?void 0:e.locale)==null?void 0:c.options)==null?void 0:l.weekStartsOn)??s.weekStartsOn??((d=(h=s.locale)==null?void 0:h.options)==null?void 0:d.weekStartsOn)??0,a=B(t),o=a.getDay(),i=(o<n?7:0)+o-n;return a.setDate(a.getDate()-i),a.setHours(0,0,0,0),a}function Dt(t){return ut(t,{weekStartsOn:1})}function Br(t){const e=B(t),s=e.getFullYear(),n=Me(t,0);n.setFullYear(s+1,0,4),n.setHours(0,0,0,0);const a=Dt(n),o=Me(t,0);o.setFullYear(s,0,4),o.setHours(0,0,0,0);const i=Dt(o);return e.getTime()>=a.getTime()?s+1:e.getTime()>=i.getTime()?s:s-1}function sr(t){const e=B(t);return e.setHours(0,0,0,0),e}function Pt(t){const e=B(t),s=new Date(Date.UTC(e.getFullYear(),e.getMonth(),e.getDate(),e.getHours(),e.getMinutes(),e.getSeconds(),e.getMilliseconds()));return s.setUTCFullYear(e.getFullYear()),+t-+s}function Ca(t,e){const s=sr(t),n=sr(e),a=+s-Pt(s),o=+n-Pt(n);return Math.round((a-o)/Na)}function Sa(t){const e=Br(t),s=Me(t,0);return s.setFullYear(e,0,4),s.setHours(0,0,0,0),Dt(s)}function Et(t,e){const s=B(t),n=B(e),a=s.getTime()-n.getTime();return a<0?-1:a>0?1:a}function Ea(t){return Me(t,Date.now())}function Aa(t){return t instanceof Date||typeof t=="object"&&Object.prototype.toString.call(t)==="[object Date]"}function Ra(t){if(!Aa(t)&&typeof t!="number")return!1;const e=B(t);return!isNaN(Number(e))}function Ta(t,e){const s=B(t),n=B(e),a=s.getFullYear()-n.getFullYear(),o=s.getMonth()-n.getMonth();return a*12+o}function _a(t){return e=>{const n=(t?Math[t]:Math.trunc)(e);return n===0?0:n}}function Oa(t,e){return+B(t)-+B(e)}function La(t){const e=B(t);return e.setHours(23,59,59,999),e}function Ma(t){const e=B(t),s=e.getMonth();return e.setFullYear(e.getFullYear(),s+1,0),e.setHours(23,59,59,999),e}function Da(t){const e=B(t);return+La(e)==+Ma(e)}function Pa(t,e){const s=B(t),n=B(e),a=Et(s,n),o=Math.abs(Ta(s,n));let i;if(o<1)i=0;else{s.getMonth()===1&&s.getDate()>27&&s.setDate(30),s.setMonth(s.getMonth()-a*o);let c=Et(s,n)===-a;Da(B(t))&&o===1&&Et(t,n)===1&&(c=!1),i=a*(o-Number(c))}return i===0?0:i}function Ia(t,e,s){const n=Oa(t,e)/1e3;return _a(s==null?void 0:s.roundingMethod)(n)}function Ba(t){const e=B(t),s=Me(t,0);return s.setFullYear(e.getFullYear(),0,1),s.setHours(0,0,0,0),s}const Wa={lessThanXSeconds:{one:"less than a second",other:"less than {{count}} seconds"},xSeconds:{one:"1 second",other:"{{count}} seconds"},halfAMinute:"half a minute",lessThanXMinutes:{one:"less than a minute",other:"less than {{count}} minutes"},xMinutes:{one:"1 minute",other:"{{count}} minutes"},aboutXHours:{one:"about 1 hour",other:"about {{count}} hours"},xHours:{one:"1 hour",other:"{{count}} hours"},xDays:{one:"1 day",other:"{{count}} days"},aboutXWeeks:{one:"about 1 week",other:"about {{count}} weeks"},xWeeks:{one:"1 week",other:"{{count}} weeks"},aboutXMonths:{one:"about 1 month",other:"about {{count}} months"},xMonths:{one:"1 month",other:"{{count}} months"},aboutXYears:{one:"about 1 year",other:"about {{count}} years"},xYears:{one:"1 year",other:"{{count}} years"},overXYears:{one:"over 1 year",other:"over {{count}} years"},almostXYears:{one:"almost 1 year",other:"almost {{count}} years"}},qa=(t,e,s)=>{let n;const a=Wa[t];return typeof a=="string"?n=a:e===1?n=a.one:n=a.other.replace("{{count}}",e.toString()),s!=null&&s.addSuffix?s.comparison&&s.comparison>0?"in "+n:n+" ago":n};function He(t){return(e={})=>{const s=e.width?String(e.width):t.defaultWidth;return t.formats[s]||t.formats[t.defaultWidth]}}const Fa={full:"EEEE, MMMM do, y",long:"MMMM do, y",medium:"MMM d, y",short:"MM/dd/yyyy"},$a={full:"h:mm:ss a zzzz",long:"h:mm:ss a z",medium:"h:mm:ss a",short:"h:mm a"},Va={full:"{{date}} 'at' {{time}}",long:"{{date}} 'at' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},za={date:He({formats:Fa,defaultWidth:"full"}),time:He({formats:$a,defaultWidth:"full"}),dateTime:He({formats:Va,defaultWidth:"full"})},Ya={lastWeek:"'last' eeee 'at' p",yesterday:"'yesterday at' p",today:"'today at' p",tomorrow:"'tomorrow at' p",nextWeek:"eeee 'at' p",other:"P"},Ua=(t,e,s,n)=>Ya[t];function be(t){return(e,s)=>{const n=s!=null&&s.context?String(s.context):"standalone";let a;if(n==="formatting"&&t.formattingValues){const i=t.defaultFormattingWidth||t.defaultWidth,c=s!=null&&s.width?String(s.width):i;a=t.formattingValues[c]||t.formattingValues[i]}else{const i=t.defaultWidth,c=s!=null&&s.width?String(s.width):t.defaultWidth;a=t.values[c]||t.values[i]}const o=t.argumentCallback?t.argumentCallback(e):e;return a[o]}}const Ha={narrow:["B","A"],abbreviated:["BC","AD"],wide:["Before Christ","Anno Domini"]},Xa={narrow:["1","2","3","4"],abbreviated:["Q1","Q2","Q3","Q4"],wide:["1st quarter","2nd quarter","3rd quarter","4th quarter"]},Qa={narrow:["J","F","M","A","M","J","J","A","S","O","N","D"],abbreviated:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],wide:["January","February","March","April","May","June","July","August","September","October","November","December"]},Ka={narrow:["S","M","T","W","T","F","S"],short:["Su","Mo","Tu","We","Th","Fr","Sa"],abbreviated:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],wide:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]},Ga={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"}},Ja={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"}},Za=(t,e)=>{const s=Number(t),n=s%100;if(n>20||n<10)switch(n%10){case 1:return s+"st";case 2:return s+"nd";case 3:return s+"rd"}return s+"th"},eo={ordinalNumber:Za,era:be({values:Ha,defaultWidth:"wide"}),quarter:be({values:Xa,defaultWidth:"wide",argumentCallback:t=>t-1}),month:be({values:Qa,defaultWidth:"wide"}),day:be({values:Ka,defaultWidth:"wide"}),dayPeriod:be({values:Ga,defaultWidth:"wide",formattingValues:Ja,defaultFormattingWidth:"wide"})};function ve(t){return(e,s={})=>{const n=s.width,a=n&&t.matchPatterns[n]||t.matchPatterns[t.defaultMatchWidth],o=e.match(a);if(!o)return null;const i=o[0],c=n&&t.parsePatterns[n]||t.parsePatterns[t.defaultParseWidth],l=Array.isArray(c)?so(c,f=>f.test(i)):to(c,f=>f.test(i));let h;h=t.valueCallback?t.valueCallback(l):l,h=s.valueCallback?s.valueCallback(h):h;const d=e.slice(i.length);return{value:h,rest:d}}}function to(t,e){for(const s in t)if(Object.prototype.hasOwnProperty.call(t,s)&&e(t[s]))return s}function so(t,e){for(let s=0;s<t.length;s++)if(e(t[s]))return s}function Wr(t){return(e,s={})=>{const n=e.match(t.matchPattern);if(!n)return null;const a=n[0],o=e.match(t.parsePattern);if(!o)return null;let i=t.valueCallback?t.valueCallback(o[0]):o[0];i=s.valueCallback?s.valueCallback(i):i;const c=e.slice(a.length);return{value:i,rest:c}}}const ro=/^(\d+)(th|st|nd|rd)?/i,no=/\d+/i,ao={narrow:/^(b|a)/i,abbreviated:/^(b\.?\s?c\.?|b\.?\s?c\.?\s?e\.?|a\.?\s?d\.?|c\.?\s?e\.?)/i,wide:/^(before christ|before common era|anno domini|common era)/i},oo={any:[/^b/i,/^(a|c)/i]},io={narrow:/^[1234]/i,abbreviated:/^q[1234]/i,wide:/^[1234](th|st|nd|rd)? quarter/i},co={any:[/1/i,/2/i,/3/i,/4/i]},lo={narrow:/^[jfmasond]/i,abbreviated:/^(jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec)/i,wide:/^(january|february|march|april|may|june|july|august|september|october|november|december)/i},uo={narrow:[/^j/i,/^f/i,/^m/i,/^a/i,/^m/i,/^j/i,/^j/i,/^a/i,/^s/i,/^o/i,/^n/i,/^d/i],any:[/^ja/i,/^f/i,/^mar/i,/^ap/i,/^may/i,/^jun/i,/^jul/i,/^au/i,/^s/i,/^o/i,/^n/i,/^d/i]},ho={narrow:/^[smtwf]/i,short:/^(su|mo|tu|we|th|fr|sa)/i,abbreviated:/^(sun|mon|tue|wed|thu|fri|sat)/i,wide:/^(sunday|monday|tuesday|wednesday|thursday|friday|saturday)/i},mo={narrow:[/^s/i,/^m/i,/^t/i,/^w/i,/^t/i,/^f/i,/^s/i],any:[/^su/i,/^m/i,/^tu/i,/^w/i,/^th/i,/^f/i,/^sa/i]},fo={narrow:/^(a|p|mi|n|(in the|at) (morning|afternoon|evening|night))/i,any:/^([ap]\.?\s?m\.?|midnight|noon|(in the|at) (morning|afternoon|evening|night))/i},go={any:{am:/^a/i,pm:/^p/i,midnight:/^mi/i,noon:/^no/i,morning:/morning/i,afternoon:/afternoon/i,evening:/evening/i,night:/night/i}},po={ordinalNumber:Wr({matchPattern:ro,parsePattern:no,valueCallback:t=>parseInt(t,10)}),era:ve({matchPatterns:ao,defaultMatchWidth:"wide",parsePatterns:oo,defaultParseWidth:"any"}),quarter:ve({matchPatterns:io,defaultMatchWidth:"wide",parsePatterns:co,defaultParseWidth:"any",valueCallback:t=>t+1}),month:ve({matchPatterns:lo,defaultMatchWidth:"wide",parsePatterns:uo,defaultParseWidth:"any"}),day:ve({matchPatterns:ho,defaultMatchWidth:"wide",parsePatterns:mo,defaultParseWidth:"any"}),dayPeriod:ve({matchPatterns:fo,defaultMatchWidth:"any",parsePatterns:go,defaultParseWidth:"any"})},qr={code:"en-US",formatDistance:qa,formatLong:za,formatRelative:Ua,localize:eo,match:po,options:{weekStartsOn:0,firstWeekContainsDate:1}};function xo(t){const e=B(t);return Ca(e,Ba(e))+1}function yo(t){const e=B(t),s=+Dt(e)-+Sa(e);return Math.round(s/Ir)+1}function Fr(t,e){var d,f,m,y;const s=B(t),n=s.getFullYear(),a=gt(),o=(e==null?void 0:e.firstWeekContainsDate)??((f=(d=e==null?void 0:e.locale)==null?void 0:d.options)==null?void 0:f.firstWeekContainsDate)??a.firstWeekContainsDate??((y=(m=a.locale)==null?void 0:m.options)==null?void 0:y.firstWeekContainsDate)??1,i=Me(t,0);i.setFullYear(n+1,0,o),i.setHours(0,0,0,0);const c=ut(i,e),l=Me(t,0);l.setFullYear(n,0,o),l.setHours(0,0,0,0);const h=ut(l,e);return s.getTime()>=c.getTime()?n+1:s.getTime()>=h.getTime()?n:n-1}function bo(t,e){var c,l,h,d;const s=gt(),n=(e==null?void 0:e.firstWeekContainsDate)??((l=(c=e==null?void 0:e.locale)==null?void 0:c.options)==null?void 0:l.firstWeekContainsDate)??s.firstWeekContainsDate??((d=(h=s.locale)==null?void 0:h.options)==null?void 0:d.firstWeekContainsDate)??1,a=Fr(t,e),o=Me(t,0);return o.setFullYear(a,0,n),o.setHours(0,0,0,0),ut(o,e)}function vo(t,e){const s=B(t),n=+ut(s,e)-+bo(s,e);return Math.round(n/Ir)+1}function P(t,e){const s=t<0?"-":"",n=Math.abs(t).toString().padStart(e,"0");return s+n}const _e={y(t,e){const s=t.getFullYear(),n=s>0?s:1-s;return P(e==="yy"?n%100:n,e.length)},M(t,e){const s=t.getMonth();return e==="M"?String(s+1):P(s+1,2)},d(t,e){return P(t.getDate(),e.length)},a(t,e){const s=t.getHours()/12>=1?"pm":"am";switch(e){case"a":case"aa":return s.toUpperCase();case"aaa":return s;case"aaaaa":return s[0];case"aaaa":default:return s==="am"?"a.m.":"p.m."}},h(t,e){return P(t.getHours()%12||12,e.length)},H(t,e){return P(t.getHours(),e.length)},m(t,e){return P(t.getMinutes(),e.length)},s(t,e){return P(t.getSeconds(),e.length)},S(t,e){const s=e.length,n=t.getMilliseconds(),a=Math.trunc(n*Math.pow(10,s-3));return P(a,e.length)}},Ye={midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},rr={G:function(t,e,s){const n=t.getFullYear()>0?1:0;switch(e){case"G":case"GG":case"GGG":return s.era(n,{width:"abbreviated"});case"GGGGG":return s.era(n,{width:"narrow"});case"GGGG":default:return s.era(n,{width:"wide"})}},y:function(t,e,s){if(e==="yo"){const n=t.getFullYear(),a=n>0?n:1-n;return s.ordinalNumber(a,{unit:"year"})}return _e.y(t,e)},Y:function(t,e,s,n){const a=Fr(t,n),o=a>0?a:1-a;if(e==="YY"){const i=o%100;return P(i,2)}return e==="Yo"?s.ordinalNumber(o,{unit:"year"}):P(o,e.length)},R:function(t,e){const s=Br(t);return P(s,e.length)},u:function(t,e){const s=t.getFullYear();return P(s,e.length)},Q:function(t,e,s){const n=Math.ceil((t.getMonth()+1)/3);switch(e){case"Q":return String(n);case"QQ":return P(n,2);case"Qo":return s.ordinalNumber(n,{unit:"quarter"});case"QQQ":return s.quarter(n,{width:"abbreviated",context:"formatting"});case"QQQQQ":return s.quarter(n,{width:"narrow",context:"formatting"});case"QQQQ":default:return s.quarter(n,{width:"wide",context:"formatting"})}},q:function(t,e,s){const n=Math.ceil((t.getMonth()+1)/3);switch(e){case"q":return String(n);case"qq":return P(n,2);case"qo":return s.ordinalNumber(n,{unit:"quarter"});case"qqq":return s.quarter(n,{width:"abbreviated",context:"standalone"});case"qqqqq":return s.quarter(n,{width:"narrow",context:"standalone"});case"qqqq":default:return s.quarter(n,{width:"wide",context:"standalone"})}},M:function(t,e,s){const n=t.getMonth();switch(e){case"M":case"MM":return _e.M(t,e);case"Mo":return s.ordinalNumber(n+1,{unit:"month"});case"MMM":return s.month(n,{width:"abbreviated",context:"formatting"});case"MMMMM":return s.month(n,{width:"narrow",context:"formatting"});case"MMMM":default:return s.month(n,{width:"wide",context:"formatting"})}},L:function(t,e,s){const n=t.getMonth();switch(e){case"L":return String(n+1);case"LL":return P(n+1,2);case"Lo":return s.ordinalNumber(n+1,{unit:"month"});case"LLL":return s.month(n,{width:"abbreviated",context:"standalone"});case"LLLLL":return s.month(n,{width:"narrow",context:"standalone"});case"LLLL":default:return s.month(n,{width:"wide",context:"standalone"})}},w:function(t,e,s,n){const a=vo(t,n);return e==="wo"?s.ordinalNumber(a,{unit:"week"}):P(a,e.length)},I:function(t,e,s){const n=yo(t);return e==="Io"?s.ordinalNumber(n,{unit:"week"}):P(n,e.length)},d:function(t,e,s){return e==="do"?s.ordinalNumber(t.getDate(),{unit:"date"}):_e.d(t,e)},D:function(t,e,s){const n=xo(t);return e==="Do"?s.ordinalNumber(n,{unit:"dayOfYear"}):P(n,e.length)},E:function(t,e,s){const n=t.getDay();switch(e){case"E":case"EE":case"EEE":return s.day(n,{width:"abbreviated",context:"formatting"});case"EEEEE":return s.day(n,{width:"narrow",context:"formatting"});case"EEEEEE":return s.day(n,{width:"short",context:"formatting"});case"EEEE":default:return s.day(n,{width:"wide",context:"formatting"})}},e:function(t,e,s,n){const a=t.getDay(),o=(a-n.weekStartsOn+8)%7||7;switch(e){case"e":return String(o);case"ee":return P(o,2);case"eo":return s.ordinalNumber(o,{unit:"day"});case"eee":return s.day(a,{width:"abbreviated",context:"formatting"});case"eeeee":return s.day(a,{width:"narrow",context:"formatting"});case"eeeeee":return s.day(a,{width:"short",context:"formatting"});case"eeee":default:return s.day(a,{width:"wide",context:"formatting"})}},c:function(t,e,s,n){const a=t.getDay(),o=(a-n.weekStartsOn+8)%7||7;switch(e){case"c":return String(o);case"cc":return P(o,e.length);case"co":return s.ordinalNumber(o,{unit:"day"});case"ccc":return s.day(a,{width:"abbreviated",context:"standalone"});case"ccccc":return s.day(a,{width:"narrow",context:"standalone"});case"cccccc":return s.day(a,{width:"short",context:"standalone"});case"cccc":default:return s.day(a,{width:"wide",context:"standalone"})}},i:function(t,e,s){const n=t.getDay(),a=n===0?7:n;switch(e){case"i":return String(a);case"ii":return P(a,e.length);case"io":return s.ordinalNumber(a,{unit:"day"});case"iii":return s.day(n,{width:"abbreviated",context:"formatting"});case"iiiii":return s.day(n,{width:"narrow",context:"formatting"});case"iiiiii":return s.day(n,{width:"short",context:"formatting"});case"iiii":default:return s.day(n,{width:"wide",context:"formatting"})}},a:function(t,e,s){const a=t.getHours()/12>=1?"pm":"am";switch(e){case"a":case"aa":return s.dayPeriod(a,{width:"abbreviated",context:"formatting"});case"aaa":return s.dayPeriod(a,{width:"abbreviated",context:"formatting"}).toLowerCase();case"aaaaa":return s.dayPeriod(a,{width:"narrow",context:"formatting"});case"aaaa":default:return s.dayPeriod(a,{width:"wide",context:"formatting"})}},b:function(t,e,s){const n=t.getHours();let a;switch(n===12?a=Ye.noon:n===0?a=Ye.midnight:a=n/12>=1?"pm":"am",e){case"b":case"bb":return s.dayPeriod(a,{width:"abbreviated",context:"formatting"});case"bbb":return s.dayPeriod(a,{width:"abbreviated",context:"formatting"}).toLowerCase();case"bbbbb":return s.dayPeriod(a,{width:"narrow",context:"formatting"});case"bbbb":default:return s.dayPeriod(a,{width:"wide",context:"formatting"})}},B:function(t,e,s){const n=t.getHours();let a;switch(n>=17?a=Ye.evening:n>=12?a=Ye.afternoon:n>=4?a=Ye.morning:a=Ye.night,e){case"B":case"BB":case"BBB":return s.dayPeriod(a,{width:"abbreviated",context:"formatting"});case"BBBBB":return s.dayPeriod(a,{width:"narrow",context:"formatting"});case"BBBB":default:return s.dayPeriod(a,{width:"wide",context:"formatting"})}},h:function(t,e,s){if(e==="ho"){let n=t.getHours()%12;return n===0&&(n=12),s.ordinalNumber(n,{unit:"hour"})}return _e.h(t,e)},H:function(t,e,s){return e==="Ho"?s.ordinalNumber(t.getHours(),{unit:"hour"}):_e.H(t,e)},K:function(t,e,s){const n=t.getHours()%12;return e==="Ko"?s.ordinalNumber(n,{unit:"hour"}):P(n,e.length)},k:function(t,e,s){let n=t.getHours();return n===0&&(n=24),e==="ko"?s.ordinalNumber(n,{unit:"hour"}):P(n,e.length)},m:function(t,e,s){return e==="mo"?s.ordinalNumber(t.getMinutes(),{unit:"minute"}):_e.m(t,e)},s:function(t,e,s){return e==="so"?s.ordinalNumber(t.getSeconds(),{unit:"second"}):_e.s(t,e)},S:function(t,e){return _e.S(t,e)},X:function(t,e,s){const n=t.getTimezoneOffset();if(n===0)return"Z";switch(e){case"X":return ar(n);case"XXXX":case"XX":return Ie(n);case"XXXXX":case"XXX":default:return Ie(n,":")}},x:function(t,e,s){const n=t.getTimezoneOffset();switch(e){case"x":return ar(n);case"xxxx":case"xx":return Ie(n);case"xxxxx":case"xxx":default:return Ie(n,":")}},O:function(t,e,s){const n=t.getTimezoneOffset();switch(e){case"O":case"OO":case"OOO":return"GMT"+nr(n,":");case"OOOO":default:return"GMT"+Ie(n,":")}},z:function(t,e,s){const n=t.getTimezoneOffset();switch(e){case"z":case"zz":case"zzz":return"GMT"+nr(n,":");case"zzzz":default:return"GMT"+Ie(n,":")}},t:function(t,e,s){const n=Math.trunc(t.getTime()/1e3);return P(n,e.length)},T:function(t,e,s){const n=t.getTime();return P(n,e.length)}};function nr(t,e=""){const s=t>0?"-":"+",n=Math.abs(t),a=Math.trunc(n/60),o=n%60;return o===0?s+String(a):s+String(a)+e+P(o,2)}function ar(t,e){return t%60===0?(t>0?"-":"+")+P(Math.abs(t)/60,2):Ie(t,e)}function Ie(t,e=""){const s=t>0?"-":"+",n=Math.abs(t),a=P(Math.trunc(n/60),2),o=P(n%60,2);return s+a+e+o}const or=(t,e)=>{switch(t){case"P":return e.date({width:"short"});case"PP":return e.date({width:"medium"});case"PPP":return e.date({width:"long"});case"PPPP":default:return e.date({width:"full"})}},$r=(t,e)=>{switch(t){case"p":return e.time({width:"short"});case"pp":return e.time({width:"medium"});case"ppp":return e.time({width:"long"});case"pppp":default:return e.time({width:"full"})}},wo=(t,e)=>{const s=t.match(/(P+)(p+)?/)||[],n=s[1],a=s[2];if(!a)return or(t,e);let o;switch(n){case"P":o=e.dateTime({width:"short"});break;case"PP":o=e.dateTime({width:"medium"});break;case"PPP":o=e.dateTime({width:"long"});break;case"PPPP":default:o=e.dateTime({width:"full"});break}return o.replace("{{date}}",or(n,e)).replace("{{time}}",$r(a,e))},jo={p:$r,P:wo},No=/^D+$/,ko=/^Y+$/,Co=["D","DD","YY","YYYY"];function So(t){return No.test(t)}function Eo(t){return ko.test(t)}function Ao(t,e,s){const n=Ro(t,e,s);if(console.warn(n),Co.includes(t))throw new RangeError(n)}function Ro(t,e,s){const n=t[0]==="Y"?"years":"days of the month";return`Use \`${t.toLowerCase()}\` instead of \`${t}\` (in \`${e}\`) for formatting ${n} to the input \`${s}\`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md`}const To=/[yYQqMLwIdDecihHKkms]o|(\w)\1*|''|'(''|[^'])+('|$)|./g,_o=/P+p+|P+|p+|''|'(''|[^'])+('|$)|./g,Oo=/^'([^]*?)'?$/,Lo=/''/g,Mo=/[a-zA-Z]/;function Vr(t,e,s){var d,f,m,y,N,v,C,b;const n=gt(),a=(s==null?void 0:s.locale)??n.locale??qr,o=(s==null?void 0:s.firstWeekContainsDate)??((f=(d=s==null?void 0:s.locale)==null?void 0:d.options)==null?void 0:f.firstWeekContainsDate)??n.firstWeekContainsDate??((y=(m=n.locale)==null?void 0:m.options)==null?void 0:y.firstWeekContainsDate)??1,i=(s==null?void 0:s.weekStartsOn)??((v=(N=s==null?void 0:s.locale)==null?void 0:N.options)==null?void 0:v.weekStartsOn)??n.weekStartsOn??((b=(C=n.locale)==null?void 0:C.options)==null?void 0:b.weekStartsOn)??0,c=B(t);if(!Ra(c))throw new RangeError("Invalid time value");let l=e.match(_o).map(x=>{const p=x[0];if(p==="p"||p==="P"){const S=jo[p];return S(x,a.formatLong)}return x}).join("").match(To).map(x=>{if(x==="''")return{isToken:!1,value:"'"};const p=x[0];if(p==="'")return{isToken:!1,value:Do(x)};if(rr[p])return{isToken:!0,value:x};if(p.match(Mo))throw new RangeError("Format string contains an unescaped latin alphabet character `"+p+"`");return{isToken:!1,value:x}});a.localize.preprocessor&&(l=a.localize.preprocessor(c,l));const h={firstWeekContainsDate:o,weekStartsOn:i,locale:a};return l.map(x=>{if(!x.isToken)return x.value;const p=x.value;(!(s!=null&&s.useAdditionalWeekYearTokens)&&Eo(p)||!(s!=null&&s.useAdditionalDayOfYearTokens)&&So(p))&&Ao(p,e,String(t));const S=rr[p[0]];return S(c,p,a.localize,h)}).join("")}function Do(t){const e=t.match(Oo);return e?e[1].replace(Lo,"'"):t}function Po(t,e,s){const n=gt(),a=(s==null?void 0:s.locale)??n.locale??qr,o=2520,i=Et(t,e);if(isNaN(i))throw new RangeError("Invalid time value");const c=Object.assign({},s,{addSuffix:s==null?void 0:s.addSuffix,comparison:i});let l,h;i>0?(l=B(e),h=B(t)):(l=B(t),h=B(e));const d=Ia(h,l),f=(Pt(h)-Pt(l))/1e3,m=Math.round((d-f)/60);let y;if(m<2)return s!=null&&s.includeSeconds?d<5?a.formatDistance("lessThanXSeconds",5,c):d<10?a.formatDistance("lessThanXSeconds",10,c):d<20?a.formatDistance("lessThanXSeconds",20,c):d<40?a.formatDistance("halfAMinute",0,c):d<60?a.formatDistance("lessThanXMinutes",1,c):a.formatDistance("xMinutes",1,c):m===0?a.formatDistance("lessThanXMinutes",1,c):a.formatDistance("xMinutes",m,c);if(m<45)return a.formatDistance("xMinutes",m,c);if(m<90)return a.formatDistance("aboutXHours",1,c);if(m<tr){const N=Math.round(m/60);return a.formatDistance("aboutXHours",N,c)}else{if(m<o)return a.formatDistance("xDays",1,c);if(m<kt){const N=Math.round(m/tr);return a.formatDistance("xDays",N,c)}else if(m<kt*2)return y=Math.round(m/kt),a.formatDistance("aboutXMonths",y,c)}if(y=Pa(h,l),y<12){const N=Math.round(m/kt);return a.formatDistance("xMonths",N,c)}else{const N=y%12,v=Math.trunc(y/12);return N<3?a.formatDistance("aboutXYears",v,c):N<9?a.formatDistance("overXYears",v,c):a.formatDistance("almostXYears",v+1,c)}}function Io(t,e){return Po(t,Ea(t),e)}const Bo={lessThanXSeconds:{one:"menos de um segundo",other:"menos de {{count}} segundos"},xSeconds:{one:"1 segundo",other:"{{count}} segundos"},halfAMinute:"meio minuto",lessThanXMinutes:{one:"menos de um minuto",other:"menos de {{count}} minutos"},xMinutes:{one:"1 minuto",other:"{{count}} minutos"},aboutXHours:{one:"cerca de 1 hora",other:"cerca de {{count}} horas"},xHours:{one:"1 hora",other:"{{count}} horas"},xDays:{one:"1 dia",other:"{{count}} dias"},aboutXWeeks:{one:"cerca de 1 semana",other:"cerca de {{count}} semanas"},xWeeks:{one:"1 semana",other:"{{count}} semanas"},aboutXMonths:{one:"cerca de 1 m√™s",other:"cerca de {{count}} meses"},xMonths:{one:"1 m√™s",other:"{{count}} meses"},aboutXYears:{one:"cerca de 1 ano",other:"cerca de {{count}} anos"},xYears:{one:"1 ano",other:"{{count}} anos"},overXYears:{one:"mais de 1 ano",other:"mais de {{count}} anos"},almostXYears:{one:"quase 1 ano",other:"quase {{count}} anos"}},Wo=(t,e,s)=>{let n;const a=Bo[t];return typeof a=="string"?n=a:e===1?n=a.one:n=a.other.replace("{{count}}",String(e)),s!=null&&s.addSuffix?s.comparison&&s.comparison>0?"em "+n:"h√° "+n:n},qo={full:"EEEE, d 'de' MMMM 'de' y",long:"d 'de' MMMM 'de' y",medium:"d MMM y",short:"dd/MM/yyyy"},Fo={full:"HH:mm:ss zzzz",long:"HH:mm:ss z",medium:"HH:mm:ss",short:"HH:mm"},$o={full:"{{date}} '√†s' {{time}}",long:"{{date}} '√†s' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},Vo={date:He({formats:qo,defaultWidth:"full"}),time:He({formats:Fo,defaultWidth:"full"}),dateTime:He({formats:$o,defaultWidth:"full"})},zo={lastWeek:t=>{const e=t.getDay();return"'"+(e===0||e===6?"√∫ltimo":"√∫ltima")+"' eeee '√†s' p"},yesterday:"'ontem √†s' p",today:"'hoje √†s' p",tomorrow:"'amanh√£ √†s' p",nextWeek:"eeee '√†s' p",other:"P"},Yo=(t,e,s,n)=>{const a=zo[t];return typeof a=="function"?a(e):a},Uo={narrow:["AC","DC"],abbreviated:["AC","DC"],wide:["antes de cristo","depois de cristo"]},Ho={narrow:["1","2","3","4"],abbreviated:["T1","T2","T3","T4"],wide:["1¬∫ trimestre","2¬∫ trimestre","3¬∫ trimestre","4¬∫ trimestre"]},Xo={narrow:["j","f","m","a","m","j","j","a","s","o","n","d"],abbreviated:["jan","fev","mar","abr","mai","jun","jul","ago","set","out","nov","dez"],wide:["janeiro","fevereiro","mar√ßo","abril","maio","junho","julho","agosto","setembro","outubro","novembro","dezembro"]},Qo={narrow:["D","S","T","Q","Q","S","S"],short:["dom","seg","ter","qua","qui","sex","sab"],abbreviated:["domingo","segunda","ter√ßa","quarta","quinta","sexta","s√°bado"],wide:["domingo","segunda-feira","ter√ßa-feira","quarta-feira","quinta-feira","sexta-feira","s√°bado"]},Ko={narrow:{am:"a",pm:"p",midnight:"mn",noon:"md",morning:"manh√£",afternoon:"tarde",evening:"tarde",night:"noite"},abbreviated:{am:"AM",pm:"PM",midnight:"meia-noite",noon:"meio-dia",morning:"manh√£",afternoon:"tarde",evening:"tarde",night:"noite"},wide:{am:"a.m.",pm:"p.m.",midnight:"meia-noite",noon:"meio-dia",morning:"manh√£",afternoon:"tarde",evening:"tarde",night:"noite"}},Go={narrow:{am:"a",pm:"p",midnight:"mn",noon:"md",morning:"da manh√£",afternoon:"da tarde",evening:"da tarde",night:"da noite"},abbreviated:{am:"AM",pm:"PM",midnight:"meia-noite",noon:"meio-dia",morning:"da manh√£",afternoon:"da tarde",evening:"da tarde",night:"da noite"},wide:{am:"a.m.",pm:"p.m.",midnight:"meia-noite",noon:"meio-dia",morning:"da manh√£",afternoon:"da tarde",evening:"da tarde",night:"da noite"}},Jo=(t,e)=>{const s=Number(t);return(e==null?void 0:e.unit)==="week"?s+"¬™":s+"¬∫"},Zo={ordinalNumber:Jo,era:be({values:Uo,defaultWidth:"wide"}),quarter:be({values:Ho,defaultWidth:"wide",argumentCallback:t=>t-1}),month:be({values:Xo,defaultWidth:"wide"}),day:be({values:Qo,defaultWidth:"wide"}),dayPeriod:be({values:Ko,defaultWidth:"wide",formattingValues:Go,defaultFormattingWidth:"wide"})},ei=/^(\d+)[¬∫¬™o]?/i,ti=/\d+/i,si={narrow:/^(ac|dc|a|d)/i,abbreviated:/^(a\.?\s?c\.?|d\.?\s?c\.?)/i,wide:/^(antes de cristo|depois de cristo)/i},ri={any:[/^ac/i,/^dc/i],wide:[/^antes de cristo/i,/^depois de cristo/i]},ni={narrow:/^[1234]/i,abbreviated:/^T[1234]/i,wide:/^[1234](¬∫)? trimestre/i},ai={any:[/1/i,/2/i,/3/i,/4/i]},oi={narrow:/^[jfmajsond]/i,abbreviated:/^(jan|fev|mar|abr|mai|jun|jul|ago|set|out|nov|dez)/i,wide:/^(janeiro|fevereiro|mar√ßo|abril|maio|junho|julho|agosto|setembro|outubro|novembro|dezembro)/i},ii={narrow:[/^j/i,/^f/i,/^m/i,/^a/i,/^m/i,/^j/i,/^j/i,/^a/i,/^s/i,/^o/i,/^n/i,/^d/i],any:[/^ja/i,/^fev/i,/^mar/i,/^abr/i,/^mai/i,/^jun/i,/^jul/i,/^ago/i,/^set/i,/^out/i,/^nov/i,/^dez/i]},ci={narrow:/^(dom|[23456]¬™?|s[a√°]b)/i,short:/^(dom|[23456]¬™?|s[a√°]b)/i,abbreviated:/^(dom|seg|ter|qua|qui|sex|s[a√°]b)/i,wide:/^(domingo|(segunda|ter[c√ß]a|quarta|quinta|sexta)([- ]feira)?|s[a√°]bado)/i},li={short:[/^d/i,/^2/i,/^3/i,/^4/i,/^5/i,/^6/i,/^s[a√°]/i],narrow:[/^d/i,/^2/i,/^3/i,/^4/i,/^5/i,/^6/i,/^s[a√°]/i],any:[/^d/i,/^seg/i,/^t/i,/^qua/i,/^qui/i,/^sex/i,/^s[a√°]b/i]},di={narrow:/^(a|p|mn|md|(da) (manh√£|tarde|noite))/i,any:/^([ap]\.?\s?m\.?|meia[-\s]noite|meio[-\s]dia|(da) (manh√£|tarde|noite))/i},ui={any:{am:/^a/i,pm:/^p/i,midnight:/^mn|^meia[-\s]noite/i,noon:/^md|^meio[-\s]dia/i,morning:/manh√£/i,afternoon:/tarde/i,evening:/tarde/i,night:/noite/i}},hi={ordinalNumber:Wr({matchPattern:ei,parsePattern:ti,valueCallback:t=>parseInt(t,10)}),era:ve({matchPatterns:si,defaultMatchWidth:"wide",parsePatterns:ri,defaultParseWidth:"any"}),quarter:ve({matchPatterns:ni,defaultMatchWidth:"wide",parsePatterns:ai,defaultParseWidth:"any",valueCallback:t=>t+1}),month:ve({matchPatterns:oi,defaultMatchWidth:"wide",parsePatterns:ii,defaultParseWidth:"any"}),day:ve({matchPatterns:ci,defaultMatchWidth:"wide",parsePatterns:li,defaultParseWidth:"any"}),dayPeriod:ve({matchPatterns:di,defaultMatchWidth:"any",parsePatterns:ui,defaultParseWidth:"any"})},fs={code:"pt-BR",formatDistance:Wo,formatLong:Vo,formatRelative:Yo,localize:Zo,match:hi,options:{weekStartsOn:0,firstWeekContainsDate:1}},mi=t=>{const e="w-4 h-4";switch(t){case"call":return r.jsx(zt,{className:e});case"email":return r.jsx(Cs,{className:e});case"meeting":return r.jsx(ks,{className:e});case"task":return r.jsx(zn,{className:e});case"note":return r.jsx(Or,{className:e});case"whatsapp":return r.jsx(Mt,{className:e});case"lead_created":case"lead_assigned":case"stage_change":case"status_change":case"field_change":return r.jsx(Ue,{className:e});default:return r.jsx(Qe,{className:e})}},ir=t=>{switch(t){case"call":return"bg-blue-100 text-blue-600 border-blue-200";case"email":return"bg-purple-100 text-purple-600 border-purple-200";case"meeting":return"bg-green-100 text-green-600 border-green-200";case"task":return"bg-orange-100 text-orange-600 border-orange-200";case"note":return"bg-gray-100 text-gray-600 border-gray-200";case"whatsapp":return"bg-emerald-100 text-emerald-600 border-emerald-200";case"lead_created":case"lead_assigned":case"stage_change":case"status_change":case"field_change":return"bg-indigo-100 text-indigo-600 border-indigo-200";default:return"bg-gray-100 text-gray-600 border-gray-200"}},fi=t=>({call:"Liga√ß√£o",email:"E-mail",meeting:"Reuni√£o",task:"Tarefa",note:"Nota",whatsapp:"WhatsApp",sms:"SMS",stage_change:"Mudan√ßa de Est√°gio",status_change:"Mudan√ßa de Status",lead_created:"Lead Criado",lead_assigned:"Lead Atribu√≠do",field_change:"Altera√ß√£o",other:"Outro"})[t]||t;function cr({leadId:t,showOnlyHistory:e=!1}){const[s,n]=u.useState([]),[a,o]=u.useState(!0);u.useEffect(()=>{i()},[t]);const i=async()=>{try{o(!0);const m=await fe.getLeadActivities(t);n(m)}catch(m){console.error("Erro ao carregar atividades:",m),_.error("Erro ao carregar atividades")}finally{o(!1)}},c=async m=>{try{await fe.completeActivity(m),_.success("Atividade conclu√≠da!"),await i()}catch(y){console.error("Erro ao concluir atividade:",y),_.error("Erro ao concluir atividade")}},l=m=>{try{return Vr(new Date(m),"dd 'de' MMMM '√†s' HH:mm",{locale:fs})}catch{return m}},h=["stage_change","status_change","lead_created","lead_assigned","field_change"],d=["call","email","meeting","task","note","whatsapp","sms","other"],f=e?s.filter(m=>h.includes(m.type)):s.filter(m=>d.includes(m.type));return a?r.jsx("div",{className:"flex items-center justify-center py-8",children:r.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary-600"})}):r.jsxs("div",{className:"space-y-4",children:[r.jsx("div",{className:"flex items-center justify-between",children:r.jsxs("h3",{className:"text-lg font-semibold text-gray-900",children:[e?"Hist√≥rico":"Atividades"," (",f.length,")"]})}),f.length===0?r.jsxs("div",{className:"text-center py-8 bg-gray-50 rounded-lg",children:[r.jsx(Qe,{className:"w-12 h-12 text-gray-400 mx-auto mb-3"}),r.jsx("p",{className:"text-gray-600 text-sm",children:e?"Nenhuma altera√ß√£o registrada ainda":'Nenhuma atividade criada ainda. Use o bot√£o "Nova Atividade" para adicionar follow-ups, liga√ß√µes, reuni√µes e mais.'})]}):r.jsxs("div",{className:"relative",children:[r.jsx("div",{className:"absolute left-5 top-0 bottom-0 w-0.5 bg-gray-200"}),r.jsx("div",{className:"space-y-4",children:f.map((m,y)=>r.jsxs("div",{className:"relative flex gap-4",children:[r.jsx("div",{className:`flex-shrink-0 w-10 h-10 rounded-full border-2 flex items-center justify-center ${ir(m.type)} z-10`,children:mi(m.type)}),r.jsx("div",{className:"flex-1 pb-8",children:r.jsxs("div",{className:`bg-white rounded-lg border p-4 shadow-sm ${m.isCompleted?"opacity-70":""}`,children:[r.jsxs("div",{className:"flex items-start justify-between mb-2",children:[r.jsxs("div",{className:"flex-1",children:[r.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[r.jsx("h4",{className:"font-semibold text-gray-900 text-sm",children:m.title}),r.jsx("span",{className:`text-xs px-2 py-0.5 rounded-full ${ir(m.type)}`,children:fi(m.type)})]}),m.description&&r.jsx("p",{className:"text-sm text-gray-600 mt-1",children:m.description})]}),!m.isCompleted&&(m.type==="task"||m.type==="call"||m.type==="meeting")&&r.jsx("button",{onClick:()=>c(m.id),className:"flex-shrink-0 p-1.5 text-green-600 hover:bg-green-50 rounded-full transition-colors",title:"Marcar como conclu√≠da",children:r.jsx(us,{className:"w-4 h-4"})})]}),r.jsxs("div",{className:"flex items-center gap-4 text-xs text-gray-500 mt-2",children:[r.jsxs("span",{className:"flex items-center gap-1",children:[r.jsx(Qe,{className:"w-3 h-3"}),l(m.createdAt)]}),m.user&&r.jsxs("span",{className:"flex items-center gap-1",children:[r.jsx(Ue,{className:"w-3 h-3"}),m.user.name]}),m.scheduledAt&&r.jsxs("span",{className:"flex items-center gap-1 text-orange-600",children:[r.jsx(ks,{className:"w-3 h-3"}),"Agendado: ",l(m.scheduledAt)]}),m.isCompleted&&m.completedAt&&r.jsxs("span",{className:"flex items-center gap-1 text-green-600",children:[r.jsx(us,{className:"w-3 h-3"}),"Conclu√≠da: ",l(m.completedAt)]})]})]})})]},m.id))})]})]})}function gi({onSubmit:t,onCancel:e}){const[s,n]=u.useState(!1),[a,o]=u.useState({type:"note",title:"",description:"",scheduledAt:""}),i=async l=>{if(l.preventDefault(),!a.title.trim()){_.error("T√≠tulo √© obrigat√≥rio");return}n(!0);try{const h={type:a.type,title:a.title,description:a.description||void 0,scheduledAt:a.scheduledAt?new Date(a.scheduledAt):void 0};await t(h),_.success("Atividade criada com sucesso")}catch(h){_.error(h.message||"Erro ao criar atividade")}finally{n(!1)}},c=(l,h)=>{o(d=>({...d,[l]:h}))};return r.jsxs("form",{onSubmit:i,className:"space-y-4",children:[r.jsxs("div",{children:[r.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Tipo de Atividade ",r.jsx("span",{className:"text-red-500",children:"*"})]}),r.jsxs("select",{value:a.type,onChange:l=>c("type",l.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500",required:!0,children:[r.jsx("option",{value:"note",children:"üìù Nota"}),r.jsx("option",{value:"call",children:"üìû Liga√ß√£o"}),r.jsx("option",{value:"email",children:"üìß E-mail"}),r.jsx("option",{value:"meeting",children:"üìÖ Reuni√£o"}),r.jsx("option",{value:"task",children:"‚úÖ Tarefa"}),r.jsx("option",{value:"whatsapp",children:"üí¨ WhatsApp"}),r.jsx("option",{value:"sms",children:"üì± SMS"}),r.jsx("option",{value:"other",children:"üîπ Outro"})]})]}),r.jsxs("div",{children:[r.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["T√≠tulo ",r.jsx("span",{className:"text-red-500",children:"*"})]}),r.jsx("input",{type:"text",value:a.title,onChange:l=>c("title",l.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500",placeholder:"Ex: Ligar para agendar consulta",required:!0})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Descri√ß√£o"}),r.jsx("textarea",{value:a.description,onChange:l=>c("description",l.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500",placeholder:"Detalhes da atividade...",rows:3})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Agendar para"}),r.jsx("input",{type:"datetime-local",value:a.scheduledAt,onChange:l=>c("scheduledAt",l.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500"}),r.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Opcional: Defina uma data/hora para ser lembrado desta atividade"})]}),r.jsxs("div",{className:"flex items-center justify-end gap-3 pt-4 border-t",children:[r.jsx("button",{type:"button",onClick:e,className:"px-4 py-2 text-gray-700 bg-white border border-gray-300 rounded-lg hover:bg-gray-50",disabled:s,children:"Cancelar"}),r.jsx("button",{type:"submit",className:"px-4 py-2 text-white bg-primary-600 rounded-lg hover:bg-primary-700 disabled:opacity-50 disabled:cursor-not-allowed",disabled:s,children:s?"Criando...":"Criar Atividade"})]})]})}function pi({lead:t,stages:e,onSubmit:s,onClose:n}){const[a,o]=u.useState("details"),[i,c]=u.useState(!1),[l,h]=u.useState(0),d=async f=>{t&&(await fe.createActivity(t.id,f),c(!1),h(m=>m+1))};return r.jsxs("div",{children:[r.jsxs("div",{className:"flex items-center justify-between border-b border-gray-200 mb-6",children:[r.jsxs("div",{className:"flex gap-6",children:[r.jsxs("button",{onClick:()=>o("details"),className:`flex items-center gap-2 px-1 py-3 border-b-2 font-medium text-sm transition-colors ${a==="details"?"border-primary-600 text-primary-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:[r.jsx(Lr,{className:"w-4 h-4"}),"Detalhes"]}),t&&r.jsxs("button",{onClick:()=>o("activities"),className:`flex items-center gap-2 px-1 py-3 border-b-2 font-medium text-sm transition-colors ${a==="activities"?"border-primary-600 text-primary-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:[r.jsx(Qe,{className:"w-4 h-4"}),"Hist√≥rico"]})]}),a==="details"&&t&&r.jsxs("button",{onClick:()=>c(!0),className:"flex items-center gap-2 px-3 py-2 text-sm font-medium text-primary-600 bg-primary-50 rounded-lg hover:bg-primary-100 transition-colors",children:[r.jsx(Yn,{className:"w-4 h-4"}),"Nova Atividade"]})]}),r.jsxs("div",{children:[a==="details"&&r.jsxs("div",{className:"space-y-6",children:[r.jsx(ja,{onSubmit:s,onCancel:n,initialData:t,stages:e}),t&&r.jsxs("div",{className:"border-t pt-6",children:[r.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Atividades e Follow-ups"}),r.jsx(cr,{leadId:t.id,showOnlyHistory:!1},`activities-${l}`)]})]}),a==="activities"&&t&&r.jsxs("div",{children:[r.jsx("div",{className:"mb-4",children:r.jsx("p",{className:"text-sm text-gray-600",children:"Hist√≥rico de altera√ß√µes e atividades realizadas neste lead"})}),r.jsx(cr,{leadId:t.id,showOnlyHistory:!0},`history-${l}`)]})]}),i&&r.jsx(Dr,{isOpen:i,onClose:()=>c(!1),title:"Nova Atividade",size:"md",children:r.jsx(gi,{onSubmit:d,onCancel:()=>c(!1)})})]})}function xi({isOpen:t,onClose:e,stages:s,filters:n,onApplyFilters:a,onClearFilters:o}){const[i,c]=u.useState(n),[l,h]=u.useState([]),[d,f]=u.useState([]);u.useEffect(()=>{m()},[]),u.useEffect(()=>{c(n)},[n]);const m=async()=>{try{const[b,x]=await Promise.all([fe.getProcedures(),Pr.getUsers()]);h(b),f(x)}catch(b){console.error("Erro ao carregar dados:",b)}},y=(b,x)=>{c(p=>({...p,[b]:x||void 0}))},N=()=>{a(i),e()},v=()=>{c({}),o()},C=Object.keys(n).filter(b=>n[b]!==void 0&&n[b]!=="").length;return t?r.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-50 flex items-start justify-end",children:r.jsxs("div",{className:"bg-white h-full w-full max-w-md shadow-xl flex flex-col",children:[r.jsxs("div",{className:"flex items-center justify-between p-4 border-b",children:[r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx(Un,{className:"w-5 h-5 text-gray-600"}),r.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Filtros"}),C>0&&r.jsx("span",{className:"px-2 py-0.5 bg-primary-100 text-primary-600 text-xs font-medium rounded-full",children:C})]}),r.jsx("button",{onClick:e,className:"p-1 hover:bg-gray-100 rounded-lg transition-colors",children:r.jsx(dt,{className:"w-5 h-5 text-gray-500"})})]}),r.jsxs("div",{className:"flex-1 overflow-y-auto p-4 space-y-4",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Buscar por nome"}),r.jsxs("div",{className:"relative",children:[r.jsx(Mr,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-4 h-4 text-gray-400"}),r.jsx("input",{type:"text",value:i.search||"",onChange:b=>y("search",b.target.value),placeholder:"Digite o nome do lead...",className:"w-full pl-10 pr-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500"})]})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Est√°gio"}),r.jsxs("select",{value:i.stageId||"",onChange:b=>y("stageId",b.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500",children:[r.jsx("option",{value:"",children:"Todos os est√°gios"}),s.map(b=>r.jsx("option",{value:b.id,children:b.name},b.id))]})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Procedimento"}),r.jsxs("select",{value:i.procedureId||"",onChange:b=>y("procedureId",b.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500",children:[r.jsx("option",{value:"",children:"Todos os procedimentos"}),l.map(b=>r.jsx("option",{value:b.id,children:b.name},b.id))]})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Respons√°vel"}),r.jsxs("select",{value:i.assignedToId||"",onChange:b=>y("assignedToId",b.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500",children:[r.jsx("option",{value:"",children:"Todos os respons√°veis"}),d.map(b=>r.jsx("option",{value:b.id,children:b.name},b.id))]})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Status do Cliente"}),r.jsxs("select",{value:i.clientStatus||"",onChange:b=>y("clientStatus",b.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500",children:[r.jsx("option",{value:"",children:"Todos os status"}),r.jsx("option",{value:"novo",children:"Novo"}),r.jsx("option",{value:"recorrente",children:"Recorrente"}),r.jsx("option",{value:"vip",children:"VIP"}),r.jsx("option",{value:"retorno",children:"Retorno"})]})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Canal de Comunica√ß√£o"}),r.jsxs("select",{value:i.channel||"",onChange:b=>y("channel",b.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500",children:[r.jsx("option",{value:"",children:"Todos os canais"}),r.jsx("option",{value:"whatsapp",children:"WhatsApp"}),r.jsx("option",{value:"phone",children:"Telefone"}),r.jsx("option",{value:"email",children:"E-mail"}),r.jsx("option",{value:"instagram",children:"Instagram"}),r.jsx("option",{value:"facebook",children:"Facebook"}),r.jsx("option",{value:"website",children:"Site"}),r.jsx("option",{value:"indication",children:"Indica√ß√£o"}),r.jsx("option",{value:"other",children:"Outro"})]})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Local de Atendimento"}),r.jsxs("select",{value:i.attendanceLocation||"",onChange:b=>y("attendanceLocation",b.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500",children:[r.jsx("option",{value:"",children:"Todos os locais"}),r.jsx("option",{value:"clinic",children:"Cl√≠nica"}),r.jsx("option",{value:"home",children:"Domic√≠lio"}),r.jsx("option",{value:"online",children:"Online"}),r.jsx("option",{value:"hospital",children:"Hospital"})]})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Valor Estimado"}),r.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-xs text-gray-500 mb-1",children:"M√≠nimo"}),r.jsx("input",{type:"number",value:i.minValue||"",onChange:b=>y("minValue",b.target.value?parseFloat(b.target.value):void 0),placeholder:"R$ 0",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500"})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-xs text-gray-500 mb-1",children:"M√°ximo"}),r.jsx("input",{type:"number",value:i.maxValue||"",onChange:b=>y("maxValue",b.target.value?parseFloat(b.target.value):void 0),placeholder:"R$ 10.000",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500"})]})]})]})]}),r.jsxs("div",{className:"p-4 border-t bg-gray-50 flex gap-3",children:[r.jsx("button",{onClick:v,className:"flex-1 px-4 py-2 text-gray-700 bg-white border border-gray-300 rounded-lg hover:bg-gray-50 font-medium",children:"Limpar Filtros"}),r.jsx("button",{onClick:N,className:"flex-1 px-4 py-2 text-white bg-primary-600 rounded-lg hover:bg-primary-700 font-medium",children:"Aplicar Filtros"})]})]})}):null}class yi extends u.Component{constructor(){super(...arguments);Qs(this,"state",{hasError:!1,error:null})}static getDerivedStateFromError(s){return{hasError:!0,error:s}}componentDidCatch(s,n){console.error("ErrorBoundary caught an error:",s,n)}render(){var s;return this.state.hasError?this.props.fallback?this.props.fallback:r.jsxs("div",{className:"p-6 bg-red-50 border border-red-200 rounded-lg",children:[r.jsx("h3",{className:"text-lg font-semibold text-red-900 mb-2",children:"Algo deu errado"}),r.jsx("p",{className:"text-sm text-red-700 mb-4",children:((s=this.state.error)==null?void 0:s.message)||"Ocorreu um erro inesperado"}),r.jsx("button",{onClick:()=>this.setState({hasError:!1,error:null}),className:"px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700",children:"Tentar novamente"})]}):this.props.children}}const Yt=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";function Ge(t){const e=Object.prototype.toString.call(t);return e==="[object Window]"||e==="[object global]"}function Es(t){return"nodeType"in t}function Z(t){var e,s;return t?Ge(t)?t:Es(t)&&(e=(s=t.ownerDocument)==null?void 0:s.defaultView)!=null?e:window:window}function As(t){const{Document:e}=Z(t);return t instanceof e}function pt(t){return Ge(t)?!1:t instanceof Z(t).HTMLElement}function zr(t){return t instanceof Z(t).SVGElement}function Je(t){return t?Ge(t)?t.document:Es(t)?As(t)?t:pt(t)||zr(t)?t.ownerDocument:document:document:document}const Ce=Yt?u.useLayoutEffect:u.useEffect;function Ut(t){const e=u.useRef(t);return Ce(()=>{e.current=t}),u.useCallback(function(){for(var s=arguments.length,n=new Array(s),a=0;a<s;a++)n[a]=arguments[a];return e.current==null?void 0:e.current(...n)},[])}function bi(){const t=u.useRef(null),e=u.useCallback((n,a)=>{t.current=setInterval(n,a)},[]),s=u.useCallback(()=>{t.current!==null&&(clearInterval(t.current),t.current=null)},[]);return[e,s]}function ht(t,e){e===void 0&&(e=[t]);const s=u.useRef(t);return Ce(()=>{s.current!==t&&(s.current=t)},e),s}function xt(t,e){const s=u.useRef();return u.useMemo(()=>{const n=t(s.current);return s.current=n,n},[...e])}function It(t){const e=Ut(t),s=u.useRef(null),n=u.useCallback(a=>{a!==s.current&&(e==null||e(a,s.current)),s.current=a},[]);return[s,n]}function Bt(t){const e=u.useRef();return u.useEffect(()=>{e.current=t},[t]),e.current}let ss={};function Ht(t,e){return u.useMemo(()=>{if(e)return e;const s=ss[t]==null?0:ss[t]+1;return ss[t]=s,t+"-"+s},[t,e])}function Yr(t){return function(e){for(var s=arguments.length,n=new Array(s>1?s-1:0),a=1;a<s;a++)n[a-1]=arguments[a];return n.reduce((o,i)=>{const c=Object.entries(i);for(const[l,h]of c){const d=o[l];d!=null&&(o[l]=d+t*h)}return o},{...e})}}const Xe=Yr(1),Wt=Yr(-1);function vi(t){return"clientX"in t&&"clientY"in t}function Rs(t){if(!t)return!1;const{KeyboardEvent:e}=Z(t.target);return e&&t instanceof e}function wi(t){if(!t)return!1;const{TouchEvent:e}=Z(t.target);return e&&t instanceof e}function qt(t){if(wi(t)){if(t.touches&&t.touches.length){const{clientX:e,clientY:s}=t.touches[0];return{x:e,y:s}}else if(t.changedTouches&&t.changedTouches.length){const{clientX:e,clientY:s}=t.changedTouches[0];return{x:e,y:s}}}return vi(t)?{x:t.clientX,y:t.clientY}:null}const Ke=Object.freeze({Translate:{toString(t){if(!t)return;const{x:e,y:s}=t;return"translate3d("+(e?Math.round(e):0)+"px, "+(s?Math.round(s):0)+"px, 0)"}},Scale:{toString(t){if(!t)return;const{scaleX:e,scaleY:s}=t;return"scaleX("+e+") scaleY("+s+")"}},Transform:{toString(t){if(t)return[Ke.Translate.toString(t),Ke.Scale.toString(t)].join(" ")}},Transition:{toString(t){let{property:e,duration:s,easing:n}=t;return e+" "+s+"ms "+n}}}),lr="a,frame,iframe,input:not([type=hidden]):not(:disabled),select:not(:disabled),textarea:not(:disabled),button:not(:disabled),*[tabindex]";function ji(t){return t.matches(lr)?t:t.querySelector(lr)}const Ni={display:"none"};function ki(t){let{id:e,value:s}=t;return z.createElement("div",{id:e,style:Ni},s)}function Ci(t){let{id:e,announcement:s,ariaLiveType:n="assertive"}=t;const a={position:"fixed",top:0,left:0,width:1,height:1,margin:-1,border:0,padding:0,overflow:"hidden",clip:"rect(0 0 0 0)",clipPath:"inset(100%)",whiteSpace:"nowrap"};return z.createElement("div",{id:e,style:a,role:"status","aria-live":n,"aria-atomic":!0},s)}function Si(){const[t,e]=u.useState("");return{announce:u.useCallback(n=>{n!=null&&e(n)},[]),announcement:t}}const Ur=u.createContext(null);function Ei(t){const e=u.useContext(Ur);u.useEffect(()=>{if(!e)throw new Error("useDndMonitor must be used within a children of <DndContext>");return e(t)},[t,e])}function Ai(){const[t]=u.useState(()=>new Set),e=u.useCallback(n=>(t.add(n),()=>t.delete(n)),[t]);return[u.useCallback(n=>{let{type:a,event:o}=n;t.forEach(i=>{var c;return(c=i[a])==null?void 0:c.call(i,o)})},[t]),e]}const Ri={draggable:`
    To pick up a draggable item, press the space bar.
    While dragging, use the arrow keys to move the item.
    Press space again to drop the item in its new position, or press escape to cancel.
  `},Ti={onDragStart(t){let{active:e}=t;return"Picked up draggable item "+e.id+"."},onDragOver(t){let{active:e,over:s}=t;return s?"Draggable item "+e.id+" was moved over droppable area "+s.id+".":"Draggable item "+e.id+" is no longer over a droppable area."},onDragEnd(t){let{active:e,over:s}=t;return s?"Draggable item "+e.id+" was dropped over droppable area "+s.id:"Draggable item "+e.id+" was dropped."},onDragCancel(t){let{active:e}=t;return"Dragging was cancelled. Draggable item "+e.id+" was dropped."}};function _i(t){let{announcements:e=Ti,container:s,hiddenTextDescribedById:n,screenReaderInstructions:a=Ri}=t;const{announce:o,announcement:i}=Si(),c=Ht("DndLiveRegion"),[l,h]=u.useState(!1);if(u.useEffect(()=>{h(!0)},[]),Ei(u.useMemo(()=>({onDragStart(f){let{active:m}=f;o(e.onDragStart({active:m}))},onDragMove(f){let{active:m,over:y}=f;e.onDragMove&&o(e.onDragMove({active:m,over:y}))},onDragOver(f){let{active:m,over:y}=f;o(e.onDragOver({active:m,over:y}))},onDragEnd(f){let{active:m,over:y}=f;o(e.onDragEnd({active:m,over:y}))},onDragCancel(f){let{active:m,over:y}=f;o(e.onDragCancel({active:m,over:y}))}}),[o,e])),!l)return null;const d=z.createElement(z.Fragment,null,z.createElement(ki,{id:n,value:a.draggable}),z.createElement(Ci,{id:c,announcement:i}));return s?Be.createPortal(d,s):d}var U;(function(t){t.DragStart="dragStart",t.DragMove="dragMove",t.DragEnd="dragEnd",t.DragCancel="dragCancel",t.DragOver="dragOver",t.RegisterDroppable="registerDroppable",t.SetDroppableDisabled="setDroppableDisabled",t.UnregisterDroppable="unregisterDroppable"})(U||(U={}));function Ft(){}function Oi(t,e){return u.useMemo(()=>({sensor:t,options:e??{}}),[t,e])}function Li(){for(var t=arguments.length,e=new Array(t),s=0;s<t;s++)e[s]=arguments[s];return u.useMemo(()=>[...e].filter(n=>n!=null),[...e])}const ge=Object.freeze({x:0,y:0});function Mi(t,e){return Math.sqrt(Math.pow(t.x-e.x,2)+Math.pow(t.y-e.y,2))}function Di(t,e){const s=qt(t);if(!s)return"0 0";const n={x:(s.x-e.left)/e.width*100,y:(s.y-e.top)/e.height*100};return n.x+"% "+n.y+"%"}function Pi(t,e){let{data:{value:s}}=t,{data:{value:n}}=e;return s-n}function Ii(t,e){let{data:{value:s}}=t,{data:{value:n}}=e;return n-s}function dr(t){let{left:e,top:s,height:n,width:a}=t;return[{x:e,y:s},{x:e+a,y:s},{x:e,y:s+n},{x:e+a,y:s+n}]}function Bi(t,e){if(!t||t.length===0)return null;const[s]=t;return s[e]}const Wi=t=>{let{collisionRect:e,droppableRects:s,droppableContainers:n}=t;const a=dr(e),o=[];for(const i of n){const{id:c}=i,l=s.get(c);if(l){const h=dr(l),d=a.reduce((m,y,N)=>m+Mi(h[N],y),0),f=Number((d/4).toFixed(4));o.push({id:c,data:{droppableContainer:i,value:f}})}}return o.sort(Pi)};function qi(t,e){const s=Math.max(e.top,t.top),n=Math.max(e.left,t.left),a=Math.min(e.left+e.width,t.left+t.width),o=Math.min(e.top+e.height,t.top+t.height),i=a-n,c=o-s;if(n<a&&s<o){const l=e.width*e.height,h=t.width*t.height,d=i*c,f=d/(l+h-d);return Number(f.toFixed(4))}return 0}const Fi=t=>{let{collisionRect:e,droppableRects:s,droppableContainers:n}=t;const a=[];for(const o of n){const{id:i}=o,c=s.get(i);if(c){const l=qi(c,e);l>0&&a.push({id:i,data:{droppableContainer:o,value:l}})}}return a.sort(Ii)};function $i(t,e,s){return{...t,scaleX:e&&s?e.width/s.width:1,scaleY:e&&s?e.height/s.height:1}}function Hr(t,e){return t&&e?{x:t.left-e.left,y:t.top-e.top}:ge}function Vi(t){return function(s){for(var n=arguments.length,a=new Array(n>1?n-1:0),o=1;o<n;o++)a[o-1]=arguments[o];return a.reduce((i,c)=>({...i,top:i.top+t*c.y,bottom:i.bottom+t*c.y,left:i.left+t*c.x,right:i.right+t*c.x}),{...s})}}const zi=Vi(1);function Xr(t){if(t.startsWith("matrix3d(")){const e=t.slice(9,-1).split(/, /);return{x:+e[12],y:+e[13],scaleX:+e[0],scaleY:+e[5]}}else if(t.startsWith("matrix(")){const e=t.slice(7,-1).split(/, /);return{x:+e[4],y:+e[5],scaleX:+e[0],scaleY:+e[3]}}return null}function Yi(t,e,s){const n=Xr(e);if(!n)return t;const{scaleX:a,scaleY:o,x:i,y:c}=n,l=t.left-i-(1-a)*parseFloat(s),h=t.top-c-(1-o)*parseFloat(s.slice(s.indexOf(" ")+1)),d=a?t.width/a:t.width,f=o?t.height/o:t.height;return{width:d,height:f,top:h,right:l+d,bottom:h+f,left:l}}const Ui={ignoreTransform:!1};function yt(t,e){e===void 0&&(e=Ui);let s=t.getBoundingClientRect();if(e.ignoreTransform){const{transform:h,transformOrigin:d}=Z(t).getComputedStyle(t);h&&(s=Yi(s,h,d))}const{top:n,left:a,width:o,height:i,bottom:c,right:l}=s;return{top:n,left:a,width:o,height:i,bottom:c,right:l}}function ur(t){return yt(t,{ignoreTransform:!0})}function Hi(t){const e=t.innerWidth,s=t.innerHeight;return{top:0,left:0,right:e,bottom:s,width:e,height:s}}function Xi(t,e){return e===void 0&&(e=Z(t).getComputedStyle(t)),e.position==="fixed"}function Qi(t,e){e===void 0&&(e=Z(t).getComputedStyle(t));const s=/(auto|scroll|overlay)/;return["overflow","overflowX","overflowY"].some(a=>{const o=e[a];return typeof o=="string"?s.test(o):!1})}function Ts(t,e){const s=[];function n(a){if(e!=null&&s.length>=e||!a)return s;if(As(a)&&a.scrollingElement!=null&&!s.includes(a.scrollingElement))return s.push(a.scrollingElement),s;if(!pt(a)||zr(a)||s.includes(a))return s;const o=Z(t).getComputedStyle(a);return a!==t&&Qi(a,o)&&s.push(a),Xi(a,o)?s:n(a.parentNode)}return t?n(t):s}function Qr(t){const[e]=Ts(t,1);return e??null}function rs(t){return!Yt||!t?null:Ge(t)?t:Es(t)?As(t)||t===Je(t).scrollingElement?window:pt(t)?t:null:null}function Kr(t){return Ge(t)?t.scrollX:t.scrollLeft}function Gr(t){return Ge(t)?t.scrollY:t.scrollTop}function gs(t){return{x:Kr(t),y:Gr(t)}}var H;(function(t){t[t.Forward=1]="Forward",t[t.Backward=-1]="Backward"})(H||(H={}));function Jr(t){return!Yt||!t?!1:t===document.scrollingElement}function Zr(t){const e={x:0,y:0},s=Jr(t)?{height:window.innerHeight,width:window.innerWidth}:{height:t.clientHeight,width:t.clientWidth},n={x:t.scrollWidth-s.width,y:t.scrollHeight-s.height},a=t.scrollTop<=e.y,o=t.scrollLeft<=e.x,i=t.scrollTop>=n.y,c=t.scrollLeft>=n.x;return{isTop:a,isLeft:o,isBottom:i,isRight:c,maxScroll:n,minScroll:e}}const Ki={x:.2,y:.2};function Gi(t,e,s,n,a){let{top:o,left:i,right:c,bottom:l}=s;n===void 0&&(n=10),a===void 0&&(a=Ki);const{isTop:h,isBottom:d,isLeft:f,isRight:m}=Zr(t),y={x:0,y:0},N={x:0,y:0},v={height:e.height*a.y,width:e.width*a.x};return!h&&o<=e.top+v.height?(y.y=H.Backward,N.y=n*Math.abs((e.top+v.height-o)/v.height)):!d&&l>=e.bottom-v.height&&(y.y=H.Forward,N.y=n*Math.abs((e.bottom-v.height-l)/v.height)),!m&&c>=e.right-v.width?(y.x=H.Forward,N.x=n*Math.abs((e.right-v.width-c)/v.width)):!f&&i<=e.left+v.width&&(y.x=H.Backward,N.x=n*Math.abs((e.left+v.width-i)/v.width)),{direction:y,speed:N}}function Ji(t){if(t===document.scrollingElement){const{innerWidth:o,innerHeight:i}=window;return{top:0,left:0,right:o,bottom:i,width:o,height:i}}const{top:e,left:s,right:n,bottom:a}=t.getBoundingClientRect();return{top:e,left:s,right:n,bottom:a,width:t.clientWidth,height:t.clientHeight}}function en(t){return t.reduce((e,s)=>Xe(e,gs(s)),ge)}function Zi(t){return t.reduce((e,s)=>e+Kr(s),0)}function ec(t){return t.reduce((e,s)=>e+Gr(s),0)}function tn(t,e){if(e===void 0&&(e=yt),!t)return;const{top:s,left:n,bottom:a,right:o}=e(t);Qr(t)&&(a<=0||o<=0||s>=window.innerHeight||n>=window.innerWidth)&&t.scrollIntoView({block:"center",inline:"center"})}const tc=[["x",["left","right"],Zi],["y",["top","bottom"],ec]];class _s{constructor(e,s){this.rect=void 0,this.width=void 0,this.height=void 0,this.top=void 0,this.bottom=void 0,this.right=void 0,this.left=void 0;const n=Ts(s),a=en(n);this.rect={...e},this.width=e.width,this.height=e.height;for(const[o,i,c]of tc)for(const l of i)Object.defineProperty(this,l,{get:()=>{const h=c(n),d=a[o]-h;return this.rect[l]+d},enumerable:!0});Object.defineProperty(this,"rect",{enumerable:!1})}}class it{constructor(e){this.target=void 0,this.listeners=[],this.removeAll=()=>{this.listeners.forEach(s=>{var n;return(n=this.target)==null?void 0:n.removeEventListener(...s)})},this.target=e}add(e,s,n){var a;(a=this.target)==null||a.addEventListener(e,s,n),this.listeners.push([e,s,n])}}function sc(t){const{EventTarget:e}=Z(t);return t instanceof e?t:Je(t)}function ns(t,e){const s=Math.abs(t.x),n=Math.abs(t.y);return typeof e=="number"?Math.sqrt(s**2+n**2)>e:"x"in e&&"y"in e?s>e.x&&n>e.y:"x"in e?s>e.x:"y"in e?n>e.y:!1}var ue;(function(t){t.Click="click",t.DragStart="dragstart",t.Keydown="keydown",t.ContextMenu="contextmenu",t.Resize="resize",t.SelectionChange="selectionchange",t.VisibilityChange="visibilitychange"})(ue||(ue={}));function hr(t){t.preventDefault()}function rc(t){t.stopPropagation()}var I;(function(t){t.Space="Space",t.Down="ArrowDown",t.Right="ArrowRight",t.Left="ArrowLeft",t.Up="ArrowUp",t.Esc="Escape",t.Enter="Enter",t.Tab="Tab"})(I||(I={}));const sn={start:[I.Space,I.Enter],cancel:[I.Esc],end:[I.Space,I.Enter,I.Tab]},nc=(t,e)=>{let{currentCoordinates:s}=e;switch(t.code){case I.Right:return{...s,x:s.x+25};case I.Left:return{...s,x:s.x-25};case I.Down:return{...s,y:s.y+25};case I.Up:return{...s,y:s.y-25}}};class rn{constructor(e){this.props=void 0,this.autoScrollEnabled=!1,this.referenceCoordinates=void 0,this.listeners=void 0,this.windowListeners=void 0,this.props=e;const{event:{target:s}}=e;this.props=e,this.listeners=new it(Je(s)),this.windowListeners=new it(Z(s)),this.handleKeyDown=this.handleKeyDown.bind(this),this.handleCancel=this.handleCancel.bind(this),this.attach()}attach(){this.handleStart(),this.windowListeners.add(ue.Resize,this.handleCancel),this.windowListeners.add(ue.VisibilityChange,this.handleCancel),setTimeout(()=>this.listeners.add(ue.Keydown,this.handleKeyDown))}handleStart(){const{activeNode:e,onStart:s}=this.props,n=e.node.current;n&&tn(n),s(ge)}handleKeyDown(e){if(Rs(e)){const{active:s,context:n,options:a}=this.props,{keyboardCodes:o=sn,coordinateGetter:i=nc,scrollBehavior:c="smooth"}=a,{code:l}=e;if(o.end.includes(l)){this.handleEnd(e);return}if(o.cancel.includes(l)){this.handleCancel(e);return}const{collisionRect:h}=n.current,d=h?{x:h.left,y:h.top}:ge;this.referenceCoordinates||(this.referenceCoordinates=d);const f=i(e,{active:s,context:n.current,currentCoordinates:d});if(f){const m=Wt(f,d),y={x:0,y:0},{scrollableAncestors:N}=n.current;for(const v of N){const C=e.code,{isTop:b,isRight:x,isLeft:p,isBottom:S,maxScroll:g,minScroll:T}=Zr(v),A=Ji(v),E={x:Math.min(C===I.Right?A.right-A.width/2:A.right,Math.max(C===I.Right?A.left:A.left+A.width/2,f.x)),y:Math.min(C===I.Down?A.bottom-A.height/2:A.bottom,Math.max(C===I.Down?A.top:A.top+A.height/2,f.y))},D=C===I.Right&&!x||C===I.Left&&!p,q=C===I.Down&&!S||C===I.Up&&!b;if(D&&E.x!==f.x){const W=v.scrollLeft+m.x,Q=C===I.Right&&W<=g.x||C===I.Left&&W>=T.x;if(Q&&!m.y){v.scrollTo({left:W,behavior:c});return}Q?y.x=v.scrollLeft-W:y.x=C===I.Right?v.scrollLeft-g.x:v.scrollLeft-T.x,y.x&&v.scrollBy({left:-y.x,behavior:c});break}else if(q&&E.y!==f.y){const W=v.scrollTop+m.y,Q=C===I.Down&&W<=g.y||C===I.Up&&W>=T.y;if(Q&&!m.x){v.scrollTo({top:W,behavior:c});return}Q?y.y=v.scrollTop-W:y.y=C===I.Down?v.scrollTop-g.y:v.scrollTop-T.y,y.y&&v.scrollBy({top:-y.y,behavior:c});break}}this.handleMove(e,Xe(Wt(f,this.referenceCoordinates),y))}}}handleMove(e,s){const{onMove:n}=this.props;e.preventDefault(),n(s)}handleEnd(e){const{onEnd:s}=this.props;e.preventDefault(),this.detach(),s()}handleCancel(e){const{onCancel:s}=this.props;e.preventDefault(),this.detach(),s()}detach(){this.listeners.removeAll(),this.windowListeners.removeAll()}}rn.activators=[{eventName:"onKeyDown",handler:(t,e,s)=>{let{keyboardCodes:n=sn,onActivation:a}=e,{active:o}=s;const{code:i}=t.nativeEvent;if(n.start.includes(i)){const c=o.activatorNode.current;return c&&t.target!==c?!1:(t.preventDefault(),a==null||a({event:t.nativeEvent}),!0)}return!1}}];function mr(t){return!!(t&&"distance"in t)}function fr(t){return!!(t&&"delay"in t)}class Os{constructor(e,s,n){var a;n===void 0&&(n=sc(e.event.target)),this.props=void 0,this.events=void 0,this.autoScrollEnabled=!0,this.document=void 0,this.activated=!1,this.initialCoordinates=void 0,this.timeoutId=null,this.listeners=void 0,this.documentListeners=void 0,this.windowListeners=void 0,this.props=e,this.events=s;const{event:o}=e,{target:i}=o;this.props=e,this.events=s,this.document=Je(i),this.documentListeners=new it(this.document),this.listeners=new it(n),this.windowListeners=new it(Z(i)),this.initialCoordinates=(a=qt(o))!=null?a:ge,this.handleStart=this.handleStart.bind(this),this.handleMove=this.handleMove.bind(this),this.handleEnd=this.handleEnd.bind(this),this.handleCancel=this.handleCancel.bind(this),this.handleKeydown=this.handleKeydown.bind(this),this.removeTextSelection=this.removeTextSelection.bind(this),this.attach()}attach(){const{events:e,props:{options:{activationConstraint:s,bypassActivationConstraint:n}}}=this;if(this.listeners.add(e.move.name,this.handleMove,{passive:!1}),this.listeners.add(e.end.name,this.handleEnd),e.cancel&&this.listeners.add(e.cancel.name,this.handleCancel),this.windowListeners.add(ue.Resize,this.handleCancel),this.windowListeners.add(ue.DragStart,hr),this.windowListeners.add(ue.VisibilityChange,this.handleCancel),this.windowListeners.add(ue.ContextMenu,hr),this.documentListeners.add(ue.Keydown,this.handleKeydown),s){if(n!=null&&n({event:this.props.event,activeNode:this.props.activeNode,options:this.props.options}))return this.handleStart();if(fr(s)){this.timeoutId=setTimeout(this.handleStart,s.delay),this.handlePending(s);return}if(mr(s)){this.handlePending(s);return}}this.handleStart()}detach(){this.listeners.removeAll(),this.windowListeners.removeAll(),setTimeout(this.documentListeners.removeAll,50),this.timeoutId!==null&&(clearTimeout(this.timeoutId),this.timeoutId=null)}handlePending(e,s){const{active:n,onPending:a}=this.props;a(n,e,this.initialCoordinates,s)}handleStart(){const{initialCoordinates:e}=this,{onStart:s}=this.props;e&&(this.activated=!0,this.documentListeners.add(ue.Click,rc,{capture:!0}),this.removeTextSelection(),this.documentListeners.add(ue.SelectionChange,this.removeTextSelection),s(e))}handleMove(e){var s;const{activated:n,initialCoordinates:a,props:o}=this,{onMove:i,options:{activationConstraint:c}}=o;if(!a)return;const l=(s=qt(e))!=null?s:ge,h=Wt(a,l);if(!n&&c){if(mr(c)){if(c.tolerance!=null&&ns(h,c.tolerance))return this.handleCancel();if(ns(h,c.distance))return this.handleStart()}if(fr(c)&&ns(h,c.tolerance))return this.handleCancel();this.handlePending(c,h);return}e.cancelable&&e.preventDefault(),i(l)}handleEnd(){const{onAbort:e,onEnd:s}=this.props;this.detach(),this.activated||e(this.props.active),s()}handleCancel(){const{onAbort:e,onCancel:s}=this.props;this.detach(),this.activated||e(this.props.active),s()}handleKeydown(e){e.code===I.Esc&&this.handleCancel()}removeTextSelection(){var e;(e=this.document.getSelection())==null||e.removeAllRanges()}}const ac={cancel:{name:"pointercancel"},move:{name:"pointermove"},end:{name:"pointerup"}};class Ls extends Os{constructor(e){const{event:s}=e,n=Je(s.target);super(e,ac,n)}}Ls.activators=[{eventName:"onPointerDown",handler:(t,e)=>{let{nativeEvent:s}=t,{onActivation:n}=e;return!s.isPrimary||s.button!==0?!1:(n==null||n({event:s}),!0)}}];const oc={move:{name:"mousemove"},end:{name:"mouseup"}};var ps;(function(t){t[t.RightClick=2]="RightClick"})(ps||(ps={}));class ic extends Os{constructor(e){super(e,oc,Je(e.event.target))}}ic.activators=[{eventName:"onMouseDown",handler:(t,e)=>{let{nativeEvent:s}=t,{onActivation:n}=e;return s.button===ps.RightClick?!1:(n==null||n({event:s}),!0)}}];const as={cancel:{name:"touchcancel"},move:{name:"touchmove"},end:{name:"touchend"}};class cc extends Os{constructor(e){super(e,as)}static setup(){return window.addEventListener(as.move.name,e,{capture:!1,passive:!1}),function(){window.removeEventListener(as.move.name,e)};function e(){}}}cc.activators=[{eventName:"onTouchStart",handler:(t,e)=>{let{nativeEvent:s}=t,{onActivation:n}=e;const{touches:a}=s;return a.length>1?!1:(n==null||n({event:s}),!0)}}];var ct;(function(t){t[t.Pointer=0]="Pointer",t[t.DraggableRect=1]="DraggableRect"})(ct||(ct={}));var $t;(function(t){t[t.TreeOrder=0]="TreeOrder",t[t.ReversedTreeOrder=1]="ReversedTreeOrder"})($t||($t={}));function lc(t){let{acceleration:e,activator:s=ct.Pointer,canScroll:n,draggingRect:a,enabled:o,interval:i=5,order:c=$t.TreeOrder,pointerCoordinates:l,scrollableAncestors:h,scrollableAncestorRects:d,delta:f,threshold:m}=t;const y=uc({delta:f,disabled:!o}),[N,v]=bi(),C=u.useRef({x:0,y:0}),b=u.useRef({x:0,y:0}),x=u.useMemo(()=>{switch(s){case ct.Pointer:return l?{top:l.y,bottom:l.y,left:l.x,right:l.x}:null;case ct.DraggableRect:return a}},[s,a,l]),p=u.useRef(null),S=u.useCallback(()=>{const T=p.current;if(!T)return;const A=C.current.x*b.current.x,E=C.current.y*b.current.y;T.scrollBy(A,E)},[]),g=u.useMemo(()=>c===$t.TreeOrder?[...h].reverse():h,[c,h]);u.useEffect(()=>{if(!o||!h.length||!x){v();return}for(const T of g){if((n==null?void 0:n(T))===!1)continue;const A=h.indexOf(T),E=d[A];if(!E)continue;const{direction:D,speed:q}=Gi(T,E,x,e,m);for(const W of["x","y"])y[W][D[W]]||(q[W]=0,D[W]=0);if(q.x>0||q.y>0){v(),p.current=T,N(S,i),C.current=q,b.current=D;return}}C.current={x:0,y:0},b.current={x:0,y:0},v()},[e,S,n,v,o,i,JSON.stringify(x),JSON.stringify(y),N,h,g,d,JSON.stringify(m)])}const dc={x:{[H.Backward]:!1,[H.Forward]:!1},y:{[H.Backward]:!1,[H.Forward]:!1}};function uc(t){let{delta:e,disabled:s}=t;const n=Bt(e);return xt(a=>{if(s||!n||!a)return dc;const o={x:Math.sign(e.x-n.x),y:Math.sign(e.y-n.y)};return{x:{[H.Backward]:a.x[H.Backward]||o.x===-1,[H.Forward]:a.x[H.Forward]||o.x===1},y:{[H.Backward]:a.y[H.Backward]||o.y===-1,[H.Forward]:a.y[H.Forward]||o.y===1}}},[s,e,n])}function hc(t,e){const s=e!=null?t.get(e):void 0,n=s?s.node.current:null;return xt(a=>{var o;return e==null?null:(o=n??a)!=null?o:null},[n,e])}function mc(t,e){return u.useMemo(()=>t.reduce((s,n)=>{const{sensor:a}=n,o=a.activators.map(i=>({eventName:i.eventName,handler:e(i.handler,n)}));return[...s,...o]},[]),[t,e])}var mt;(function(t){t[t.Always=0]="Always",t[t.BeforeDragging=1]="BeforeDragging",t[t.WhileDragging=2]="WhileDragging"})(mt||(mt={}));var xs;(function(t){t.Optimized="optimized"})(xs||(xs={}));const gr=new Map;function fc(t,e){let{dragging:s,dependencies:n,config:a}=e;const[o,i]=u.useState(null),{frequency:c,measure:l,strategy:h}=a,d=u.useRef(t),f=C(),m=ht(f),y=u.useCallback(function(b){b===void 0&&(b=[]),!m.current&&i(x=>x===null?b:x.concat(b.filter(p=>!x.includes(p))))},[m]),N=u.useRef(null),v=xt(b=>{if(f&&!s)return gr;if(!b||b===gr||d.current!==t||o!=null){const x=new Map;for(let p of t){if(!p)continue;if(o&&o.length>0&&!o.includes(p.id)&&p.rect.current){x.set(p.id,p.rect.current);continue}const S=p.node.current,g=S?new _s(l(S),S):null;p.rect.current=g,g&&x.set(p.id,g)}return x}return b},[t,o,s,f,l]);return u.useEffect(()=>{d.current=t},[t]),u.useEffect(()=>{f||y()},[s,f]),u.useEffect(()=>{o&&o.length>0&&i(null)},[JSON.stringify(o)]),u.useEffect(()=>{f||typeof c!="number"||N.current!==null||(N.current=setTimeout(()=>{y(),N.current=null},c))},[c,f,y,...n]),{droppableRects:v,measureDroppableContainers:y,measuringScheduled:o!=null};function C(){switch(h){case mt.Always:return!1;case mt.BeforeDragging:return s;default:return!s}}}function Ms(t,e){return xt(s=>t?s||(typeof e=="function"?e(t):t):null,[e,t])}function gc(t,e){return Ms(t,e)}function pc(t){let{callback:e,disabled:s}=t;const n=Ut(e),a=u.useMemo(()=>{if(s||typeof window>"u"||typeof window.MutationObserver>"u")return;const{MutationObserver:o}=window;return new o(n)},[n,s]);return u.useEffect(()=>()=>a==null?void 0:a.disconnect(),[a]),a}function Xt(t){let{callback:e,disabled:s}=t;const n=Ut(e),a=u.useMemo(()=>{if(s||typeof window>"u"||typeof window.ResizeObserver>"u")return;const{ResizeObserver:o}=window;return new o(n)},[s]);return u.useEffect(()=>()=>a==null?void 0:a.disconnect(),[a]),a}function xc(t){return new _s(yt(t),t)}function pr(t,e,s){e===void 0&&(e=xc);const[n,a]=u.useState(null);function o(){a(l=>{if(!t)return null;if(t.isConnected===!1){var h;return(h=l??s)!=null?h:null}const d=e(t);return JSON.stringify(l)===JSON.stringify(d)?l:d})}const i=pc({callback(l){if(t)for(const h of l){const{type:d,target:f}=h;if(d==="childList"&&f instanceof HTMLElement&&f.contains(t)){o();break}}}}),c=Xt({callback:o});return Ce(()=>{o(),t?(c==null||c.observe(t),i==null||i.observe(document.body,{childList:!0,subtree:!0})):(c==null||c.disconnect(),i==null||i.disconnect())},[t]),n}function yc(t){const e=Ms(t);return Hr(t,e)}const xr=[];function bc(t){const e=u.useRef(t),s=xt(n=>t?n&&n!==xr&&t&&e.current&&t.parentNode===e.current.parentNode?n:Ts(t):xr,[t]);return u.useEffect(()=>{e.current=t},[t]),s}function vc(t){const[e,s]=u.useState(null),n=u.useRef(t),a=u.useCallback(o=>{const i=rs(o.target);i&&s(c=>c?(c.set(i,gs(i)),new Map(c)):null)},[]);return u.useEffect(()=>{const o=n.current;if(t!==o){i(o);const c=t.map(l=>{const h=rs(l);return h?(h.addEventListener("scroll",a,{passive:!0}),[h,gs(h)]):null}).filter(l=>l!=null);s(c.length?new Map(c):null),n.current=t}return()=>{i(t),i(o)};function i(c){c.forEach(l=>{const h=rs(l);h==null||h.removeEventListener("scroll",a)})}},[a,t]),u.useMemo(()=>t.length?e?Array.from(e.values()).reduce((o,i)=>Xe(o,i),ge):en(t):ge,[t,e])}function yr(t,e){e===void 0&&(e=[]);const s=u.useRef(null);return u.useEffect(()=>{s.current=null},e),u.useEffect(()=>{const n=t!==ge;n&&!s.current&&(s.current=t),!n&&s.current&&(s.current=null)},[t]),s.current?Wt(t,s.current):ge}function wc(t){u.useEffect(()=>{if(!Yt)return;const e=t.map(s=>{let{sensor:n}=s;return n.setup==null?void 0:n.setup()});return()=>{for(const s of e)s==null||s()}},t.map(e=>{let{sensor:s}=e;return s}))}function jc(t,e){return u.useMemo(()=>t.reduce((s,n)=>{let{eventName:a,handler:o}=n;return s[a]=i=>{o(i,e)},s},{}),[t,e])}function nn(t){return u.useMemo(()=>t?Hi(t):null,[t])}const br=[];function Nc(t,e){e===void 0&&(e=yt);const[s]=t,n=nn(s?Z(s):null),[a,o]=u.useState(br);function i(){o(()=>t.length?t.map(l=>Jr(l)?n:new _s(e(l),l)):br)}const c=Xt({callback:i});return Ce(()=>{c==null||c.disconnect(),i(),t.forEach(l=>c==null?void 0:c.observe(l))},[t]),a}function an(t){if(!t)return null;if(t.children.length>1)return t;const e=t.children[0];return pt(e)?e:t}function kc(t){let{measure:e}=t;const[s,n]=u.useState(null),a=u.useCallback(h=>{for(const{target:d}of h)if(pt(d)){n(f=>{const m=e(d);return f?{...f,width:m.width,height:m.height}:m});break}},[e]),o=Xt({callback:a}),i=u.useCallback(h=>{const d=an(h);o==null||o.disconnect(),d&&(o==null||o.observe(d)),n(d?e(d):null)},[e,o]),[c,l]=It(i);return u.useMemo(()=>({nodeRef:c,rect:s,setRef:l}),[s,c,l])}const Cc=[{sensor:Ls,options:{}},{sensor:rn,options:{}}],Sc={current:{}},At={draggable:{measure:ur},droppable:{measure:ur,strategy:mt.WhileDragging,frequency:xs.Optimized},dragOverlay:{measure:yt}};class lt extends Map{get(e){var s;return e!=null&&(s=super.get(e))!=null?s:void 0}toArray(){return Array.from(this.values())}getEnabled(){return this.toArray().filter(e=>{let{disabled:s}=e;return!s})}getNodeFor(e){var s,n;return(s=(n=this.get(e))==null?void 0:n.node.current)!=null?s:void 0}}const Ec={activatorEvent:null,active:null,activeNode:null,activeNodeRect:null,collisions:null,containerNodeRect:null,draggableNodes:new Map,droppableRects:new Map,droppableContainers:new lt,over:null,dragOverlay:{nodeRef:{current:null},rect:null,setRef:Ft},scrollableAncestors:[],scrollableAncestorRects:[],measuringConfiguration:At,measureDroppableContainers:Ft,windowRect:null,measuringScheduled:!1},on={activatorEvent:null,activators:[],active:null,activeNodeRect:null,ariaDescribedById:{draggable:""},dispatch:Ft,draggableNodes:new Map,over:null,measureDroppableContainers:Ft},bt=u.createContext(on),cn=u.createContext(Ec);function Ac(){return{draggable:{active:null,initialCoordinates:{x:0,y:0},nodes:new Map,translate:{x:0,y:0}},droppable:{containers:new lt}}}function Rc(t,e){switch(e.type){case U.DragStart:return{...t,draggable:{...t.draggable,initialCoordinates:e.initialCoordinates,active:e.active}};case U.DragMove:return t.draggable.active==null?t:{...t,draggable:{...t.draggable,translate:{x:e.coordinates.x-t.draggable.initialCoordinates.x,y:e.coordinates.y-t.draggable.initialCoordinates.y}}};case U.DragEnd:case U.DragCancel:return{...t,draggable:{...t.draggable,active:null,initialCoordinates:{x:0,y:0},translate:{x:0,y:0}}};case U.RegisterDroppable:{const{element:s}=e,{id:n}=s,a=new lt(t.droppable.containers);return a.set(n,s),{...t,droppable:{...t.droppable,containers:a}}}case U.SetDroppableDisabled:{const{id:s,key:n,disabled:a}=e,o=t.droppable.containers.get(s);if(!o||n!==o.key)return t;const i=new lt(t.droppable.containers);return i.set(s,{...o,disabled:a}),{...t,droppable:{...t.droppable,containers:i}}}case U.UnregisterDroppable:{const{id:s,key:n}=e,a=t.droppable.containers.get(s);if(!a||n!==a.key)return t;const o=new lt(t.droppable.containers);return o.delete(s),{...t,droppable:{...t.droppable,containers:o}}}default:return t}}function Tc(t){let{disabled:e}=t;const{active:s,activatorEvent:n,draggableNodes:a}=u.useContext(bt),o=Bt(n),i=Bt(s==null?void 0:s.id);return u.useEffect(()=>{if(!e&&!n&&o&&i!=null){if(!Rs(o)||document.activeElement===o.target)return;const c=a.get(i);if(!c)return;const{activatorNode:l,node:h}=c;if(!l.current&&!h.current)return;requestAnimationFrame(()=>{for(const d of[l.current,h.current]){if(!d)continue;const f=ji(d);if(f){f.focus();break}}})}},[n,e,a,i,o]),null}function ln(t,e){let{transform:s,...n}=e;return t!=null&&t.length?t.reduce((a,o)=>o({transform:a,...n}),s):s}function _c(t){return u.useMemo(()=>({draggable:{...At.draggable,...t==null?void 0:t.draggable},droppable:{...At.droppable,...t==null?void 0:t.droppable},dragOverlay:{...At.dragOverlay,...t==null?void 0:t.dragOverlay}}),[t==null?void 0:t.draggable,t==null?void 0:t.droppable,t==null?void 0:t.dragOverlay])}function Oc(t){let{activeNode:e,measure:s,initialRect:n,config:a=!0}=t;const o=u.useRef(!1),{x:i,y:c}=typeof a=="boolean"?{x:a,y:a}:a;Ce(()=>{if(!i&&!c||!e){o.current=!1;return}if(o.current||!n)return;const h=e==null?void 0:e.node.current;if(!h||h.isConnected===!1)return;const d=s(h),f=Hr(d,n);if(i||(f.x=0),c||(f.y=0),o.current=!0,Math.abs(f.x)>0||Math.abs(f.y)>0){const m=Qr(h);m&&m.scrollBy({top:f.y,left:f.x})}},[e,i,c,n,s])}const Qt=u.createContext({...ge,scaleX:1,scaleY:1});var Oe;(function(t){t[t.Uninitialized=0]="Uninitialized",t[t.Initializing=1]="Initializing",t[t.Initialized=2]="Initialized"})(Oe||(Oe={}));const Lc=u.memo(function(e){var s,n,a,o;let{id:i,accessibility:c,autoScroll:l=!0,children:h,sensors:d=Cc,collisionDetection:f=Fi,measuring:m,modifiers:y,...N}=e;const v=u.useReducer(Rc,void 0,Ac),[C,b]=v,[x,p]=Ai(),[S,g]=u.useState(Oe.Uninitialized),T=S===Oe.Initialized,{draggable:{active:A,nodes:E,translate:D},droppable:{containers:q}}=C,W=A!=null?E.get(A):null,Q=u.useRef({initial:null,translated:null}),G=u.useMemo(()=>{var K;return A!=null?{id:A,data:(K=W==null?void 0:W.data)!=null?K:Sc,rect:Q}:null},[A,W]),M=u.useRef(null),[$,We]=u.useState(null),[se,qe]=u.useState(null),oe=ht(N,Object.values(N)),w=Ht("DndDescribedBy",i),V=u.useMemo(()=>q.getEnabled(),[q]),j=_c(m),{droppableRects:R,measureDroppableContainers:O,measuringScheduled:ee}=fc(V,{dragging:T,dependencies:[D.x,D.y],config:j.droppable}),F=hc(E,A),pe=u.useMemo(()=>se?qt(se):null,[se]),Ne=Tn(),vt=gc(F,j.draggable.measure);Oc({activeNode:A!=null?E.get(A):null,config:Ne.layoutShiftCompensation,initialRect:vt,measure:j.draggable.measure});const J=pr(F,j.draggable.measure,vt),Jt=pr(F?F.parentElement:null),De=u.useRef({activatorEvent:null,active:null,activeNode:F,collisionRect:null,collisions:null,droppableRects:R,draggableNodes:E,draggingNode:null,draggingNodeRect:null,droppableContainers:q,over:null,scrollableAncestors:[],scrollAdjustedTranslate:null}),qs=q.getNodeFor((s=De.current.over)==null?void 0:s.id),Pe=kc({measure:j.dragOverlay.measure}),wt=(n=Pe.nodeRef.current)!=null?n:F,Fe=T?(a=Pe.rect)!=null?a:J:null,Fs=!!(Pe.nodeRef.current&&Pe.rect),$s=yc(Fs?null:J),Zt=nn(wt?Z(wt):null),Se=bc(T?qs??F:null),jt=Nc(Se),Nt=ln(y,{transform:{x:D.x-$s.x,y:D.y-$s.y,scaleX:1,scaleY:1},activatorEvent:se,active:G,activeNodeRect:J,containerNodeRect:Jt,draggingNodeRect:Fe,over:De.current.over,overlayNodeRect:Pe.rect,scrollableAncestors:Se,scrollableAncestorRects:jt,windowRect:Zt}),Vs=pe?Xe(pe,D):null,zs=vc(Se),Nn=yr(zs),kn=yr(zs,[J]),$e=Xe(Nt,Nn),Ve=Fe?zi(Fe,Nt):null,et=G&&Ve?f({active:G,collisionRect:Ve,droppableRects:R,droppableContainers:V,pointerCoordinates:Vs}):null,Ys=Bi(et,"id"),[Ee,Us]=u.useState(null),Cn=Fs?Nt:Xe(Nt,kn),Sn=$i(Cn,(o=Ee==null?void 0:Ee.rect)!=null?o:null,J),es=u.useRef(null),Hs=u.useCallback((K,re)=>{let{sensor:ne,options:Ae}=re;if(M.current==null)return;const ie=E.get(M.current);if(!ie)return;const ae=K.nativeEvent,xe=new ne({active:M.current,activeNode:ie,event:ae,options:Ae,context:De,onAbort(X){if(!E.get(X))return;const{onDragAbort:ye}=oe.current,ke={id:X};ye==null||ye(ke),x({type:"onDragAbort",event:ke})},onPending(X,Re,ye,ke){if(!E.get(X))return;const{onDragPending:st}=oe.current,Te={id:X,constraint:Re,initialCoordinates:ye,offset:ke};st==null||st(Te),x({type:"onDragPending",event:Te})},onStart(X){const Re=M.current;if(Re==null)return;const ye=E.get(Re);if(!ye)return;const{onDragStart:ke}=oe.current,tt={activatorEvent:ae,active:{id:Re,data:ye.data,rect:Q}};Be.unstable_batchedUpdates(()=>{ke==null||ke(tt),g(Oe.Initializing),b({type:U.DragStart,initialCoordinates:X,active:Re}),x({type:"onDragStart",event:tt}),We(es.current),qe(ae)})},onMove(X){b({type:U.DragMove,coordinates:X})},onEnd:ze(U.DragEnd),onCancel:ze(U.DragCancel)});es.current=xe;function ze(X){return async function(){const{active:ye,collisions:ke,over:tt,scrollAdjustedTranslate:st}=De.current;let Te=null;if(ye&&st){const{cancelDrop:rt}=oe.current;Te={activatorEvent:ae,active:ye,collisions:ke,delta:st,over:tt},X===U.DragEnd&&typeof rt=="function"&&await Promise.resolve(rt(Te))&&(X=U.DragCancel)}M.current=null,Be.unstable_batchedUpdates(()=>{b({type:X}),g(Oe.Uninitialized),Us(null),We(null),qe(null),es.current=null;const rt=X===U.DragEnd?"onDragEnd":"onDragCancel";if(Te){const ts=oe.current[rt];ts==null||ts(Te),x({type:rt,event:Te})}})}}},[E]),En=u.useCallback((K,re)=>(ne,Ae)=>{const ie=ne.nativeEvent,ae=E.get(Ae);if(M.current!==null||!ae||ie.dndKit||ie.defaultPrevented)return;const xe={active:ae};K(ne,re.options,xe)===!0&&(ie.dndKit={capturedBy:re.sensor},M.current=Ae,Hs(ne,re))},[E,Hs]),Xs=mc(d,En);wc(d),Ce(()=>{J&&S===Oe.Initializing&&g(Oe.Initialized)},[J,S]),u.useEffect(()=>{const{onDragMove:K}=oe.current,{active:re,activatorEvent:ne,collisions:Ae,over:ie}=De.current;if(!re||!ne)return;const ae={active:re,activatorEvent:ne,collisions:Ae,delta:{x:$e.x,y:$e.y},over:ie};Be.unstable_batchedUpdates(()=>{K==null||K(ae),x({type:"onDragMove",event:ae})})},[$e.x,$e.y]),u.useEffect(()=>{const{active:K,activatorEvent:re,collisions:ne,droppableContainers:Ae,scrollAdjustedTranslate:ie}=De.current;if(!K||M.current==null||!re||!ie)return;const{onDragOver:ae}=oe.current,xe=Ae.get(Ys),ze=xe&&xe.rect.current?{id:xe.id,rect:xe.rect.current,data:xe.data,disabled:xe.disabled}:null,X={active:K,activatorEvent:re,collisions:ne,delta:{x:ie.x,y:ie.y},over:ze};Be.unstable_batchedUpdates(()=>{Us(ze),ae==null||ae(X),x({type:"onDragOver",event:X})})},[Ys]),Ce(()=>{De.current={activatorEvent:se,active:G,activeNode:F,collisionRect:Ve,collisions:et,droppableRects:R,draggableNodes:E,draggingNode:wt,draggingNodeRect:Fe,droppableContainers:q,over:Ee,scrollableAncestors:Se,scrollAdjustedTranslate:$e},Q.current={initial:Fe,translated:Ve}},[G,F,et,Ve,E,wt,Fe,R,q,Ee,Se,$e]),lc({...Ne,delta:D,draggingRect:Ve,pointerCoordinates:Vs,scrollableAncestors:Se,scrollableAncestorRects:jt});const An=u.useMemo(()=>({active:G,activeNode:F,activeNodeRect:J,activatorEvent:se,collisions:et,containerNodeRect:Jt,dragOverlay:Pe,draggableNodes:E,droppableContainers:q,droppableRects:R,over:Ee,measureDroppableContainers:O,scrollableAncestors:Se,scrollableAncestorRects:jt,measuringConfiguration:j,measuringScheduled:ee,windowRect:Zt}),[G,F,J,se,et,Jt,Pe,E,q,R,Ee,O,Se,jt,j,ee,Zt]),Rn=u.useMemo(()=>({activatorEvent:se,activators:Xs,active:G,activeNodeRect:J,ariaDescribedById:{draggable:w},dispatch:b,draggableNodes:E,over:Ee,measureDroppableContainers:O}),[se,Xs,G,J,b,w,E,Ee,O]);return z.createElement(Ur.Provider,{value:p},z.createElement(bt.Provider,{value:Rn},z.createElement(cn.Provider,{value:An},z.createElement(Qt.Provider,{value:Sn},h)),z.createElement(Tc,{disabled:(c==null?void 0:c.restoreFocus)===!1})),z.createElement(_i,{...c,hiddenTextDescribedById:w}));function Tn(){const K=($==null?void 0:$.autoScrollEnabled)===!1,re=typeof l=="object"?l.enabled===!1:l===!1,ne=T&&!K&&!re;return typeof l=="object"?{...l,enabled:ne}:{enabled:ne}}}),Mc=u.createContext(null),vr="button",Dc="Draggable";function Pc(t){let{id:e,data:s,disabled:n=!1,attributes:a}=t;const o=Ht(Dc),{activators:i,activatorEvent:c,active:l,activeNodeRect:h,ariaDescribedById:d,draggableNodes:f,over:m}=u.useContext(bt),{role:y=vr,roleDescription:N="draggable",tabIndex:v=0}=a??{},C=(l==null?void 0:l.id)===e,b=u.useContext(C?Qt:Mc),[x,p]=It(),[S,g]=It(),T=jc(i,e),A=ht(s);Ce(()=>(f.set(e,{id:e,key:o,node:x,activatorNode:S,data:A}),()=>{const D=f.get(e);D&&D.key===o&&f.delete(e)}),[f,e]);const E=u.useMemo(()=>({role:y,tabIndex:v,"aria-disabled":n,"aria-pressed":C&&y===vr?!0:void 0,"aria-roledescription":N,"aria-describedby":d.draggable}),[n,y,v,C,N,d.draggable]);return{active:l,activatorEvent:c,activeNodeRect:h,attributes:E,isDragging:C,listeners:n?void 0:T,node:x,over:m,setNodeRef:p,setActivatorNodeRef:g,transform:b}}function Ic(){return u.useContext(cn)}const Bc="Droppable",Wc={timeout:25};function qc(t){let{data:e,disabled:s=!1,id:n,resizeObserverConfig:a}=t;const o=Ht(Bc),{active:i,dispatch:c,over:l,measureDroppableContainers:h}=u.useContext(bt),d=u.useRef({disabled:s}),f=u.useRef(!1),m=u.useRef(null),y=u.useRef(null),{disabled:N,updateMeasurementsFor:v,timeout:C}={...Wc,...a},b=ht(v??n),x=u.useCallback(()=>{if(!f.current){f.current=!0;return}y.current!=null&&clearTimeout(y.current),y.current=setTimeout(()=>{h(Array.isArray(b.current)?b.current:[b.current]),y.current=null},C)},[C]),p=Xt({callback:x,disabled:N||!i}),S=u.useCallback((E,D)=>{p&&(D&&(p.unobserve(D),f.current=!1),E&&p.observe(E))},[p]),[g,T]=It(S),A=ht(e);return u.useEffect(()=>{!p||!g.current||(p.disconnect(),f.current=!1,p.observe(g.current))},[g,p]),u.useEffect(()=>(c({type:U.RegisterDroppable,element:{id:n,key:o,disabled:s,node:g,rect:m,data:A}}),()=>c({type:U.UnregisterDroppable,key:o,id:n})),[n]),u.useEffect(()=>{s!==d.current.disabled&&(c({type:U.SetDroppableDisabled,id:n,key:o,disabled:s}),d.current.disabled=s)},[n,o,s,c]),{active:i,rect:m,isOver:(l==null?void 0:l.id)===n,node:g,over:l,setNodeRef:T}}function Fc(t){let{animation:e,children:s}=t;const[n,a]=u.useState(null),[o,i]=u.useState(null),c=Bt(s);return!s&&!n&&c&&a(c),Ce(()=>{if(!o)return;const l=n==null?void 0:n.key,h=n==null?void 0:n.props.id;if(l==null||h==null){a(null);return}Promise.resolve(e(h,o)).then(()=>{a(null)})},[e,n,o]),z.createElement(z.Fragment,null,s,n?u.cloneElement(n,{ref:i}):null)}const $c={x:0,y:0,scaleX:1,scaleY:1};function Vc(t){let{children:e}=t;return z.createElement(bt.Provider,{value:on},z.createElement(Qt.Provider,{value:$c},e))}const zc={position:"fixed",touchAction:"none"},Yc=t=>Rs(t)?"transform 250ms ease":void 0,Uc=u.forwardRef((t,e)=>{let{as:s,activatorEvent:n,adjustScale:a,children:o,className:i,rect:c,style:l,transform:h,transition:d=Yc}=t;if(!c)return null;const f=a?h:{...h,scaleX:1,scaleY:1},m={...zc,width:c.width,height:c.height,top:c.top,left:c.left,transform:Ke.Transform.toString(f),transformOrigin:a&&n?Di(n,c):void 0,transition:typeof d=="function"?d(n):d,...l};return z.createElement(s,{className:i,style:m,ref:e},o)}),Hc=t=>e=>{let{active:s,dragOverlay:n}=e;const a={},{styles:o,className:i}=t;if(o!=null&&o.active)for(const[c,l]of Object.entries(o.active))l!==void 0&&(a[c]=s.node.style.getPropertyValue(c),s.node.style.setProperty(c,l));if(o!=null&&o.dragOverlay)for(const[c,l]of Object.entries(o.dragOverlay))l!==void 0&&n.node.style.setProperty(c,l);return i!=null&&i.active&&s.node.classList.add(i.active),i!=null&&i.dragOverlay&&n.node.classList.add(i.dragOverlay),function(){for(const[l,h]of Object.entries(a))s.node.style.setProperty(l,h);i!=null&&i.active&&s.node.classList.remove(i.active)}},Xc=t=>{let{transform:{initial:e,final:s}}=t;return[{transform:Ke.Transform.toString(e)},{transform:Ke.Transform.toString(s)}]},Qc={duration:250,easing:"ease",keyframes:Xc,sideEffects:Hc({styles:{active:{opacity:"0"}}})};function Kc(t){let{config:e,draggableNodes:s,droppableContainers:n,measuringConfiguration:a}=t;return Ut((o,i)=>{if(e===null)return;const c=s.get(o);if(!c)return;const l=c.node.current;if(!l)return;const h=an(i);if(!h)return;const{transform:d}=Z(i).getComputedStyle(i),f=Xr(d);if(!f)return;const m=typeof e=="function"?e:Gc(e);return tn(l,a.draggable.measure),m({active:{id:o,data:c.data,node:l,rect:a.draggable.measure(l)},draggableNodes:s,dragOverlay:{node:i,rect:a.dragOverlay.measure(h)},droppableContainers:n,measuringConfiguration:a,transform:f})})}function Gc(t){const{duration:e,easing:s,sideEffects:n,keyframes:a}={...Qc,...t};return o=>{let{active:i,dragOverlay:c,transform:l,...h}=o;if(!e)return;const d={x:c.rect.left-i.rect.left,y:c.rect.top-i.rect.top},f={scaleX:l.scaleX!==1?i.rect.width*l.scaleX/c.rect.width:1,scaleY:l.scaleY!==1?i.rect.height*l.scaleY/c.rect.height:1},m={x:l.x-d.x,y:l.y-d.y,...f},y=a({...h,active:i,dragOverlay:c,transform:{initial:l,final:m}}),[N]=y,v=y[y.length-1];if(JSON.stringify(N)===JSON.stringify(v))return;const C=n==null?void 0:n({active:i,dragOverlay:c,...h}),b=c.node.animate(y,{duration:e,easing:s,fill:"forwards"});return new Promise(x=>{b.onfinish=()=>{C==null||C(),x()}})}}let wr=0;function Jc(t){return u.useMemo(()=>{if(t!=null)return wr++,wr},[t])}const Zc=z.memo(t=>{let{adjustScale:e=!1,children:s,dropAnimation:n,style:a,transition:o,modifiers:i,wrapperElement:c="div",className:l,zIndex:h=999}=t;const{activatorEvent:d,active:f,activeNodeRect:m,containerNodeRect:y,draggableNodes:N,droppableContainers:v,dragOverlay:C,over:b,measuringConfiguration:x,scrollableAncestors:p,scrollableAncestorRects:S,windowRect:g}=Ic(),T=u.useContext(Qt),A=Jc(f==null?void 0:f.id),E=ln(i,{activatorEvent:d,active:f,activeNodeRect:m,containerNodeRect:y,draggingNodeRect:C.rect,over:b,overlayNodeRect:C.rect,scrollableAncestors:p,scrollableAncestorRects:S,transform:T,windowRect:g}),D=Ms(m),q=Kc({config:n,draggableNodes:N,droppableContainers:v,measuringConfiguration:x}),W=D?C.setRef:void 0;return z.createElement(Vc,null,z.createElement(Fc,{animation:q},f&&A?z.createElement(Uc,{key:A,id:f.id,ref:W,as:c,activatorEvent:d,adjustScale:e,className:l,transition:o,rect:D,style:{zIndex:h,...a},transform:E},s):null))});function el({id:t,children:e}){const{setNodeRef:s,isOver:n}=qc({id:t});return r.jsx("div",{ref:s,className:`flex-1 overflow-y-auto p-3 space-y-3 transition-colors ${n?"bg-primary-50":""}`,children:e})}const tl=t=>{switch(t){case"whatsapp":return r.jsx(Mt,{className:"w-3.5 h-3.5"});case"phone":return r.jsx(zt,{className:"w-3.5 h-3.5"});case"email":return r.jsx(Cs,{className:"w-3.5 h-3.5"});default:return r.jsx(Mt,{className:"w-3.5 h-3.5"})}},sl=t=>({whatsapp:"WhatsApp",phone:"Telefone",email:"E-mail",instagram:"Instagram",facebook:"Facebook",website:"Site",in_person:"Presencial",other:"Outro"})[t||"whatsapp"]||"WhatsApp",rl=t=>({conversa_iniciada:"Conversa Iniciada",agendamento_pendente:"Aguardando Agendamento",agendado:"Agendado",em_tratamento:"Em Tratamento",finalizado:"Finalizado",cancelado:"Cancelado"})[t||"conversa_iniciada"]||"Conversa Iniciada",nl=t=>({moema:"Moema",perdizes:"Perdizes",online:"Online",a_domicilio:"Domic√≠lio"})[t||"moema"]||"Moema",al=t=>{if(!t)return"?";const e=t.split(" ");return e.length>=2?`${e[0][0]}${e[1][0]}`.toUpperCase():t.substring(0,2).toUpperCase()};function jr({lead:t,formatCurrency:e,onClick:s}){const{attributes:n,listeners:a,setNodeRef:o,transform:i,isDragging:c}=Pc({id:t.id}),l={transform:Ke.Translate.toString(i),opacity:c?.5:1},h=u.useRef(!1);u.useEffect(()=>{i&&(Math.abs(i.x)>5||Math.abs(i.y)>5)&&(h.current=!0)},[i]),u.useEffect(()=>{if(!c&&h.current){const f=setTimeout(()=>{h.current=!1},100);return()=>clearTimeout(f)}},[c]);const d=f=>{h.current||c||s()};return r.jsxs("div",{ref:o,style:l,...a,...n,onClick:d,className:"bg-white p-3 rounded-lg shadow-sm hover:shadow-md transition-all cursor-grab active:cursor-grabbing border border-gray-200",children:[r.jsxs("div",{className:"flex items-start justify-between mb-2",children:[r.jsx("h4",{className:"font-semibold text-gray-900 text-sm flex-1 pr-2 line-clamp-2",children:t.name}),t.assignedTo&&r.jsx("div",{className:"flex-shrink-0 w-7 h-7 rounded-full bg-primary-100 text-primary-700 flex items-center justify-center text-xs font-semibold",title:`Respons√°vel: ${t.assignedTo.name}`,children:al(t.assignedTo.name)})]}),t.procedure&&r.jsx("div",{className:"mb-2",children:r.jsx("span",{className:"text-xs px-2 py-0.5 rounded font-medium inline-block",style:{backgroundColor:t.procedure.color+"20",color:t.procedure.color},children:t.procedure.name})}),t.estimatedValue&&r.jsx("p",{className:"text-sm font-bold text-primary-600 mb-2",children:e(t.estimatedValue)}),r.jsxs("div",{className:"space-y-1.5 mb-2",children:[t.channel&&r.jsxs("div",{className:"flex items-center gap-1.5 text-xs text-gray-600",children:[tl(t.channel),r.jsx("span",{children:sl(t.channel)})]}),t.clientStatus&&r.jsxs("div",{className:"flex items-center gap-1.5 text-xs text-gray-600",children:[r.jsx(Ue,{className:"w-3.5 h-3.5"}),r.jsx("span",{children:rl(t.clientStatus)})]}),t.attendanceLocation&&r.jsxs("div",{className:"flex items-center gap-1.5 text-xs text-gray-600",children:[r.jsx(Hn,{className:"w-3.5 h-3.5"}),r.jsx("span",{children:nl(t.attendanceLocation)})]})]}),r.jsxs("div",{className:"flex items-center gap-2 text-xs text-gray-400",children:[t.email&&r.jsx(Cs,{className:"w-3.5 h-3.5",title:t.email}),t.phone&&r.jsx(zt,{className:"w-3.5 h-3.5",title:t.phone}),t.whatsapp&&r.jsx(Mt,{className:"w-3.5 h-3.5",title:t.whatsapp})]}),t.tags&&t.tags.length>0&&r.jsxs("div",{className:"flex flex-wrap gap-1 mt-2",children:[t.tags.slice(0,2).map((f,m)=>r.jsx("span",{className:"text-xs px-1.5 py-0.5 bg-gray-100 text-gray-600 rounded",children:f},m)),t.tags.length>2&&r.jsxs("span",{className:"text-xs px-1.5 py-0.5 bg-gray-100 text-gray-600 rounded",children:["+",t.tags.length-2]})]})]})}function ol({leads:t,stages:e,formatCurrency:s,onLeadClick:n}){const a=i=>{const c=e.find(l=>l.id===i);return(c==null?void 0:c.name)||"-"},o=i=>{const c=e.find(l=>l.id===i);return(c==null?void 0:c.color)||"#gray"};return r.jsx("div",{className:"bg-white rounded-lg border border-gray-200 overflow-hidden",children:r.jsx("div",{className:"overflow-x-auto",children:r.jsxs("table",{className:"w-full",children:[r.jsx("thead",{className:"bg-gray-50 border-b border-gray-200",children:r.jsxs("tr",{children:[r.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Nome"}),r.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Est√°gio"}),r.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Procedimento"}),r.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Contato"}),r.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Valor"}),r.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Data"})]})}),r.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:t.length===0?r.jsx("tr",{children:r.jsx("td",{colSpan:6,className:"px-6 py-12 text-center text-gray-500",children:"Nenhum lead encontrado"})}):t.map(i=>r.jsxs("tr",{onClick:()=>n(i),className:"hover:bg-gray-50 cursor-pointer transition-colors",children:[r.jsxs("td",{className:"px-6 py-4 whitespace-nowrap",children:[r.jsx("div",{className:"font-medium text-gray-900",children:i.name}),i.email&&r.jsx("div",{className:"text-sm text-gray-500",children:i.email})]}),r.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:r.jsxs("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium",style:{backgroundColor:o(i.stageId)+"20",color:o(i.stageId)},children:[r.jsx("span",{className:"w-2 h-2 rounded-full mr-1.5",style:{backgroundColor:o(i.stageId)}}),a(i.stageId)]})}),r.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:i.procedure?r.jsx("span",{className:"inline-flex px-2 py-1 text-xs font-medium rounded-md",style:{backgroundColor:i.procedure.color+"20",color:i.procedure.color},children:i.procedure.name}):r.jsx("span",{className:"text-gray-400",children:"-"})}),r.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:r.jsx("div",{className:"text-sm text-gray-900",children:i.phone||"-"})}),r.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:i.estimatedValue?r.jsx("div",{className:"text-sm font-semibold text-primary-600",children:s(i.estimatedValue)}):r.jsx("span",{className:"text-gray-400",children:"-"})}),r.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:r.jsx("div",{className:"text-sm text-gray-500",children:i.expectedCloseDate?new Date(i.expectedCloseDate).toLocaleDateString("pt-BR"):"-"})})]},i.id))})]})})})}function il({leads:t,stages:e,formatCurrency:s,onLeadClick:n}){const a=i=>{const c=e.find(l=>l.id===i);return(c==null?void 0:c.name)||"-"},o=i=>{const c=e.find(l=>l.id===i);return(c==null?void 0:c.color)||"#6b7280"};return r.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-4",children:t.length===0?r.jsx("div",{className:"col-span-full text-center py-12 text-gray-500",children:"Nenhum lead encontrado"}):t.map(i=>r.jsxs("div",{onClick:()=>n(i),className:"bg-white p-4 rounded-lg shadow-sm hover:shadow-md transition-shadow cursor-pointer border border-gray-200",children:[r.jsx("div",{className:"flex items-center justify-between mb-3",children:r.jsxs("span",{className:"inline-flex items-center px-2 py-1 rounded-md text-xs font-medium",style:{backgroundColor:o(i.stageId)+"20",color:o(i.stageId)},children:[r.jsx("span",{className:"w-2 h-2 rounded-full mr-1",style:{backgroundColor:o(i.stageId)}}),a(i.stageId)]})}),r.jsx("h4",{className:"font-semibold text-gray-900 text-base mb-2",children:i.name}),i.procedure&&r.jsx("div",{className:"mb-2",children:r.jsx("span",{className:"text-xs px-2 py-1 rounded-md font-medium",style:{backgroundColor:i.procedure.color+"20",color:i.procedure.color},children:i.procedure.name})}),i.estimatedValue&&r.jsx("p",{className:"text-sm font-semibold text-primary-600 mb-3",children:s(i.estimatedValue)}),r.jsxs("div",{className:"space-y-1 mb-3",children:[i.email&&r.jsxs("div",{className:"flex items-center gap-2 text-xs text-gray-600",children:[r.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 8l7.89 5.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"})}),r.jsx("span",{className:"truncate",children:i.email})]}),i.phone&&r.jsxs("div",{className:"flex items-center gap-2 text-xs text-gray-600",children:[r.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 5a2 2 0 012-2h3.28a1 1 0 01.948.684l1.498 4.493a1 1 0 01-.502 1.21l-2.257 1.13a11.042 11.042 0 005.516 5.516l1.13-2.257a1 1 0 011.21-.502l4.493 1.498a1 1 0 01.684.949V19a2 2 0 01-2 2h-1C9.716 21 3 14.284 3 6V5z"})}),r.jsx("span",{children:i.phone})]})]}),i.expectedCloseDate&&r.jsxs("div",{className:"text-xs text-gray-500 border-t border-gray-100 pt-2",children:[r.jsx("svg",{className:"w-3 h-3 inline mr-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"})}),new Date(i.expectedCloseDate).toLocaleDateString("pt-BR")]}),i.tags&&i.tags.length>0&&r.jsxs("div",{className:"flex flex-wrap gap-1 mt-2",children:[i.tags.slice(0,3).map((c,l)=>r.jsx("span",{className:"text-xs px-2 py-0.5 bg-gray-100 text-gray-600 rounded",children:c},l)),i.tags.length>3&&r.jsxs("span",{className:"text-xs px-2 py-0.5 bg-gray-100 text-gray-600 rounded",children:["+",i.tags.length-3]})]})]},i.id))})}function cl({leads:t,stages:e,formatCurrency:s,onLeadClick:n}){const a=l=>{const h=e.find(d=>d.id===l);return(h==null?void 0:h.name)||"-"},o=l=>{const h=e.find(d=>d.id===l);return(h==null?void 0:h.color)||"#6b7280"},c=(()=>{const l={};return t.forEach(h=>{const d=h.expectedCloseDate?new Date(h.expectedCloseDate).toLocaleDateString("pt-BR"):"Sem data";l[d]||(l[d]=[]),l[d].push(h)}),Object.entries(l).sort(([h],[d])=>h==="Sem data"?1:d==="Sem data"?-1:new Date(h.split("/").reverse().join("-")).getTime()-new Date(d.split("/").reverse().join("-")).getTime())})();return r.jsx("div",{className:"space-y-6",children:c.length===0?r.jsx("div",{className:"text-center py-12 text-gray-500",children:"Nenhum lead encontrado"}):c.map(([l,h])=>r.jsxs("div",{className:"relative",children:[r.jsxs("div",{className:"sticky top-0 bg-gray-50 border-l-4 border-primary-500 pl-4 py-2 mb-4 flex items-center gap-3",children:[r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx("svg",{className:"w-5 h-5 text-primary-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"})}),r.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:l})]}),r.jsxs("span",{className:"text-sm text-gray-600",children:[h.length," ",h.length===1?"lead":"leads"]})]}),r.jsx("div",{className:"pl-8 space-y-3",children:h.map(d=>r.jsxs("div",{onClick:()=>n(d),className:"relative bg-white p-4 rounded-lg shadow-sm hover:shadow-md transition-shadow cursor-pointer border border-gray-200",children:[r.jsx("div",{className:"absolute -left-10 top-6 w-4 h-4 rounded-full border-4 border-white",style:{backgroundColor:o(d.stageId)}}),r.jsxs("div",{className:"flex items-start justify-between mb-2",children:[r.jsxs("div",{className:"flex-1",children:[r.jsx("h4",{className:"font-semibold text-gray-900",children:d.name}),d.email&&r.jsx("p",{className:"text-sm text-gray-500",children:d.email})]}),r.jsx("span",{className:"inline-flex items-center px-2 py-1 rounded-md text-xs font-medium ml-2",style:{backgroundColor:o(d.stageId)+"20",color:o(d.stageId)},children:a(d.stageId)})]}),r.jsxs("div",{className:"flex items-center gap-4 text-sm text-gray-600",children:[d.procedure&&r.jsx("span",{className:"inline-flex px-2 py-1 text-xs font-medium rounded-md",style:{backgroundColor:d.procedure.color+"20",color:d.procedure.color},children:d.procedure.name}),d.estimatedValue&&r.jsx("span",{className:"font-semibold text-primary-600",children:s(d.estimatedValue)}),d.phone&&r.jsxs("span",{className:"flex items-center gap-1",children:[r.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 5a2 2 0 012-2h3.28a1 1 0 01.948.684l1.498 4.493a1 1 0 01-.502 1.21l-2.257 1.13a11.042 11.042 0 005.516 5.516l1.13-2.257a1 1 0 011.21-.502l4.493 1.498a1 1 0 01.684.949V19a2 2 0 01-2 2h-1C9.716 21 3 14.284 3 6V5z"})}),d.phone]})]})]},d.id))})]},l))})}function ll({leads:t,stages:e,formatCurrency:s,onLeadClick:n}){const[a,o]=u.useState(t[0]||null),i=h=>{const d=e.find(f=>f.id===h);return(d==null?void 0:d.name)||"-"},c=h=>{const d=e.find(f=>f.id===h);return(d==null?void 0:d.color)||"#6b7280"},l=h=>{o(h)};return r.jsxs("div",{className:"flex gap-4 h-[calc(100vh-18rem)]",children:[r.jsxs("div",{className:"w-96 flex-shrink-0 bg-white rounded-lg border border-gray-200 overflow-hidden flex flex-col",children:[r.jsx("div",{className:"p-4 border-b border-gray-200",children:r.jsxs("h3",{className:"font-semibold text-gray-900",children:["Leads (",t.length,")"]})}),r.jsx("div",{className:"flex-1 overflow-y-auto",children:t.length===0?r.jsx("div",{className:"p-6 text-center text-gray-500",children:"Nenhum lead encontrado"}):r.jsx("div",{className:"divide-y divide-gray-200",children:t.map(h=>r.jsxs("div",{onClick:()=>l(h),className:`p-4 cursor-pointer transition-colors ${(a==null?void 0:a.id)===h.id?"bg-primary-50 border-l-4 border-primary-500":"hover:bg-gray-50"}`,children:[r.jsxs("div",{className:"flex items-start justify-between mb-1",children:[r.jsx("h4",{className:"font-medium text-gray-900 text-sm",children:h.name}),r.jsx("span",{className:"w-2 h-2 rounded-full flex-shrink-0 mt-1.5",style:{backgroundColor:c(h.stageId)}})]}),h.email&&r.jsx("p",{className:"text-xs text-gray-500 mb-1",children:h.email}),h.estimatedValue&&r.jsx("p",{className:"text-xs font-semibold text-primary-600",children:s(h.estimatedValue)})]},h.id))})})]}),r.jsx("div",{className:"flex-1 bg-white rounded-lg border border-gray-200 overflow-hidden",children:a?r.jsxs("div",{className:"h-full overflow-y-auto",children:[r.jsx("div",{className:"p-6 border-b border-gray-200",children:r.jsxs("div",{className:"flex items-start justify-between mb-3",children:[r.jsxs("div",{children:[r.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-1",children:a.name}),r.jsx("div",{className:"flex items-center gap-2",children:r.jsxs("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium",style:{backgroundColor:c(a.stageId)+"20",color:c(a.stageId)},children:[r.jsx("span",{className:"w-2 h-2 rounded-full mr-1.5",style:{backgroundColor:c(a.stageId)}}),i(a.stageId)]})})]}),r.jsx("button",{onClick:()=>n(a),className:"px-4 py-2 text-sm font-medium text-white bg-primary-600 rounded-lg hover:bg-primary-700",children:"Editar"})]})}),r.jsxs("div",{className:"p-6 space-y-6",children:[a.procedure&&r.jsxs("div",{children:[r.jsx("h3",{className:"text-sm font-semibold text-gray-700 mb-2",children:"Procedimento"}),r.jsx("span",{className:"inline-flex px-3 py-1.5 text-sm font-medium rounded-md",style:{backgroundColor:a.procedure.color+"20",color:a.procedure.color},children:a.procedure.name})]}),r.jsxs("div",{children:[r.jsx("h3",{className:"text-sm font-semibold text-gray-700 mb-3",children:"Informa√ß√µes de Contato"}),r.jsxs("div",{className:"space-y-2",children:[a.email&&r.jsxs("div",{className:"flex items-center gap-3 text-sm",children:[r.jsx("svg",{className:"w-5 h-5 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 8l7.89 5.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"})}),r.jsx("span",{className:"text-gray-900",children:a.email})]}),a.phone&&r.jsxs("div",{className:"flex items-center gap-3 text-sm",children:[r.jsx("svg",{className:"w-5 h-5 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 5a2 2 0 012-2h3.28a1 1 0 01.948.684l1.498 4.493a1 1 0 01-.502 1.21l-2.257 1.13a11.042 11.042 0 005.516 5.516l1.13-2.257a1 1 0 011.21-.502l4.493 1.498a1 1 0 01.684.949V19a2 2 0 01-2 2h-1C9.716 21 3 14.284 3 6V5z"})}),r.jsx("span",{className:"text-gray-900",children:a.phone})]})]})]}),r.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[a.estimatedValue&&r.jsxs("div",{children:[r.jsx("h3",{className:"text-sm font-semibold text-gray-700 mb-2",children:"Valor Estimado"}),r.jsx("p",{className:"text-2xl font-bold text-primary-600",children:s(a.estimatedValue)})]}),a.expectedCloseDate&&r.jsxs("div",{children:[r.jsx("h3",{className:"text-sm font-semibold text-gray-700 mb-2",children:"Data Esperada"}),r.jsx("p",{className:"text-lg font-medium text-gray-900",children:new Date(a.expectedCloseDate).toLocaleDateString("pt-BR",{day:"2-digit",month:"long",year:"numeric"})})]})]}),a.notes&&r.jsxs("div",{children:[r.jsx("h3",{className:"text-sm font-semibold text-gray-700 mb-2",children:"Observa√ß√µes"}),r.jsx("p",{className:"text-sm text-gray-600 whitespace-pre-wrap bg-gray-50 p-3 rounded-lg",children:a.notes})]}),a.tags&&a.tags.length>0&&r.jsxs("div",{children:[r.jsx("h3",{className:"text-sm font-semibold text-gray-700 mb-2",children:"Tags"}),r.jsx("div",{className:"flex flex-wrap gap-2",children:a.tags.map((h,d)=>r.jsx("span",{className:"px-3 py-1 bg-gray-100 text-gray-700 rounded-full text-sm",children:h},d))})]})]})]}):r.jsx("div",{className:"h-full flex items-center justify-center text-gray-500",children:"Selecione um lead para ver os detalhes"})})]})}function dl(){const t=Rr(),[e,s]=u.useState([]),[n,a]=u.useState(null),[o,i]=u.useState([]),[c,l]=u.useState([]),[h,d]=u.useState(!0),[f,m]=u.useState(!1),[y,N]=u.useState(void 0),[v,C]=u.useState(null),[b,x]=u.useState("kanban"),[p,S]=u.useState(!1),[g,T]=u.useState({}),A=Li(Oi(Ls,{activationConstraint:{distance:8}}));u.useEffect(()=>{E()},[]),u.useEffect(()=>{n&&D()},[n]),u.useEffect(()=>{Object.keys(g).length>0&&q(g)},[o]),u.useEffect(()=>{const j=t.state;if(j!=null&&j.openLeadId&&o.length>0){const R=o.find(O=>O.id===j.openLeadId);R&&(M(R),window.history.replaceState({},document.title))}},[t.state,o]);const E=async()=>{try{const j=await fe.getPipelines();s(j),j.length>0&&a(j[0])}catch(j){_.error("Erro ao carregar pipelines"),console.error(j)}finally{d(!1)}},D=async()=>{try{const j=await fe.getLeads();i(j),l(j)}catch(j){_.error("Erro ao carregar leads"),console.error(j)}},q=j=>{let R=[...o];if(j.search){const O=j.search.toLowerCase();R=R.filter(ee=>{var F,pe;return ee.name.toLowerCase().includes(O)||((F=ee.email)==null?void 0:F.toLowerCase().includes(O))||((pe=ee.phone)==null?void 0:pe.includes(j.search))})}j.stageId&&(R=R.filter(O=>O.stageId===j.stageId)),j.procedureId&&(R=R.filter(O=>O.procedureId===j.procedureId)),j.assignedToId&&(R=R.filter(O=>O.assignedToId===j.assignedToId)),j.clientStatus&&(R=R.filter(O=>O.clientStatus===j.clientStatus)),j.channel&&(R=R.filter(O=>O.channel===j.channel)),j.attendanceLocation&&(R=R.filter(O=>O.attendanceLocation===j.attendanceLocation)),j.minValue!==void 0&&(R=R.filter(O=>(O.estimatedValue||0)>=j.minValue)),j.maxValue!==void 0&&(R=R.filter(O=>(O.estimatedValue||0)<=j.maxValue)),l(R),T(j)},W=j=>{q(j)},Q=()=>{T({}),l(o)},G=()=>{N(void 0),m(!0)},M=j=>{N(j),m(!0)},$=()=>{m(!1),N(void 0)},We=async j=>{y?await fe.updateLead(y.id,j):await fe.createLead(j),await D(),$()},se=j=>{const{active:R}=j,O=c.find(ee=>ee.id===R.id);C(O||null)},qe=async j=>{const{active:R,over:O}=j;if(C(null),!O)return;const ee=R.id,F=O.id,pe=c.find(Ne=>Ne.id===ee);if(!(!pe||pe.stageId===F))try{const Ne=vt=>vt.map(J=>J.id===ee?{...J,stageId:F}:J);i(Ne),l(Ne),await fe.moveLeadToStage(ee,F),_.success("Lead movido com sucesso!")}catch(Ne){console.error("Erro ao mover lead:",Ne),_.error("Erro ao mover lead"),await D()}},oe=j=>c.filter(R=>R.stageId===j),w=j=>j?new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format(j):"";if(h)return r.jsx("div",{className:"flex items-center justify-center h-screen",children:r.jsxs("div",{className:"text-center",children:[r.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-primary-600 mx-auto"}),r.jsx("p",{className:"mt-4 text-gray-600",children:"Carregando..."})]})});if(!n)return r.jsx("div",{className:"p-6",children:r.jsxs("div",{className:"text-center",children:[r.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-4",children:"Nenhum Pipeline Encontrado"}),r.jsx("p",{className:"text-gray-600 mb-6",children:"Crie seu primeiro pipeline para come√ßar a gerenciar leads."}),r.jsx("button",{className:"btn-primary",children:"Criar Pipeline"})]})});const V=()=>{var j;switch(b){case"list":return r.jsx(ol,{leads:c,stages:(n==null?void 0:n.stages)||[],formatCurrency:w,onLeadClick:M});case"grid":return r.jsx(il,{leads:c,stages:(n==null?void 0:n.stages)||[],formatCurrency:w,onLeadClick:M});case"timeline":return r.jsx(cl,{leads:c,stages:(n==null?void 0:n.stages)||[],formatCurrency:w,onLeadClick:M});case"division":return r.jsx(ll,{leads:c,stages:(n==null?void 0:n.stages)||[],formatCurrency:w,onLeadClick:M});case"kanban":default:return r.jsx("div",{className:"flex-1 overflow-x-auto",children:r.jsx("div",{className:"flex gap-4 min-h-[calc(100vh-20rem)] pb-4",children:(j=n.stages)==null?void 0:j.map(R=>{const O=oe(R.id),ee=O.reduce((F,pe)=>F+(pe.estimatedValue||0),0);return r.jsxs("div",{className:"flex-shrink-0 w-80 bg-gray-100 rounded-lg flex flex-col",children:[r.jsxs("div",{className:"p-4 border-b border-gray-200",children:[r.jsxs("div",{className:"flex items-center justify-between mb-2",children:[r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx("div",{className:"w-3 h-3 rounded-full",style:{backgroundColor:R.color}}),r.jsx("h3",{className:"font-semibold text-gray-900",children:R.name})]}),r.jsx("span",{className:"text-sm font-medium text-gray-600",children:O.length})]}),r.jsxs("div",{className:"text-xs text-gray-500",children:[w(ee)," ‚Ä¢ ",R.probability,"% prob."]})]}),r.jsx(el,{id:R.id,children:O.length===0?r.jsx("div",{className:"text-center py-8 text-gray-400 text-sm",children:"Nenhum lead neste est√°gio"}):O.map(F=>r.jsx(jr,{lead:F,formatCurrency:w,onClick:()=>M(F)},F.id))})]},R.id)})})})}};return r.jsxs("div",{className:"flex flex-col min-h-[calc(100vh-8rem)]",children:[r.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-4 mb-4",children:[r.jsxs("div",{className:"flex items-center justify-between mb-4",children:[r.jsxs("div",{children:[r.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:n.name}),r.jsx("p",{className:"text-sm text-gray-500",children:"Pipeline de vendas"})]}),r.jsxs("div",{className:"flex gap-3",children:[r.jsxs("button",{onClick:()=>S(!0),className:"px-4 py-2 text-gray-700 bg-white border border-gray-300 rounded-lg hover:bg-gray-50 relative",children:["Filtros",Object.keys(g).filter(j=>g[j]).length>0&&r.jsx("span",{className:"absolute -top-1 -right-1 w-5 h-5 bg-primary-600 text-white text-xs rounded-full flex items-center justify-center",children:Object.keys(g).filter(j=>g[j]).length})]}),r.jsx("button",{onClick:G,className:"btn-primary",children:"+ Novo Lead"})]})]}),r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx("span",{className:"text-sm text-gray-600 mr-2",children:"Visualiza√ß√£o:"}),r.jsxs("div",{className:"flex bg-gray-100 rounded-lg p-1 gap-1",children:[r.jsxs("button",{onClick:()=>x("kanban"),className:`flex items-center gap-2 px-3 py-2 rounded-md text-sm font-medium transition-colors ${b==="kanban"?"bg-white text-primary-600 shadow-sm":"text-gray-600 hover:text-gray-900"}`,children:[r.jsx(Xn,{size:16}),"Kanban"]}),r.jsxs("button",{onClick:()=>x("list"),className:`flex items-center gap-2 px-3 py-2 rounded-md text-sm font-medium transition-colors ${b==="list"?"bg-white text-primary-600 shadow-sm":"text-gray-600 hover:text-gray-900"}`,children:[r.jsx(Qn,{size:16}),"Lista"]}),r.jsxs("button",{onClick:()=>x("grid"),className:`flex items-center gap-2 px-3 py-2 rounded-md text-sm font-medium transition-colors ${b==="grid"?"bg-white text-primary-600 shadow-sm":"text-gray-600 hover:text-gray-900"}`,children:[r.jsx(Kn,{size:16}),"Grade"]}),r.jsxs("button",{onClick:()=>x("timeline"),className:`flex items-center gap-2 px-3 py-2 rounded-md text-sm font-medium transition-colors ${b==="timeline"?"bg-white text-primary-600 shadow-sm":"text-gray-600 hover:text-gray-900"}`,children:[r.jsx(Qe,{size:16}),"Timeline"]}),r.jsxs("button",{onClick:()=>x("division"),className:`flex items-center gap-2 px-3 py-2 rounded-md text-sm font-medium transition-colors ${b==="division"?"bg-white text-primary-600 shadow-sm":"text-gray-600 hover:text-gray-900"}`,children:[r.jsx(Gn,{size:16}),"Divis√£o"]})]})]})]}),b==="kanban"?r.jsxs(Lc,{sensors:A,collisionDetection:Wi,onDragStart:se,onDragEnd:qe,children:[V(),r.jsx(Zc,{children:v?r.jsx(jr,{lead:v,formatCurrency:w,onClick:()=>{}}):null})]}):r.jsx("div",{className:"flex-1 overflow-y-auto",children:V()}),f&&r.jsx(Dr,{isOpen:f,onClose:$,title:y?"Editar Lead":"Novo Lead",size:"lg",children:r.jsx(yi,{children:n&&r.jsx(pi,{lead:y,stages:n.stages||[],onSubmit:We,onClose:$})})}),r.jsx(xi,{isOpen:p,onClose:()=>S(!1),stages:(n==null?void 0:n.stages)||[],filters:g,onApplyFilters:W,onClearFilters:Q})]})}class ul{async getConversations(e){const s=new URLSearchParams;e!=null&&e.status&&s.append("status",e.status),e!=null&&e.assignedUserId&&s.append("assignedUserId",e.assignedUserId),e!=null&&e.search&&s.append("search",e.search),e!=null&&e.tags&&s.append("tags",e.tags.join(",")),e!=null&&e.unreadOnly&&s.append("unreadOnly","true");const{data:n}=await k.get(`/chat/conversations?${s.toString()}`);return n}async getConversation(e){const{data:s}=await k.get(`/chat/conversations/${e}`);return s}async createConversation(e){const{data:s}=await k.post("/chat/conversations",e);return s}async updateConversation(e,s){const{data:n}=await k.put(`/chat/conversations/${e}`,s);return n}async markAsRead(e){const{data:s}=await k.post(`/chat/conversations/${e}/mark-read`);return s}async markAsUnread(e){const{data:s}=await k.post(`/chat/conversations/${e}/mark-unread`);return s}async assignConversation(e,s){const{data:n}=await k.post(`/chat/conversations/${e}/assign`,{userId:s});return n}async addTag(e,s){const{data:n}=await k.post(`/chat/conversations/${e}/tags`,{tagName:s});return n}async removeTag(e,s){const{data:n}=await k.delete(`/chat/conversations/${e}/tags`,{data:{tagName:s}});return n}async getMessages(e){const{data:s}=await k.get(`/chat/conversations/${e}/messages`);return s}async sendMessage(e,s){const{data:n}=await k.post(`/chat/conversations/${e}/messages`,s);return n}async deleteMessage(e){await k.delete(`/chat/messages/${e}`)}async getTags(){const{data:e}=await k.get("/chat/tags");return e}async createTag(e){const{data:s}=await k.post("/chat/tags",e);return s}async updateTag(e,s){const{data:n}=await k.put(`/chat/tags/${e}`,s);return n}async deleteTag(e){await k.delete(`/chat/tags/${e}`)}async getQuickReplies(e){const s=new URLSearchParams;e!=null&&e.category&&s.append("category",e.category),e!=null&&e.search&&s.append("search",e.search);const{data:n}=await k.get(`/chat/quick-replies?${s.toString()}`);return n}async createQuickReply(e){const{data:s}=await k.post("/chat/quick-replies",e);return s}async updateQuickReply(e,s){const{data:n}=await k.put(`/chat/quick-replies/${e}`,s);return n}async deleteQuickReply(e){await k.delete(`/chat/quick-replies/${e}`)}async getStats(){const{data:e}=await k.get("/chat/stats");return e}}const nt=new ul,je=Object.create(null);je.open="0";je.close="1";je.ping="2";je.pong="3";je.message="4";je.upgrade="5";je.noop="6";const Rt=Object.create(null);Object.keys(je).forEach(t=>{Rt[je[t]]=t});const ys={type:"error",data:"parser error"},dn=typeof Blob=="function"||typeof Blob<"u"&&Object.prototype.toString.call(Blob)==="[object BlobConstructor]",un=typeof ArrayBuffer=="function",hn=t=>typeof ArrayBuffer.isView=="function"?ArrayBuffer.isView(t):t&&t.buffer instanceof ArrayBuffer,Ds=({type:t,data:e},s,n)=>dn&&e instanceof Blob?s?n(e):Nr(e,n):un&&(e instanceof ArrayBuffer||hn(e))?s?n(e):Nr(new Blob([e]),n):n(je[t]+(e||"")),Nr=(t,e)=>{const s=new FileReader;return s.onload=function(){const n=s.result.split(",")[1];e("b"+(n||""))},s.readAsDataURL(t)};function kr(t){return t instanceof Uint8Array?t:t instanceof ArrayBuffer?new Uint8Array(t):new Uint8Array(t.buffer,t.byteOffset,t.byteLength)}let os;function hl(t,e){if(dn&&t.data instanceof Blob)return t.data.arrayBuffer().then(kr).then(e);if(un&&(t.data instanceof ArrayBuffer||hn(t.data)))return e(kr(t.data));Ds(t,!1,s=>{os||(os=new TextEncoder),e(os.encode(s))})}const Cr="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",ot=typeof Uint8Array>"u"?[]:new Uint8Array(256);for(let t=0;t<Cr.length;t++)ot[Cr.charCodeAt(t)]=t;const ml=t=>{let e=t.length*.75,s=t.length,n,a=0,o,i,c,l;t[t.length-1]==="="&&(e--,t[t.length-2]==="="&&e--);const h=new ArrayBuffer(e),d=new Uint8Array(h);for(n=0;n<s;n+=4)o=ot[t.charCodeAt(n)],i=ot[t.charCodeAt(n+1)],c=ot[t.charCodeAt(n+2)],l=ot[t.charCodeAt(n+3)],d[a++]=o<<2|i>>4,d[a++]=(i&15)<<4|c>>2,d[a++]=(c&3)<<6|l&63;return h},fl=typeof ArrayBuffer=="function",Ps=(t,e)=>{if(typeof t!="string")return{type:"message",data:mn(t,e)};const s=t.charAt(0);return s==="b"?{type:"message",data:gl(t.substring(1),e)}:Rt[s]?t.length>1?{type:Rt[s],data:t.substring(1)}:{type:Rt[s]}:ys},gl=(t,e)=>{if(fl){const s=ml(t);return mn(s,e)}else return{base64:!0,data:t}},mn=(t,e)=>{switch(e){case"blob":return t instanceof Blob?t:new Blob([t]);case"arraybuffer":default:return t instanceof ArrayBuffer?t:t.buffer}},fn="",pl=(t,e)=>{const s=t.length,n=new Array(s);let a=0;t.forEach((o,i)=>{Ds(o,!1,c=>{n[i]=c,++a===s&&e(n.join(fn))})})},xl=(t,e)=>{const s=t.split(fn),n=[];for(let a=0;a<s.length;a++){const o=Ps(s[a],e);if(n.push(o),o.type==="error")break}return n};function yl(){return new TransformStream({transform(t,e){hl(t,s=>{const n=s.length;let a;if(n<126)a=new Uint8Array(1),new DataView(a.buffer).setUint8(0,n);else if(n<65536){a=new Uint8Array(3);const o=new DataView(a.buffer);o.setUint8(0,126),o.setUint16(1,n)}else{a=new Uint8Array(9);const o=new DataView(a.buffer);o.setUint8(0,127),o.setBigUint64(1,BigInt(n))}t.data&&typeof t.data!="string"&&(a[0]|=128),e.enqueue(a),e.enqueue(s)})}})}let is;function Ct(t){return t.reduce((e,s)=>e+s.length,0)}function St(t,e){if(t[0].length===e)return t.shift();const s=new Uint8Array(e);let n=0;for(let a=0;a<e;a++)s[a]=t[0][n++],n===t[0].length&&(t.shift(),n=0);return t.length&&n<t[0].length&&(t[0]=t[0].slice(n)),s}function bl(t,e){is||(is=new TextDecoder);const s=[];let n=0,a=-1,o=!1;return new TransformStream({transform(i,c){for(s.push(i);;){if(n===0){if(Ct(s)<1)break;const l=St(s,1);o=(l[0]&128)===128,a=l[0]&127,a<126?n=3:a===126?n=1:n=2}else if(n===1){if(Ct(s)<2)break;const l=St(s,2);a=new DataView(l.buffer,l.byteOffset,l.length).getUint16(0),n=3}else if(n===2){if(Ct(s)<8)break;const l=St(s,8),h=new DataView(l.buffer,l.byteOffset,l.length),d=h.getUint32(0);if(d>Math.pow(2,21)-1){c.enqueue(ys);break}a=d*Math.pow(2,32)+h.getUint32(4),n=3}else{if(Ct(s)<a)break;const l=St(s,a);c.enqueue(Ps(o?l:is.decode(l),e)),n=0}if(a===0||a>t){c.enqueue(ys);break}}}})}const gn=4;function Y(t){if(t)return vl(t)}function vl(t){for(var e in Y.prototype)t[e]=Y.prototype[e];return t}Y.prototype.on=Y.prototype.addEventListener=function(t,e){return this._callbacks=this._callbacks||{},(this._callbacks["$"+t]=this._callbacks["$"+t]||[]).push(e),this};Y.prototype.once=function(t,e){function s(){this.off(t,s),e.apply(this,arguments)}return s.fn=e,this.on(t,s),this};Y.prototype.off=Y.prototype.removeListener=Y.prototype.removeAllListeners=Y.prototype.removeEventListener=function(t,e){if(this._callbacks=this._callbacks||{},arguments.length==0)return this._callbacks={},this;var s=this._callbacks["$"+t];if(!s)return this;if(arguments.length==1)return delete this._callbacks["$"+t],this;for(var n,a=0;a<s.length;a++)if(n=s[a],n===e||n.fn===e){s.splice(a,1);break}return s.length===0&&delete this._callbacks["$"+t],this};Y.prototype.emit=function(t){this._callbacks=this._callbacks||{};for(var e=new Array(arguments.length-1),s=this._callbacks["$"+t],n=1;n<arguments.length;n++)e[n-1]=arguments[n];if(s){s=s.slice(0);for(var n=0,a=s.length;n<a;++n)s[n].apply(this,e)}return this};Y.prototype.emitReserved=Y.prototype.emit;Y.prototype.listeners=function(t){return this._callbacks=this._callbacks||{},this._callbacks["$"+t]||[]};Y.prototype.hasListeners=function(t){return!!this.listeners(t).length};const Kt=typeof Promise=="function"&&typeof Promise.resolve=="function"?e=>Promise.resolve().then(e):(e,s)=>s(e,0),he=typeof self<"u"?self:typeof window<"u"?window:Function("return this")(),wl="arraybuffer";function pn(t,...e){return e.reduce((s,n)=>(t.hasOwnProperty(n)&&(s[n]=t[n]),s),{})}const jl=he.setTimeout,Nl=he.clearTimeout;function Gt(t,e){e.useNativeTimers?(t.setTimeoutFn=jl.bind(he),t.clearTimeoutFn=Nl.bind(he)):(t.setTimeoutFn=he.setTimeout.bind(he),t.clearTimeoutFn=he.clearTimeout.bind(he))}const kl=1.33;function Cl(t){return typeof t=="string"?Sl(t):Math.ceil((t.byteLength||t.size)*kl)}function Sl(t){let e=0,s=0;for(let n=0,a=t.length;n<a;n++)e=t.charCodeAt(n),e<128?s+=1:e<2048?s+=2:e<55296||e>=57344?s+=3:(n++,s+=4);return s}function xn(){return Date.now().toString(36).substring(3)+Math.random().toString(36).substring(2,5)}function El(t){let e="";for(let s in t)t.hasOwnProperty(s)&&(e.length&&(e+="&"),e+=encodeURIComponent(s)+"="+encodeURIComponent(t[s]));return e}function Al(t){let e={},s=t.split("&");for(let n=0,a=s.length;n<a;n++){let o=s[n].split("=");e[decodeURIComponent(o[0])]=decodeURIComponent(o[1])}return e}class Rl extends Error{constructor(e,s,n){super(e),this.description=s,this.context=n,this.type="TransportError"}}class Is extends Y{constructor(e){super(),this.writable=!1,Gt(this,e),this.opts=e,this.query=e.query,this.socket=e.socket,this.supportsBinary=!e.forceBase64}onError(e,s,n){return super.emitReserved("error",new Rl(e,s,n)),this}open(){return this.readyState="opening",this.doOpen(),this}close(){return(this.readyState==="opening"||this.readyState==="open")&&(this.doClose(),this.onClose()),this}send(e){this.readyState==="open"&&this.write(e)}onOpen(){this.readyState="open",this.writable=!0,super.emitReserved("open")}onData(e){const s=Ps(e,this.socket.binaryType);this.onPacket(s)}onPacket(e){super.emitReserved("packet",e)}onClose(e){this.readyState="closed",super.emitReserved("close",e)}pause(e){}createUri(e,s={}){return e+"://"+this._hostname()+this._port()+this.opts.path+this._query(s)}_hostname(){const e=this.opts.hostname;return e.indexOf(":")===-1?e:"["+e+"]"}_port(){return this.opts.port&&(this.opts.secure&&+(this.opts.port!==443)||!this.opts.secure&&Number(this.opts.port)!==80)?":"+this.opts.port:""}_query(e){const s=El(e);return s.length?"?"+s:""}}class Tl extends Is{constructor(){super(...arguments),this._polling=!1}get name(){return"polling"}doOpen(){this._poll()}pause(e){this.readyState="pausing";const s=()=>{this.readyState="paused",e()};if(this._polling||!this.writable){let n=0;this._polling&&(n++,this.once("pollComplete",function(){--n||s()})),this.writable||(n++,this.once("drain",function(){--n||s()}))}else s()}_poll(){this._polling=!0,this.doPoll(),this.emitReserved("poll")}onData(e){const s=n=>{if(this.readyState==="opening"&&n.type==="open"&&this.onOpen(),n.type==="close")return this.onClose({description:"transport closed by the server"}),!1;this.onPacket(n)};xl(e,this.socket.binaryType).forEach(s),this.readyState!=="closed"&&(this._polling=!1,this.emitReserved("pollComplete"),this.readyState==="open"&&this._poll())}doClose(){const e=()=>{this.write([{type:"close"}])};this.readyState==="open"?e():this.once("open",e)}write(e){this.writable=!1,pl(e,s=>{this.doWrite(s,()=>{this.writable=!0,this.emitReserved("drain")})})}uri(){const e=this.opts.secure?"https":"http",s=this.query||{};return this.opts.timestampRequests!==!1&&(s[this.opts.timestampParam]=xn()),!this.supportsBinary&&!s.sid&&(s.b64=1),this.createUri(e,s)}}let yn=!1;try{yn=typeof XMLHttpRequest<"u"&&"withCredentials"in new XMLHttpRequest}catch{}const _l=yn;function Ol(){}class Ll extends Tl{constructor(e){if(super(e),typeof location<"u"){const s=location.protocol==="https:";let n=location.port;n||(n=s?"443":"80"),this.xd=typeof location<"u"&&e.hostname!==location.hostname||n!==e.port}}doWrite(e,s){const n=this.request({method:"POST",data:e});n.on("success",s),n.on("error",(a,o)=>{this.onError("xhr post error",a,o)})}doPoll(){const e=this.request();e.on("data",this.onData.bind(this)),e.on("error",(s,n)=>{this.onError("xhr poll error",s,n)}),this.pollXhr=e}}class we extends Y{constructor(e,s,n){super(),this.createRequest=e,Gt(this,n),this._opts=n,this._method=n.method||"GET",this._uri=s,this._data=n.data!==void 0?n.data:null,this._create()}_create(){var e;const s=pn(this._opts,"agent","pfx","key","passphrase","cert","ca","ciphers","rejectUnauthorized","autoUnref");s.xdomain=!!this._opts.xd;const n=this._xhr=this.createRequest(s);try{n.open(this._method,this._uri,!0);try{if(this._opts.extraHeaders){n.setDisableHeaderCheck&&n.setDisableHeaderCheck(!0);for(let a in this._opts.extraHeaders)this._opts.extraHeaders.hasOwnProperty(a)&&n.setRequestHeader(a,this._opts.extraHeaders[a])}}catch{}if(this._method==="POST")try{n.setRequestHeader("Content-type","text/plain;charset=UTF-8")}catch{}try{n.setRequestHeader("Accept","*/*")}catch{}(e=this._opts.cookieJar)===null||e===void 0||e.addCookies(n),"withCredentials"in n&&(n.withCredentials=this._opts.withCredentials),this._opts.requestTimeout&&(n.timeout=this._opts.requestTimeout),n.onreadystatechange=()=>{var a;n.readyState===3&&((a=this._opts.cookieJar)===null||a===void 0||a.parseCookies(n.getResponseHeader("set-cookie"))),n.readyState===4&&(n.status===200||n.status===1223?this._onLoad():this.setTimeoutFn(()=>{this._onError(typeof n.status=="number"?n.status:0)},0))},n.send(this._data)}catch(a){this.setTimeoutFn(()=>{this._onError(a)},0);return}typeof document<"u"&&(this._index=we.requestsCount++,we.requests[this._index]=this)}_onError(e){this.emitReserved("error",e,this._xhr),this._cleanup(!0)}_cleanup(e){if(!(typeof this._xhr>"u"||this._xhr===null)){if(this._xhr.onreadystatechange=Ol,e)try{this._xhr.abort()}catch{}typeof document<"u"&&delete we.requests[this._index],this._xhr=null}}_onLoad(){const e=this._xhr.responseText;e!==null&&(this.emitReserved("data",e),this.emitReserved("success"),this._cleanup())}abort(){this._cleanup()}}we.requestsCount=0;we.requests={};if(typeof document<"u"){if(typeof attachEvent=="function")attachEvent("onunload",Sr);else if(typeof addEventListener=="function"){const t="onpagehide"in he?"pagehide":"unload";addEventListener(t,Sr,!1)}}function Sr(){for(let t in we.requests)we.requests.hasOwnProperty(t)&&we.requests[t].abort()}const Ml=function(){const t=bn({xdomain:!1});return t&&t.responseType!==null}();class Dl extends Ll{constructor(e){super(e);const s=e&&e.forceBase64;this.supportsBinary=Ml&&!s}request(e={}){return Object.assign(e,{xd:this.xd},this.opts),new we(bn,this.uri(),e)}}function bn(t){const e=t.xdomain;try{if(typeof XMLHttpRequest<"u"&&(!e||_l))return new XMLHttpRequest}catch{}if(!e)try{return new he[["Active"].concat("Object").join("X")]("Microsoft.XMLHTTP")}catch{}}const vn=typeof navigator<"u"&&typeof navigator.product=="string"&&navigator.product.toLowerCase()==="reactnative";class Pl extends Is{get name(){return"websocket"}doOpen(){const e=this.uri(),s=this.opts.protocols,n=vn?{}:pn(this.opts,"agent","perMessageDeflate","pfx","key","passphrase","cert","ca","ciphers","rejectUnauthorized","localAddress","protocolVersion","origin","maxPayload","family","checkServerIdentity");this.opts.extraHeaders&&(n.headers=this.opts.extraHeaders);try{this.ws=this.createSocket(e,s,n)}catch(a){return this.emitReserved("error",a)}this.ws.binaryType=this.socket.binaryType,this.addEventListeners()}addEventListeners(){this.ws.onopen=()=>{this.opts.autoUnref&&this.ws._socket.unref(),this.onOpen()},this.ws.onclose=e=>this.onClose({description:"websocket connection closed",context:e}),this.ws.onmessage=e=>this.onData(e.data),this.ws.onerror=e=>this.onError("websocket error",e)}write(e){this.writable=!1;for(let s=0;s<e.length;s++){const n=e[s],a=s===e.length-1;Ds(n,this.supportsBinary,o=>{try{this.doWrite(n,o)}catch{}a&&Kt(()=>{this.writable=!0,this.emitReserved("drain")},this.setTimeoutFn)})}}doClose(){typeof this.ws<"u"&&(this.ws.onerror=()=>{},this.ws.close(),this.ws=null)}uri(){const e=this.opts.secure?"wss":"ws",s=this.query||{};return this.opts.timestampRequests&&(s[this.opts.timestampParam]=xn()),this.supportsBinary||(s.b64=1),this.createUri(e,s)}}const cs=he.WebSocket||he.MozWebSocket;class Il extends Pl{createSocket(e,s,n){return vn?new cs(e,s,n):s?new cs(e,s):new cs(e)}doWrite(e,s){this.ws.send(s)}}class Bl extends Is{get name(){return"webtransport"}doOpen(){try{this._transport=new WebTransport(this.createUri("https"),this.opts.transportOptions[this.name])}catch(e){return this.emitReserved("error",e)}this._transport.closed.then(()=>{this.onClose()}).catch(e=>{this.onError("webtransport error",e)}),this._transport.ready.then(()=>{this._transport.createBidirectionalStream().then(e=>{const s=bl(Number.MAX_SAFE_INTEGER,this.socket.binaryType),n=e.readable.pipeThrough(s).getReader(),a=yl();a.readable.pipeTo(e.writable),this._writer=a.writable.getWriter();const o=()=>{n.read().then(({done:c,value:l})=>{c||(this.onPacket(l),o())}).catch(c=>{})};o();const i={type:"open"};this.query.sid&&(i.data=`{"sid":"${this.query.sid}"}`),this._writer.write(i).then(()=>this.onOpen())})})}write(e){this.writable=!1;for(let s=0;s<e.length;s++){const n=e[s],a=s===e.length-1;this._writer.write(n).then(()=>{a&&Kt(()=>{this.writable=!0,this.emitReserved("drain")},this.setTimeoutFn)})}}doClose(){var e;(e=this._transport)===null||e===void 0||e.close()}}const Wl={websocket:Il,webtransport:Bl,polling:Dl},ql=/^(?:(?![^:@\/?#]+:[^:@\/]*@)(http|https|ws|wss):\/\/)?((?:(([^:@\/?#]*)(?::([^:@\/?#]*))?)?@)?((?:[a-f0-9]{0,4}:){2,7}[a-f0-9]{0,4}|[^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/,Fl=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"];function bs(t){if(t.length>8e3)throw"URI too long";const e=t,s=t.indexOf("["),n=t.indexOf("]");s!=-1&&n!=-1&&(t=t.substring(0,s)+t.substring(s,n).replace(/:/g,";")+t.substring(n,t.length));let a=ql.exec(t||""),o={},i=14;for(;i--;)o[Fl[i]]=a[i]||"";return s!=-1&&n!=-1&&(o.source=e,o.host=o.host.substring(1,o.host.length-1).replace(/;/g,":"),o.authority=o.authority.replace("[","").replace("]","").replace(/;/g,":"),o.ipv6uri=!0),o.pathNames=$l(o,o.path),o.queryKey=Vl(o,o.query),o}function $l(t,e){const s=/\/{2,9}/g,n=e.replace(s,"/").split("/");return(e.slice(0,1)=="/"||e.length===0)&&n.splice(0,1),e.slice(-1)=="/"&&n.splice(n.length-1,1),n}function Vl(t,e){const s={};return e.replace(/(?:^|&)([^&=]*)=?([^&]*)/g,function(n,a,o){a&&(s[a]=o)}),s}const vs=typeof addEventListener=="function"&&typeof removeEventListener=="function",Tt=[];vs&&addEventListener("offline",()=>{Tt.forEach(t=>t())},!1);class Le extends Y{constructor(e,s){if(super(),this.binaryType=wl,this.writeBuffer=[],this._prevBufferLen=0,this._pingInterval=-1,this._pingTimeout=-1,this._maxPayload=-1,this._pingTimeoutTime=1/0,e&&typeof e=="object"&&(s=e,e=null),e){const n=bs(e);s.hostname=n.host,s.secure=n.protocol==="https"||n.protocol==="wss",s.port=n.port,n.query&&(s.query=n.query)}else s.host&&(s.hostname=bs(s.host).host);Gt(this,s),this.secure=s.secure!=null?s.secure:typeof location<"u"&&location.protocol==="https:",s.hostname&&!s.port&&(s.port=this.secure?"443":"80"),this.hostname=s.hostname||(typeof location<"u"?location.hostname:"localhost"),this.port=s.port||(typeof location<"u"&&location.port?location.port:this.secure?"443":"80"),this.transports=[],this._transportsByName={},s.transports.forEach(n=>{const a=n.prototype.name;this.transports.push(a),this._transportsByName[a]=n}),this.opts=Object.assign({path:"/engine.io",agent:!1,withCredentials:!1,upgrade:!0,timestampParam:"t",rememberUpgrade:!1,addTrailingSlash:!0,rejectUnauthorized:!0,perMessageDeflate:{threshold:1024},transportOptions:{},closeOnBeforeunload:!1},s),this.opts.path=this.opts.path.replace(/\/$/,"")+(this.opts.addTrailingSlash?"/":""),typeof this.opts.query=="string"&&(this.opts.query=Al(this.opts.query)),vs&&(this.opts.closeOnBeforeunload&&(this._beforeunloadEventListener=()=>{this.transport&&(this.transport.removeAllListeners(),this.transport.close())},addEventListener("beforeunload",this._beforeunloadEventListener,!1)),this.hostname!=="localhost"&&(this._offlineEventListener=()=>{this._onClose("transport close",{description:"network connection lost"})},Tt.push(this._offlineEventListener))),this.opts.withCredentials&&(this._cookieJar=void 0),this._open()}createTransport(e){const s=Object.assign({},this.opts.query);s.EIO=gn,s.transport=e,this.id&&(s.sid=this.id);const n=Object.assign({},this.opts,{query:s,socket:this,hostname:this.hostname,secure:this.secure,port:this.port},this.opts.transportOptions[e]);return new this._transportsByName[e](n)}_open(){if(this.transports.length===0){this.setTimeoutFn(()=>{this.emitReserved("error","No transports available")},0);return}const e=this.opts.rememberUpgrade&&Le.priorWebsocketSuccess&&this.transports.indexOf("websocket")!==-1?"websocket":this.transports[0];this.readyState="opening";const s=this.createTransport(e);s.open(),this.setTransport(s)}setTransport(e){this.transport&&this.transport.removeAllListeners(),this.transport=e,e.on("drain",this._onDrain.bind(this)).on("packet",this._onPacket.bind(this)).on("error",this._onError.bind(this)).on("close",s=>this._onClose("transport close",s))}onOpen(){this.readyState="open",Le.priorWebsocketSuccess=this.transport.name==="websocket",this.emitReserved("open"),this.flush()}_onPacket(e){if(this.readyState==="opening"||this.readyState==="open"||this.readyState==="closing")switch(this.emitReserved("packet",e),this.emitReserved("heartbeat"),e.type){case"open":this.onHandshake(JSON.parse(e.data));break;case"ping":this._sendPacket("pong"),this.emitReserved("ping"),this.emitReserved("pong"),this._resetPingTimeout();break;case"error":const s=new Error("server error");s.code=e.data,this._onError(s);break;case"message":this.emitReserved("data",e.data),this.emitReserved("message",e.data);break}}onHandshake(e){this.emitReserved("handshake",e),this.id=e.sid,this.transport.query.sid=e.sid,this._pingInterval=e.pingInterval,this._pingTimeout=e.pingTimeout,this._maxPayload=e.maxPayload,this.onOpen(),this.readyState!=="closed"&&this._resetPingTimeout()}_resetPingTimeout(){this.clearTimeoutFn(this._pingTimeoutTimer);const e=this._pingInterval+this._pingTimeout;this._pingTimeoutTime=Date.now()+e,this._pingTimeoutTimer=this.setTimeoutFn(()=>{this._onClose("ping timeout")},e),this.opts.autoUnref&&this._pingTimeoutTimer.unref()}_onDrain(){this.writeBuffer.splice(0,this._prevBufferLen),this._prevBufferLen=0,this.writeBuffer.length===0?this.emitReserved("drain"):this.flush()}flush(){if(this.readyState!=="closed"&&this.transport.writable&&!this.upgrading&&this.writeBuffer.length){const e=this._getWritablePackets();this.transport.send(e),this._prevBufferLen=e.length,this.emitReserved("flush")}}_getWritablePackets(){if(!(this._maxPayload&&this.transport.name==="polling"&&this.writeBuffer.length>1))return this.writeBuffer;let s=1;for(let n=0;n<this.writeBuffer.length;n++){const a=this.writeBuffer[n].data;if(a&&(s+=Cl(a)),n>0&&s>this._maxPayload)return this.writeBuffer.slice(0,n);s+=2}return this.writeBuffer}_hasPingExpired(){if(!this._pingTimeoutTime)return!0;const e=Date.now()>this._pingTimeoutTime;return e&&(this._pingTimeoutTime=0,Kt(()=>{this._onClose("ping timeout")},this.setTimeoutFn)),e}write(e,s,n){return this._sendPacket("message",e,s,n),this}send(e,s,n){return this._sendPacket("message",e,s,n),this}_sendPacket(e,s,n,a){if(typeof s=="function"&&(a=s,s=void 0),typeof n=="function"&&(a=n,n=null),this.readyState==="closing"||this.readyState==="closed")return;n=n||{},n.compress=n.compress!==!1;const o={type:e,data:s,options:n};this.emitReserved("packetCreate",o),this.writeBuffer.push(o),a&&this.once("flush",a),this.flush()}close(){const e=()=>{this._onClose("forced close"),this.transport.close()},s=()=>{this.off("upgrade",s),this.off("upgradeError",s),e()},n=()=>{this.once("upgrade",s),this.once("upgradeError",s)};return(this.readyState==="opening"||this.readyState==="open")&&(this.readyState="closing",this.writeBuffer.length?this.once("drain",()=>{this.upgrading?n():e()}):this.upgrading?n():e()),this}_onError(e){if(Le.priorWebsocketSuccess=!1,this.opts.tryAllTransports&&this.transports.length>1&&this.readyState==="opening")return this.transports.shift(),this._open();this.emitReserved("error",e),this._onClose("transport error",e)}_onClose(e,s){if(this.readyState==="opening"||this.readyState==="open"||this.readyState==="closing"){if(this.clearTimeoutFn(this._pingTimeoutTimer),this.transport.removeAllListeners("close"),this.transport.close(),this.transport.removeAllListeners(),vs&&(this._beforeunloadEventListener&&removeEventListener("beforeunload",this._beforeunloadEventListener,!1),this._offlineEventListener)){const n=Tt.indexOf(this._offlineEventListener);n!==-1&&Tt.splice(n,1)}this.readyState="closed",this.id=null,this.emitReserved("close",e,s),this.writeBuffer=[],this._prevBufferLen=0}}}Le.protocol=gn;class zl extends Le{constructor(){super(...arguments),this._upgrades=[]}onOpen(){if(super.onOpen(),this.readyState==="open"&&this.opts.upgrade)for(let e=0;e<this._upgrades.length;e++)this._probe(this._upgrades[e])}_probe(e){let s=this.createTransport(e),n=!1;Le.priorWebsocketSuccess=!1;const a=()=>{n||(s.send([{type:"ping",data:"probe"}]),s.once("packet",f=>{if(!n)if(f.type==="pong"&&f.data==="probe"){if(this.upgrading=!0,this.emitReserved("upgrading",s),!s)return;Le.priorWebsocketSuccess=s.name==="websocket",this.transport.pause(()=>{n||this.readyState!=="closed"&&(d(),this.setTransport(s),s.send([{type:"upgrade"}]),this.emitReserved("upgrade",s),s=null,this.upgrading=!1,this.flush())})}else{const m=new Error("probe error");m.transport=s.name,this.emitReserved("upgradeError",m)}}))};function o(){n||(n=!0,d(),s.close(),s=null)}const i=f=>{const m=new Error("probe error: "+f);m.transport=s.name,o(),this.emitReserved("upgradeError",m)};function c(){i("transport closed")}function l(){i("socket closed")}function h(f){s&&f.name!==s.name&&o()}const d=()=>{s.removeListener("open",a),s.removeListener("error",i),s.removeListener("close",c),this.off("close",l),this.off("upgrading",h)};s.once("open",a),s.once("error",i),s.once("close",c),this.once("close",l),this.once("upgrading",h),this._upgrades.indexOf("webtransport")!==-1&&e!=="webtransport"?this.setTimeoutFn(()=>{n||s.open()},200):s.open()}onHandshake(e){this._upgrades=this._filterUpgrades(e.upgrades),super.onHandshake(e)}_filterUpgrades(e){const s=[];for(let n=0;n<e.length;n++)~this.transports.indexOf(e[n])&&s.push(e[n]);return s}}let Yl=class extends zl{constructor(e,s={}){const n=typeof e=="object"?e:s;(!n.transports||n.transports&&typeof n.transports[0]=="string")&&(n.transports=(n.transports||["polling","websocket","webtransport"]).map(a=>Wl[a]).filter(a=>!!a)),super(e,n)}};function Ul(t,e="",s){let n=t;s=s||typeof location<"u"&&location,t==null&&(t=s.protocol+"//"+s.host),typeof t=="string"&&(t.charAt(0)==="/"&&(t.charAt(1)==="/"?t=s.protocol+t:t=s.host+t),/^(https?|wss?):\/\//.test(t)||(typeof s<"u"?t=s.protocol+"//"+t:t="https://"+t),n=bs(t)),n.port||(/^(http|ws)$/.test(n.protocol)?n.port="80":/^(http|ws)s$/.test(n.protocol)&&(n.port="443")),n.path=n.path||"/";const o=n.host.indexOf(":")!==-1?"["+n.host+"]":n.host;return n.id=n.protocol+"://"+o+":"+n.port+e,n.href=n.protocol+"://"+o+(s&&s.port===n.port?"":":"+n.port),n}const Hl=typeof ArrayBuffer=="function",Xl=t=>typeof ArrayBuffer.isView=="function"?ArrayBuffer.isView(t):t.buffer instanceof ArrayBuffer,wn=Object.prototype.toString,Ql=typeof Blob=="function"||typeof Blob<"u"&&wn.call(Blob)==="[object BlobConstructor]",Kl=typeof File=="function"||typeof File<"u"&&wn.call(File)==="[object FileConstructor]";function Bs(t){return Hl&&(t instanceof ArrayBuffer||Xl(t))||Ql&&t instanceof Blob||Kl&&t instanceof File}function _t(t,e){if(!t||typeof t!="object")return!1;if(Array.isArray(t)){for(let s=0,n=t.length;s<n;s++)if(_t(t[s]))return!0;return!1}if(Bs(t))return!0;if(t.toJSON&&typeof t.toJSON=="function"&&arguments.length===1)return _t(t.toJSON(),!0);for(const s in t)if(Object.prototype.hasOwnProperty.call(t,s)&&_t(t[s]))return!0;return!1}function Gl(t){const e=[],s=t.data,n=t;return n.data=ws(s,e),n.attachments=e.length,{packet:n,buffers:e}}function ws(t,e){if(!t)return t;if(Bs(t)){const s={_placeholder:!0,num:e.length};return e.push(t),s}else if(Array.isArray(t)){const s=new Array(t.length);for(let n=0;n<t.length;n++)s[n]=ws(t[n],e);return s}else if(typeof t=="object"&&!(t instanceof Date)){const s={};for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&(s[n]=ws(t[n],e));return s}return t}function Jl(t,e){return t.data=js(t.data,e),delete t.attachments,t}function js(t,e){if(!t)return t;if(t&&t._placeholder===!0){if(typeof t.num=="number"&&t.num>=0&&t.num<e.length)return e[t.num];throw new Error("illegal attachments")}else if(Array.isArray(t))for(let s=0;s<t.length;s++)t[s]=js(t[s],e);else if(typeof t=="object")for(const s in t)Object.prototype.hasOwnProperty.call(t,s)&&(t[s]=js(t[s],e));return t}const Zl=["connect","connect_error","disconnect","disconnecting","newListener","removeListener"],ed=5;var L;(function(t){t[t.CONNECT=0]="CONNECT",t[t.DISCONNECT=1]="DISCONNECT",t[t.EVENT=2]="EVENT",t[t.ACK=3]="ACK",t[t.CONNECT_ERROR=4]="CONNECT_ERROR",t[t.BINARY_EVENT=5]="BINARY_EVENT",t[t.BINARY_ACK=6]="BINARY_ACK"})(L||(L={}));class td{constructor(e){this.replacer=e}encode(e){return(e.type===L.EVENT||e.type===L.ACK)&&_t(e)?this.encodeAsBinary({type:e.type===L.EVENT?L.BINARY_EVENT:L.BINARY_ACK,nsp:e.nsp,data:e.data,id:e.id}):[this.encodeAsString(e)]}encodeAsString(e){let s=""+e.type;return(e.type===L.BINARY_EVENT||e.type===L.BINARY_ACK)&&(s+=e.attachments+"-"),e.nsp&&e.nsp!=="/"&&(s+=e.nsp+","),e.id!=null&&(s+=e.id),e.data!=null&&(s+=JSON.stringify(e.data,this.replacer)),s}encodeAsBinary(e){const s=Gl(e),n=this.encodeAsString(s.packet),a=s.buffers;return a.unshift(n),a}}function Er(t){return Object.prototype.toString.call(t)==="[object Object]"}class Ws extends Y{constructor(e){super(),this.reviver=e}add(e){let s;if(typeof e=="string"){if(this.reconstructor)throw new Error("got plaintext data when reconstructing a packet");s=this.decodeString(e);const n=s.type===L.BINARY_EVENT;n||s.type===L.BINARY_ACK?(s.type=n?L.EVENT:L.ACK,this.reconstructor=new sd(s),s.attachments===0&&super.emitReserved("decoded",s)):super.emitReserved("decoded",s)}else if(Bs(e)||e.base64)if(this.reconstructor)s=this.reconstructor.takeBinaryData(e),s&&(this.reconstructor=null,super.emitReserved("decoded",s));else throw new Error("got binary data when not reconstructing a packet");else throw new Error("Unknown type: "+e)}decodeString(e){let s=0;const n={type:Number(e.charAt(0))};if(L[n.type]===void 0)throw new Error("unknown packet type "+n.type);if(n.type===L.BINARY_EVENT||n.type===L.BINARY_ACK){const o=s+1;for(;e.charAt(++s)!=="-"&&s!=e.length;);const i=e.substring(o,s);if(i!=Number(i)||e.charAt(s)!=="-")throw new Error("Illegal attachments");n.attachments=Number(i)}if(e.charAt(s+1)==="/"){const o=s+1;for(;++s&&!(e.charAt(s)===","||s===e.length););n.nsp=e.substring(o,s)}else n.nsp="/";const a=e.charAt(s+1);if(a!==""&&Number(a)==a){const o=s+1;for(;++s;){const i=e.charAt(s);if(i==null||Number(i)!=i){--s;break}if(s===e.length)break}n.id=Number(e.substring(o,s+1))}if(e.charAt(++s)){const o=this.tryParse(e.substr(s));if(Ws.isPayloadValid(n.type,o))n.data=o;else throw new Error("invalid payload")}return n}tryParse(e){try{return JSON.parse(e,this.reviver)}catch{return!1}}static isPayloadValid(e,s){switch(e){case L.CONNECT:return Er(s);case L.DISCONNECT:return s===void 0;case L.CONNECT_ERROR:return typeof s=="string"||Er(s);case L.EVENT:case L.BINARY_EVENT:return Array.isArray(s)&&(typeof s[0]=="number"||typeof s[0]=="string"&&Zl.indexOf(s[0])===-1);case L.ACK:case L.BINARY_ACK:return Array.isArray(s)}}destroy(){this.reconstructor&&(this.reconstructor.finishedReconstruction(),this.reconstructor=null)}}class sd{constructor(e){this.packet=e,this.buffers=[],this.reconPack=e}takeBinaryData(e){if(this.buffers.push(e),this.buffers.length===this.reconPack.attachments){const s=Jl(this.reconPack,this.buffers);return this.finishedReconstruction(),s}return null}finishedReconstruction(){this.reconPack=null,this.buffers=[]}}const rd=Object.freeze(Object.defineProperty({__proto__:null,Decoder:Ws,Encoder:td,get PacketType(){return L},protocol:ed},Symbol.toStringTag,{value:"Module"}));function me(t,e,s){return t.on(e,s),function(){t.off(e,s)}}const nd=Object.freeze({connect:1,connect_error:1,disconnect:1,disconnecting:1,newListener:1,removeListener:1});class jn extends Y{constructor(e,s,n){super(),this.connected=!1,this.recovered=!1,this.receiveBuffer=[],this.sendBuffer=[],this._queue=[],this._queueSeq=0,this.ids=0,this.acks={},this.flags={},this.io=e,this.nsp=s,n&&n.auth&&(this.auth=n.auth),this._opts=Object.assign({},n),this.io._autoConnect&&this.open()}get disconnected(){return!this.connected}subEvents(){if(this.subs)return;const e=this.io;this.subs=[me(e,"open",this.onopen.bind(this)),me(e,"packet",this.onpacket.bind(this)),me(e,"error",this.onerror.bind(this)),me(e,"close",this.onclose.bind(this))]}get active(){return!!this.subs}connect(){return this.connected?this:(this.subEvents(),this.io._reconnecting||this.io.open(),this.io._readyState==="open"&&this.onopen(),this)}open(){return this.connect()}send(...e){return e.unshift("message"),this.emit.apply(this,e),this}emit(e,...s){var n,a,o;if(nd.hasOwnProperty(e))throw new Error('"'+e.toString()+'" is a reserved event name');if(s.unshift(e),this._opts.retries&&!this.flags.fromQueue&&!this.flags.volatile)return this._addToQueue(s),this;const i={type:L.EVENT,data:s};if(i.options={},i.options.compress=this.flags.compress!==!1,typeof s[s.length-1]=="function"){const d=this.ids++,f=s.pop();this._registerAckCallback(d,f),i.id=d}const c=(a=(n=this.io.engine)===null||n===void 0?void 0:n.transport)===null||a===void 0?void 0:a.writable,l=this.connected&&!(!((o=this.io.engine)===null||o===void 0)&&o._hasPingExpired());return this.flags.volatile&&!c||(l?(this.notifyOutgoingListeners(i),this.packet(i)):this.sendBuffer.push(i)),this.flags={},this}_registerAckCallback(e,s){var n;const a=(n=this.flags.timeout)!==null&&n!==void 0?n:this._opts.ackTimeout;if(a===void 0){this.acks[e]=s;return}const o=this.io.setTimeoutFn(()=>{delete this.acks[e];for(let c=0;c<this.sendBuffer.length;c++)this.sendBuffer[c].id===e&&this.sendBuffer.splice(c,1);s.call(this,new Error("operation has timed out"))},a),i=(...c)=>{this.io.clearTimeoutFn(o),s.apply(this,c)};i.withError=!0,this.acks[e]=i}emitWithAck(e,...s){return new Promise((n,a)=>{const o=(i,c)=>i?a(i):n(c);o.withError=!0,s.push(o),this.emit(e,...s)})}_addToQueue(e){let s;typeof e[e.length-1]=="function"&&(s=e.pop());const n={id:this._queueSeq++,tryCount:0,pending:!1,args:e,flags:Object.assign({fromQueue:!0},this.flags)};e.push((a,...o)=>n!==this._queue[0]?void 0:(a!==null?n.tryCount>this._opts.retries&&(this._queue.shift(),s&&s(a)):(this._queue.shift(),s&&s(null,...o)),n.pending=!1,this._drainQueue())),this._queue.push(n),this._drainQueue()}_drainQueue(e=!1){if(!this.connected||this._queue.length===0)return;const s=this._queue[0];s.pending&&!e||(s.pending=!0,s.tryCount++,this.flags=s.flags,this.emit.apply(this,s.args))}packet(e){e.nsp=this.nsp,this.io._packet(e)}onopen(){typeof this.auth=="function"?this.auth(e=>{this._sendConnectPacket(e)}):this._sendConnectPacket(this.auth)}_sendConnectPacket(e){this.packet({type:L.CONNECT,data:this._pid?Object.assign({pid:this._pid,offset:this._lastOffset},e):e})}onerror(e){this.connected||this.emitReserved("connect_error",e)}onclose(e,s){this.connected=!1,delete this.id,this.emitReserved("disconnect",e,s),this._clearAcks()}_clearAcks(){Object.keys(this.acks).forEach(e=>{if(!this.sendBuffer.some(n=>String(n.id)===e)){const n=this.acks[e];delete this.acks[e],n.withError&&n.call(this,new Error("socket has been disconnected"))}})}onpacket(e){if(e.nsp===this.nsp)switch(e.type){case L.CONNECT:e.data&&e.data.sid?this.onconnect(e.data.sid,e.data.pid):this.emitReserved("connect_error",new Error("It seems you are trying to reach a Socket.IO server in v2.x with a v3.x client, but they are not compatible (more information here: https://socket.io/docs/v3/migrating-from-2-x-to-3-0/)"));break;case L.EVENT:case L.BINARY_EVENT:this.onevent(e);break;case L.ACK:case L.BINARY_ACK:this.onack(e);break;case L.DISCONNECT:this.ondisconnect();break;case L.CONNECT_ERROR:this.destroy();const n=new Error(e.data.message);n.data=e.data.data,this.emitReserved("connect_error",n);break}}onevent(e){const s=e.data||[];e.id!=null&&s.push(this.ack(e.id)),this.connected?this.emitEvent(s):this.receiveBuffer.push(Object.freeze(s))}emitEvent(e){if(this._anyListeners&&this._anyListeners.length){const s=this._anyListeners.slice();for(const n of s)n.apply(this,e)}super.emit.apply(this,e),this._pid&&e.length&&typeof e[e.length-1]=="string"&&(this._lastOffset=e[e.length-1])}ack(e){const s=this;let n=!1;return function(...a){n||(n=!0,s.packet({type:L.ACK,id:e,data:a}))}}onack(e){const s=this.acks[e.id];typeof s=="function"&&(delete this.acks[e.id],s.withError&&e.data.unshift(null),s.apply(this,e.data))}onconnect(e,s){this.id=e,this.recovered=s&&this._pid===s,this._pid=s,this.connected=!0,this.emitBuffered(),this.emitReserved("connect"),this._drainQueue(!0)}emitBuffered(){this.receiveBuffer.forEach(e=>this.emitEvent(e)),this.receiveBuffer=[],this.sendBuffer.forEach(e=>{this.notifyOutgoingListeners(e),this.packet(e)}),this.sendBuffer=[]}ondisconnect(){this.destroy(),this.onclose("io server disconnect")}destroy(){this.subs&&(this.subs.forEach(e=>e()),this.subs=void 0),this.io._destroy(this)}disconnect(){return this.connected&&this.packet({type:L.DISCONNECT}),this.destroy(),this.connected&&this.onclose("io client disconnect"),this}close(){return this.disconnect()}compress(e){return this.flags.compress=e,this}get volatile(){return this.flags.volatile=!0,this}timeout(e){return this.flags.timeout=e,this}onAny(e){return this._anyListeners=this._anyListeners||[],this._anyListeners.push(e),this}prependAny(e){return this._anyListeners=this._anyListeners||[],this._anyListeners.unshift(e),this}offAny(e){if(!this._anyListeners)return this;if(e){const s=this._anyListeners;for(let n=0;n<s.length;n++)if(e===s[n])return s.splice(n,1),this}else this._anyListeners=[];return this}listenersAny(){return this._anyListeners||[]}onAnyOutgoing(e){return this._anyOutgoingListeners=this._anyOutgoingListeners||[],this._anyOutgoingListeners.push(e),this}prependAnyOutgoing(e){return this._anyOutgoingListeners=this._anyOutgoingListeners||[],this._anyOutgoingListeners.unshift(e),this}offAnyOutgoing(e){if(!this._anyOutgoingListeners)return this;if(e){const s=this._anyOutgoingListeners;for(let n=0;n<s.length;n++)if(e===s[n])return s.splice(n,1),this}else this._anyOutgoingListeners=[];return this}listenersAnyOutgoing(){return this._anyOutgoingListeners||[]}notifyOutgoingListeners(e){if(this._anyOutgoingListeners&&this._anyOutgoingListeners.length){const s=this._anyOutgoingListeners.slice();for(const n of s)n.apply(this,e.data)}}}function Ze(t){t=t||{},this.ms=t.min||100,this.max=t.max||1e4,this.factor=t.factor||2,this.jitter=t.jitter>0&&t.jitter<=1?t.jitter:0,this.attempts=0}Ze.prototype.duration=function(){var t=this.ms*Math.pow(this.factor,this.attempts++);if(this.jitter){var e=Math.random(),s=Math.floor(e*this.jitter*t);t=Math.floor(e*10)&1?t+s:t-s}return Math.min(t,this.max)|0};Ze.prototype.reset=function(){this.attempts=0};Ze.prototype.setMin=function(t){this.ms=t};Ze.prototype.setMax=function(t){this.max=t};Ze.prototype.setJitter=function(t){this.jitter=t};class Ns extends Y{constructor(e,s){var n;super(),this.nsps={},this.subs=[],e&&typeof e=="object"&&(s=e,e=void 0),s=s||{},s.path=s.path||"/socket.io",this.opts=s,Gt(this,s),this.reconnection(s.reconnection!==!1),this.reconnectionAttempts(s.reconnectionAttempts||1/0),this.reconnectionDelay(s.reconnectionDelay||1e3),this.reconnectionDelayMax(s.reconnectionDelayMax||5e3),this.randomizationFactor((n=s.randomizationFactor)!==null&&n!==void 0?n:.5),this.backoff=new Ze({min:this.reconnectionDelay(),max:this.reconnectionDelayMax(),jitter:this.randomizationFactor()}),this.timeout(s.timeout==null?2e4:s.timeout),this._readyState="closed",this.uri=e;const a=s.parser||rd;this.encoder=new a.Encoder,this.decoder=new a.Decoder,this._autoConnect=s.autoConnect!==!1,this._autoConnect&&this.open()}reconnection(e){return arguments.length?(this._reconnection=!!e,e||(this.skipReconnect=!0),this):this._reconnection}reconnectionAttempts(e){return e===void 0?this._reconnectionAttempts:(this._reconnectionAttempts=e,this)}reconnectionDelay(e){var s;return e===void 0?this._reconnectionDelay:(this._reconnectionDelay=e,(s=this.backoff)===null||s===void 0||s.setMin(e),this)}randomizationFactor(e){var s;return e===void 0?this._randomizationFactor:(this._randomizationFactor=e,(s=this.backoff)===null||s===void 0||s.setJitter(e),this)}reconnectionDelayMax(e){var s;return e===void 0?this._reconnectionDelayMax:(this._reconnectionDelayMax=e,(s=this.backoff)===null||s===void 0||s.setMax(e),this)}timeout(e){return arguments.length?(this._timeout=e,this):this._timeout}maybeReconnectOnOpen(){!this._reconnecting&&this._reconnection&&this.backoff.attempts===0&&this.reconnect()}open(e){if(~this._readyState.indexOf("open"))return this;this.engine=new Yl(this.uri,this.opts);const s=this.engine,n=this;this._readyState="opening",this.skipReconnect=!1;const a=me(s,"open",function(){n.onopen(),e&&e()}),o=c=>{this.cleanup(),this._readyState="closed",this.emitReserved("error",c),e?e(c):this.maybeReconnectOnOpen()},i=me(s,"error",o);if(this._timeout!==!1){const c=this._timeout,l=this.setTimeoutFn(()=>{a(),o(new Error("timeout")),s.close()},c);this.opts.autoUnref&&l.unref(),this.subs.push(()=>{this.clearTimeoutFn(l)})}return this.subs.push(a),this.subs.push(i),this}connect(e){return this.open(e)}onopen(){this.cleanup(),this._readyState="open",this.emitReserved("open");const e=this.engine;this.subs.push(me(e,"ping",this.onping.bind(this)),me(e,"data",this.ondata.bind(this)),me(e,"error",this.onerror.bind(this)),me(e,"close",this.onclose.bind(this)),me(this.decoder,"decoded",this.ondecoded.bind(this)))}onping(){this.emitReserved("ping")}ondata(e){try{this.decoder.add(e)}catch(s){this.onclose("parse error",s)}}ondecoded(e){Kt(()=>{this.emitReserved("packet",e)},this.setTimeoutFn)}onerror(e){this.emitReserved("error",e)}socket(e,s){let n=this.nsps[e];return n?this._autoConnect&&!n.active&&n.connect():(n=new jn(this,e,s),this.nsps[e]=n),n}_destroy(e){const s=Object.keys(this.nsps);for(const n of s)if(this.nsps[n].active)return;this._close()}_packet(e){const s=this.encoder.encode(e);for(let n=0;n<s.length;n++)this.engine.write(s[n],e.options)}cleanup(){this.subs.forEach(e=>e()),this.subs.length=0,this.decoder.destroy()}_close(){this.skipReconnect=!0,this._reconnecting=!1,this.onclose("forced close")}disconnect(){return this._close()}onclose(e,s){var n;this.cleanup(),(n=this.engine)===null||n===void 0||n.close(),this.backoff.reset(),this._readyState="closed",this.emitReserved("close",e,s),this._reconnection&&!this.skipReconnect&&this.reconnect()}reconnect(){if(this._reconnecting||this.skipReconnect)return this;const e=this;if(this.backoff.attempts>=this._reconnectionAttempts)this.backoff.reset(),this.emitReserved("reconnect_failed"),this._reconnecting=!1;else{const s=this.backoff.duration();this._reconnecting=!0;const n=this.setTimeoutFn(()=>{e.skipReconnect||(this.emitReserved("reconnect_attempt",e.backoff.attempts),!e.skipReconnect&&e.open(a=>{a?(e._reconnecting=!1,e.reconnect(),this.emitReserved("reconnect_error",a)):e.onreconnect()}))},s);this.opts.autoUnref&&n.unref(),this.subs.push(()=>{this.clearTimeoutFn(n)})}}onreconnect(){const e=this.backoff.attempts;this._reconnecting=!1,this.backoff.reset(),this.emitReserved("reconnect",e)}}const at={};function Ot(t,e){typeof t=="object"&&(e=t,t=void 0),e=e||{};const s=Ul(t,e.path||"/socket.io"),n=s.source,a=s.id,o=s.path,i=at[a]&&o in at[a].nsps,c=e.forceNew||e["force new connection"]||e.multiplex===!1||i;let l;return c?l=new Ns(n,e):(at[a]||(at[a]=new Ns(n,e)),l=at[a]),s.query&&!e.query&&(e.query=s.queryKey),l.socket(s.path,e)}Object.assign(Ot,{Manager:Ns,Socket:jn,io:Ot,connect:Ot});const ad=({socket:t,onConnectionSuccess:e})=>{const[s,n]=u.useState("idle"),[a,o]=u.useState(""),[i,c]=u.useState(null),[l,h]=u.useState(null),[d,f]=u.useState([]);u.useEffect(()=>{m()},[]),u.useEffect(()=>{if(t)return t.on("whatsapp:status",x=>{console.log("WhatsApp status update:",x),x.sessionName===l&&(x.status==="WORKING"?(n("connected"),_.success("WhatsApp conectado com sucesso!"),m(),e&&e()):x.status==="FAILED"?(n("failed"),_.error("Falha ao conectar WhatsApp")):x.status==="SCAN_QR_CODE"&&n("qr_ready"))}),()=>{t.off("whatsapp:status")}},[t,l,e]);const m=async()=>{try{const{data:x}=await k.get("/chat/whatsapp/sessions");f(x.sessions.filter(p=>p.status==="WORKING"))}catch(x){console.error("Error loading sessions:",x)}},y=async()=>{var x,p;if(!a.trim()){_.error("Digite um nome para a conex√£o");return}if(!/^[a-zA-Z0-9_]+$/.test(a)){_.error("Use apenas letras, n√∫meros e underscores");return}try{n("creating");const{data:S}=await k.post("/chat/whatsapp/sessions/create",{sessionName:a.toLowerCase()});console.log("Session created:",S),h(a.toLowerCase()),n("starting");const{data:g}=await k.post(`/chat/whatsapp/sessions/${a.toLowerCase()}/start`);console.log("Session started:",g),g.qrCode?(c(g.qrCode.value),n("qr_ready"),_.success("QR Code gerado! Escaneie com seu WhatsApp"),v(a.toLowerCase())):setTimeout(()=>N(a.toLowerCase()),2e3)}catch(S){console.error("Error creating session:",S),_.error(((p=(x=S.response)==null?void 0:x.data)==null?void 0:p.error)||"Erro ao criar conex√£o"),n("failed")}},N=async x=>{try{const{data:p}=await k.get(`/chat/whatsapp/sessions/${x}/qr`);p.qrCode&&(c(p.qrCode.value),n("qr_ready"),v(x))}catch(p){console.error("Error fetching QR code:",p),setTimeout(()=>N(x),2e3)}},v=x=>{const p=async()=>{try{const{data:S}=await k.get(`/chat/whatsapp/sessions/${x}/status`);if(S.session.status==="WORKING"){n("connected"),_.success("WhatsApp conectado com sucesso!"),m(),e&&e();return}else if(S.session.status==="FAILED"){n("failed"),_.error("Falha ao conectar");return}setTimeout(p,3e3)}catch(S){console.error("Error checking status:",S)}};p()},C=()=>{n("idle"),o(""),c(null),h(null)},b=async x=>{try{await k.post(`/chat/whatsapp/sessions/${x.name}/logout`),_.success("Desconectado com sucesso"),m()}catch(p){console.error("Error disconnecting:",p),_.error("Erro ao desconectar")}};return r.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6",children:[r.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[r.jsx(hs,{className:"h-8 w-8 text-green-600"}),r.jsxs("div",{children:[r.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"Conectar WhatsApp"}),r.jsx("p",{className:"text-sm text-gray-600",children:"Conecte seu n√∫mero do WhatsApp ao sistema"})]})]}),d.length>0&&r.jsxs("div",{className:"mb-6 p-4 bg-green-50 rounded-lg border border-green-200",children:[r.jsxs("h3",{className:"font-semibold text-green-800 mb-2 flex items-center gap-2",children:[r.jsx(ds,{className:"h-5 w-5"}),"Conex√µes Ativas"]}),d.map(x=>r.jsxs("div",{className:"flex items-center justify-between py-2",children:[r.jsx("span",{className:"text-green-700 font-medium",children:x.name}),r.jsx("button",{onClick:()=>b(x),className:"text-sm text-red-600 hover:text-red-700 underline",children:"Desconectar"})]},x.name))]}),s==="idle"&&r.jsxs("div",{className:"space-y-4",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Nome da Conex√£o"}),r.jsx("input",{type:"text",value:a,onChange:x=>o(x.target.value),placeholder:"Ex: whatsapp_comercial",className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-green-500",maxLength:50}),r.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Use apenas letras, n√∫meros e underscores (_)"})]}),r.jsxs("button",{onClick:y,className:"w-full bg-green-600 hover:bg-green-700 text-white font-semibold py-3 px-6 rounded-lg flex items-center justify-center gap-2",children:[r.jsx(hs,{className:"h-5 w-5"}),"Conectar WhatsApp"]})]}),(s==="creating"||s==="starting")&&r.jsxs("div",{className:"text-center py-12",children:[r.jsx(Jn,{className:"h-12 w-12 text-green-600 mx-auto mb-4 animate-spin"}),r.jsx("p",{className:"text-gray-600",children:s==="creating"?"Criando conex√£o...":"Gerando QR Code..."})]}),s==="qr_ready"&&i&&r.jsxs("div",{className:"space-y-4",children:[r.jsxs("div",{className:"bg-green-50 border border-green-200 rounded-lg p-4 text-center",children:[r.jsx(Zn,{className:"h-8 w-8 text-green-600 mx-auto mb-2"}),r.jsx("h3",{className:"font-semibold text-green-800 mb-1",children:"QR Code Gerado!"}),r.jsx("p",{className:"text-sm text-green-700",children:"Escaneie com seu WhatsApp para conectar"})]}),r.jsx("div",{className:"bg-white border-4 border-green-500 rounded-lg p-4 flex justify-center",children:r.jsx("img",{src:i,alt:"QR Code WhatsApp",className:"max-w-xs w-full"})}),r.jsxs("div",{className:"text-center space-y-2",children:[r.jsx("p",{className:"text-sm text-gray-600",children:r.jsx("strong",{children:"Como conectar:"})}),r.jsxs("ol",{className:"text-sm text-gray-600 text-left space-y-1 max-w-md mx-auto",children:[r.jsx("li",{children:"1. Abra o WhatsApp no seu celular"}),r.jsxs("li",{children:["2. Toque em ",r.jsx("strong",{children:"Configura√ß√µes"})," ",">"," ",r.jsx("strong",{children:"Aparelhos conectados"})]}),r.jsxs("li",{children:["3. Toque em ",r.jsx("strong",{children:"Conectar um aparelho"})]}),r.jsx("li",{children:"4. Aponte a c√¢mera para este QR Code"})]})]}),r.jsx("button",{onClick:C,className:"w-full bg-gray-100 hover:bg-gray-200 text-gray-700 font-semibold py-2 px-4 rounded-lg",children:"Cancelar"})]}),s==="connected"&&r.jsxs("div",{className:"text-center py-12",children:[r.jsx(ds,{className:"h-16 w-16 text-green-600 mx-auto mb-4"}),r.jsx("h3",{className:"text-xl font-bold text-green-800 mb-2",children:"Conectado com Sucesso!"}),r.jsx("p",{className:"text-gray-600 mb-6",children:"Seu WhatsApp est√° conectado e pronto para usar"}),r.jsx("button",{onClick:C,className:"bg-green-600 hover:bg-green-700 text-white font-semibold py-2 px-6 rounded-lg",children:"Nova Conex√£o"})]}),s==="failed"&&r.jsxs("div",{className:"text-center py-12",children:[r.jsx(ea,{className:"h-16 w-16 text-red-600 mx-auto mb-4"}),r.jsx("h3",{className:"text-xl font-bold text-red-800 mb-2",children:"Falha na Conex√£o"}),r.jsx("p",{className:"text-gray-600 mb-6",children:"N√£o foi poss√≠vel conectar seu WhatsApp"}),r.jsxs("button",{onClick:C,className:"bg-red-600 hover:bg-red-700 text-white font-semibold py-2 px-6 rounded-lg flex items-center justify-center gap-2 mx-auto",children:[r.jsx(ta,{className:"h-5 w-5"}),"Tentar Novamente"]})]})]})},od=()=>{const[t,e]=u.useState([]),[s,n]=u.useState(null),[a,o]=u.useState([]),[i,c]=u.useState(""),[l,h]=u.useState(""),[d,f]=u.useState(""),[m,y]=u.useState(!1),[N,v]=u.useState([]),[C,b]=u.useState(!1),[x,p]=u.useState(null),[S,g]=u.useState(!1),T=u.useRef(null);u.useEffect(()=>{const V=Ot("https://api.nexusatemporal.com.br/api",{auth:{token:localStorage.getItem("token")}});return V.on("connect",()=>{console.log("WebSocket connected");const j=localStorage.getItem("userId");j&&V.emit("auth",{userId:j,token:localStorage.getItem("token")})}),V.on("message:new",j=>{console.log("New message received:",j),s&&j.conversationId===s.id&&(o(R=>[...R,j]),A()),E()}),V.on("conversation:newMessage",j=>{console.log("New conversation message:",j),E()}),p(V),()=>{V.disconnect()}},[]),u.useEffect(()=>{if(x&&s)return x.emit("conversation:join",{conversationId:s.id}),()=>{x.emit("conversation:leave",{conversationId:s.id})}},[x,s]),u.useEffect(()=>{E()},[l,d]),u.useEffect(()=>{s&&(D(s.id),W(s.id))},[s]),u.useEffect(()=>{q()},[]),u.useEffect(()=>{A()},[a]);const A=()=>{var w;(w=T.current)==null||w.scrollIntoView({behavior:"smooth"})},E=async()=>{try{const w=await nt.getConversations({search:l,status:d});e(w)}catch(w){console.error("Error loading conversations:",w),_.error("Erro ao carregar conversas")}},D=async w=>{try{b(!0);const V=await nt.getMessages(w);o(V)}catch(V){console.error("Error loading messages:",V),_.error("Erro ao carregar mensagens")}finally{b(!1)}},q=async()=>{try{const w=await nt.getQuickReplies();v(w)}catch(w){console.error("Error loading quick replies:",w)}},W=async w=>{try{await nt.markAsRead(w),E()}catch(V){console.error("Error marking as read:",V)}},Q=async()=>{if(!(!i.trim()||!s))try{const w=await nt.sendMessage(s.id,{type:"text",content:i});o(V=>[...V,w]),c(""),A(),x&&x.emit("typing:stop",{conversationId:s.id,userId:localStorage.getItem("userId")}),_.success("Mensagem enviada")}catch(w){console.error("Error sending message:",w),_.error("Erro ao enviar mensagem")}},G=()=>{x&&s&&x.emit("typing:start",{conversationId:s.id,userId:localStorage.getItem("userId"),userName:"Voc√™"})},M=w=>{w.key==="Enter"&&!w.shiftKey&&(w.preventDefault(),Q())},$=w=>{c(w.content),y(!1)},We=w=>Vr(new Date(w),"HH:mm",{locale:fs}),se=w=>w?Io(new Date(w),{addSuffix:!0,locale:fs}):"",qe=w=>{switch(w){case"sent":return r.jsx(us,{className:"h-3 w-3 text-gray-400"});case"delivered":return r.jsx(Js,{className:"h-3 w-3 text-gray-400"});case"read":return r.jsx(Js,{className:"h-3 w-3 text-blue-500"});case"pending":return r.jsx(Qe,{className:"h-3 w-3 text-gray-400"});default:return null}},oe=t.filter(w=>!(l&&!w.contactName.toLowerCase().includes(l.toLowerCase())||d&&w.status!==d));return r.jsxs(r.Fragment,{children:[S&&r.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center p-4",children:r.jsxs("div",{className:"bg-white rounded-lg max-w-2xl w-full max-h-[90vh] overflow-y-auto",children:[r.jsxs("div",{className:"p-4 border-b border-gray-200 flex items-center justify-between sticky top-0 bg-white",children:[r.jsx("h2",{className:"text-xl font-bold",children:"Conectar WhatsApp"}),r.jsx("button",{onClick:()=>g(!1),className:"p-2 hover:bg-gray-100 rounded-lg",children:r.jsx(dt,{className:"h-5 w-5"})})]}),r.jsx("div",{className:"p-6",children:r.jsx(ad,{socket:x,onConnectionSuccess:()=>{g(!1),E()}})})]})}),r.jsxs("div",{className:"h-screen flex bg-gray-50",children:[r.jsxs("div",{className:"w-96 bg-white border-r border-gray-200 flex flex-col",children:[r.jsxs("div",{className:"p-4 border-b border-gray-200",children:[r.jsx("h1",{className:"text-xl font-bold text-gray-800 mb-3",children:"Chat"}),r.jsxs("div",{className:"relative",children:[r.jsx(Mr,{className:"absolute left-3 top-2.5 h-5 w-5 text-gray-400"}),r.jsx("input",{type:"text",placeholder:"Buscar conversas...",value:l,onChange:w=>h(w.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-indigo-500"})]}),r.jsxs("div",{className:"flex gap-2 mt-3",children:[r.jsx("button",{onClick:()=>f(""),className:`px-3 py-1.5 text-sm rounded-lg ${d===""?"bg-indigo-100 text-indigo-700":"bg-gray-100 text-gray-600"}`,children:"Todas"}),r.jsx("button",{onClick:()=>f("active"),className:`px-3 py-1.5 text-sm rounded-lg ${d==="active"?"bg-indigo-100 text-indigo-700":"bg-gray-100 text-gray-600"}`,children:"Ativas"}),r.jsx("button",{onClick:()=>f("waiting"),className:`px-3 py-1.5 text-sm rounded-lg ${d==="waiting"?"bg-indigo-100 text-indigo-700":"bg-gray-100 text-gray-600"}`,children:"Aguardando"})]}),r.jsxs("button",{onClick:()=>g(!0),className:"mt-3 w-full bg-green-600 hover:bg-green-700 text-white font-semibold py-2 px-4 rounded-lg flex items-center justify-center gap-2",children:[r.jsx(hs,{className:"h-4 w-4"}),"Conectar WhatsApp"]})]}),r.jsxs("div",{className:"flex-1 overflow-y-auto",children:[oe.map(w=>r.jsx("div",{onClick:()=>n(w),className:`p-4 border-b border-gray-100 cursor-pointer hover:bg-gray-50 ${(s==null?void 0:s.id)===w.id?"bg-indigo-50":""}`,children:r.jsxs("div",{className:"flex items-start gap-3",children:[r.jsx("div",{className:"flex-shrink-0 w-12 h-12 bg-indigo-100 rounded-full flex items-center justify-center",children:r.jsx(Ue,{className:"h-6 w-6 text-indigo-600"})}),r.jsxs("div",{className:"flex-1 min-w-0",children:[r.jsxs("div",{className:"flex items-center justify-between mb-1",children:[r.jsx("h3",{className:"text-sm font-semibold text-gray-900 truncate",children:w.contactName}),r.jsx("span",{className:"text-xs text-gray-500",children:se(w.lastMessageAt)})]}),r.jsx("p",{className:"text-sm text-gray-600 truncate",children:w.lastMessagePreview}),w.tags&&w.tags.length>0&&r.jsx("div",{className:"flex gap-1 mt-1",children:w.tags.slice(0,2).map(V=>r.jsx("span",{className:"px-2 py-0.5 text-xs bg-blue-100 text-blue-700 rounded",children:V},V))})]}),w.isUnread&&w.unreadCount>0&&r.jsx("div",{className:"flex-shrink-0 w-6 h-6 bg-indigo-600 text-white rounded-full flex items-center justify-center text-xs font-bold",children:w.unreadCount})]})},w.id)),oe.length===0&&r.jsx("div",{className:"text-center py-12 text-gray-500",children:r.jsx("p",{children:"Nenhuma conversa encontrada"})})]})]}),s?r.jsxs("div",{className:"flex-1 flex flex-col bg-white",children:[r.jsxs("div",{className:"p-4 border-b border-gray-200 flex items-center justify-between",children:[r.jsxs("div",{className:"flex items-center gap-3",children:[r.jsx("div",{className:"w-10 h-10 bg-indigo-100 rounded-full flex items-center justify-center",children:r.jsx(Ue,{className:"h-5 w-5 text-indigo-600"})}),r.jsxs("div",{children:[r.jsx("h2",{className:"font-semibold text-gray-900",children:s.contactName}),r.jsx("p",{className:"text-sm text-gray-500",children:s.phoneNumber})]})]}),r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx("button",{className:"p-2 hover:bg-gray-100 rounded-lg",children:r.jsx(zt,{className:"h-5 w-5 text-gray-600"})}),r.jsx("button",{className:"p-2 hover:bg-gray-100 rounded-lg",children:r.jsx(sa,{className:"h-5 w-5 text-gray-600"})}),r.jsx("button",{className:"p-2 hover:bg-gray-100 rounded-lg",children:r.jsx(ra,{className:"h-5 w-5 text-gray-600"})})]})]}),r.jsx("div",{className:"flex-1 overflow-y-auto p-4 space-y-4 bg-gray-50",children:C?r.jsx("div",{className:"text-center py-12 text-gray-500",children:"Carregando mensagens..."}):r.jsxs(r.Fragment,{children:[a.map(w=>r.jsx("div",{className:`flex ${w.direction==="outgoing"?"justify-end":"justify-start"}`,children:r.jsxs("div",{className:`max-w-md px-4 py-2 rounded-lg ${w.direction==="outgoing"?"bg-indigo-600 text-white":"bg-white text-gray-900 border border-gray-200"}`,children:[w.content&&r.jsx("p",{className:"text-sm",children:w.content}),r.jsxs("div",{className:"flex items-center justify-end gap-1 mt-1",children:[r.jsx("span",{className:"text-xs opacity-75",children:We(w.createdAt)}),w.direction==="outgoing"&&qe(w.status)]})]})},w.id)),r.jsx("div",{ref:T})]})}),m&&r.jsxs("div",{className:"border-t border-gray-200 bg-white p-3 max-h-48 overflow-y-auto",children:[r.jsxs("div",{className:"flex items-center justify-between mb-2",children:[r.jsx("h3",{className:"text-sm font-semibold text-gray-700",children:"Respostas R√°pidas"}),r.jsx("button",{onClick:()=>y(!1),className:"text-gray-400 hover:text-gray-600",children:r.jsx(dt,{className:"h-4 w-4"})})]}),r.jsx("div",{className:"grid grid-cols-2 gap-2",children:N.slice(0,6).map(w=>r.jsx("button",{onClick:()=>$(w),className:"text-left p-2 text-sm bg-gray-100 hover:bg-gray-200 rounded-lg truncate",children:w.title},w.id))})]}),r.jsx("div",{className:"p-4 border-t border-gray-200 bg-white",children:r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx("button",{onClick:()=>y(!m),className:"p-2 hover:bg-gray-100 rounded-lg",title:"Respostas R√°pidas",children:r.jsx(na,{className:"h-5 w-5 text-gray-600"})}),r.jsx("button",{className:"p-2 hover:bg-gray-100 rounded-lg",children:r.jsx(aa,{className:"h-5 w-5 text-gray-600"})}),r.jsx("button",{className:"p-2 hover:bg-gray-100 rounded-lg",children:r.jsx(oa,{className:"h-5 w-5 text-gray-600"})}),r.jsx("input",{type:"text",placeholder:"Digite uma mensagem...",value:i,onChange:w=>{c(w.target.value),G()},onKeyPress:M,className:"flex-1 px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-indigo-500"}),r.jsx("button",{className:"p-2 hover:bg-gray-100 rounded-lg",children:r.jsx(ia,{className:"h-5 w-5 text-gray-600"})}),i.trim()?r.jsx("button",{onClick:Q,className:"p-2 bg-indigo-600 hover:bg-indigo-700 text-white rounded-lg",children:r.jsx(ca,{className:"h-5 w-5"})}):r.jsx("button",{className:"p-2 hover:bg-gray-100 rounded-lg",children:r.jsx(la,{className:"h-5 w-5 text-gray-600"})})]})})]}):r.jsx("div",{className:"flex-1 flex items-center justify-center bg-gray-50",children:r.jsxs("div",{className:"text-center",children:[r.jsx("div",{className:"w-24 h-24 bg-gray-200 rounded-full mx-auto mb-4 flex items-center justify-center",children:r.jsx(Ue,{className:"h-12 w-12 text-gray-400"})}),r.jsx("h2",{className:"text-xl font-semibold text-gray-700 mb-2",children:"Selecione uma conversa"}),r.jsx("p",{className:"text-gray-500",children:"Escolha uma conversa para come√ßar a conversar"})]})})]})]})};function le({children:t}){const{isAuthenticated:e}=ft();return e?r.jsx(r.Fragment,{children:t}):r.jsx(Tr,{to:"/login",replace:!0})}const id="/assets/favicon-BpAW-oFG.png",Ar=[{icon:ua,label:"Dashboard",path:"/dashboard"},{icon:ls,label:"Leads",path:"/leads"},{icon:Or,label:"Chat",path:"/chat"},{icon:ks,label:"Agenda",path:"/agenda"},{icon:Lr,label:"Prontu√°rios",path:"/prontuarios"},{icon:_r,label:"Financeiro",path:"/financeiro"},{icon:ha,label:"Estoque",path:"/estoque"},{icon:ma,label:"Colabora√ß√£o",path:"/colaboracao"},{icon:fa,label:"BI & Analytics",path:"/bi"},{icon:ga,label:"Marketing",path:"/marketing"},{icon:pa,label:"Configura√ß√µes",path:"/settings"}];function de({children:t}){var l,h;const[e,s]=u.useState(!0),n=Rr(),a=Vt(),{user:o,logout:i}=ft(),c=async()=>{await i(),a("/login")};return r.jsxs("div",{className:"flex h-screen bg-gray-100 dark:bg-gray-900",children:[r.jsxs("aside",{className:`${e?"w-64":"w-20"} bg-white dark:bg-gray-800 border-r border-gray-200 dark:border-gray-700 transition-all duration-300 flex flex-col`,children:[r.jsxs("div",{className:"h-16 flex items-center justify-between px-4 border-b border-gray-200 dark:border-gray-700",children:[e?r.jsx("img",{src:Ss,alt:"Nexus Atemporal",className:"h-10"}):r.jsx("img",{src:id,alt:"Nexus Atemporal",className:"h-8"}),r.jsx("button",{onClick:()=>s(!e),className:"p-2 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-700",children:e?r.jsx(dt,{size:20}):r.jsx(da,{size:20})})]}),r.jsx("nav",{className:"flex-1 overflow-y-auto py-4",children:Ar.map(d=>{const f=d.icon,m=n.pathname===d.path;return r.jsxs(Lt,{to:d.path,className:`flex items-center px-4 py-3 mx-2 rounded-lg transition-colors ${m?"bg-primary-100 dark:bg-primary-900/20 text-primary-600":"text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700"}`,children:[r.jsx(f,{size:20,className:"flex-shrink-0"}),e&&r.jsx("span",{className:"ml-3",children:d.label})]},d.path)})}),r.jsx("div",{className:"border-t border-gray-200 dark:border-gray-700 p-4",children:e?r.jsxs("div",{children:[r.jsxs("div",{className:"flex items-center mb-3",children:[r.jsx("div",{className:"w-10 h-10 rounded-full bg-primary-600 flex items-center justify-center text-white font-bold",children:(l=o==null?void 0:o.name)==null?void 0:l.charAt(0).toUpperCase()}),r.jsxs("div",{className:"ml-3 flex-1",children:[r.jsx("p",{className:"text-sm font-medium",children:o==null?void 0:o.name}),r.jsx("p",{className:"text-xs text-gray-500",children:o==null?void 0:o.role})]})]}),r.jsxs("button",{onClick:c,className:"w-full flex items-center px-3 py-2 text-red-600 hover:bg-red-50 dark:hover:bg-red-900/20 rounded-lg transition-colors",children:[r.jsx(Zs,{size:18}),r.jsx("span",{className:"ml-2",children:"Sair"})]})]}):r.jsx("button",{onClick:c,className:"w-full flex items-center justify-center p-2 text-red-600 hover:bg-red-50 dark:hover:bg-red-900/20 rounded-lg",children:r.jsx(Zs,{size:20})})})]}),r.jsxs("div",{className:"flex-1 flex flex-col overflow-hidden",children:[r.jsxs("header",{className:"h-16 bg-white dark:bg-gray-800 border-b border-gray-200 dark:border-gray-700 flex items-center justify-between px-6",children:[r.jsx("h2",{className:"text-xl font-semibold",children:((h=Ar.find(d=>d.path===n.pathname))==null?void 0:h.label)||"Dashboard"}),r.jsx("div",{className:"flex items-center space-x-4",children:r.jsx("span",{className:"text-sm text-gray-600 dark:text-gray-400",children:o==null?void 0:o.email})})]}),r.jsx("main",{className:"flex-1 overflow-y-auto p-6",id:"main-content",children:t})]})]})}const cd=new Dn({defaultOptions:{queries:{refetchOnWindowFocus:!1,retry:1}}});function ld(){return r.jsxs(Pn,{client:cd,children:[r.jsx(In,{children:r.jsxs(Bn,{children:[r.jsx(te,{path:"/login",element:r.jsx(ba,{})}),r.jsx(te,{path:"/register",element:r.jsx(va,{})}),r.jsx(te,{path:"/",element:r.jsx(le,{children:r.jsx(de,{children:r.jsx(Tr,{to:"/dashboard",replace:!0})})})}),r.jsx(te,{path:"/dashboard",element:r.jsx(le,{children:r.jsx(de,{children:r.jsx(wa,{})})})}),r.jsx(te,{path:"/leads",element:r.jsx(le,{children:r.jsx(de,{children:r.jsx(dl,{})})})}),r.jsx(te,{path:"/chat",element:r.jsx(le,{children:r.jsx(de,{children:r.jsx(od,{})})})}),r.jsx(te,{path:"/agenda",element:r.jsx(le,{children:r.jsx(de,{children:r.jsxs("div",{className:"text-center py-12",children:[r.jsx("h2",{className:"text-2xl font-bold mb-4",children:"Agenda"}),r.jsx("p",{className:"text-gray-600",children:"Em desenvolvimento..."})]})})})}),r.jsx(te,{path:"/prontuarios",element:r.jsx(le,{children:r.jsx(de,{children:r.jsxs("div",{className:"text-center py-12",children:[r.jsx("h2",{className:"text-2xl font-bold mb-4",children:"Prontu√°rios"}),r.jsx("p",{className:"text-gray-600",children:"Em desenvolvimento..."})]})})})}),r.jsx(te,{path:"/financeiro",element:r.jsx(le,{children:r.jsx(de,{children:r.jsxs("div",{className:"text-center py-12",children:[r.jsx("h2",{className:"text-2xl font-bold mb-4",children:"Financeiro"}),r.jsx("p",{className:"text-gray-600",children:"Em desenvolvimento..."})]})})})}),r.jsx(te,{path:"/estoque",element:r.jsx(le,{children:r.jsx(de,{children:r.jsxs("div",{className:"text-center py-12",children:[r.jsx("h2",{className:"text-2xl font-bold mb-4",children:"Estoque"}),r.jsx("p",{className:"text-gray-600",children:"Em desenvolvimento..."})]})})})}),r.jsx(te,{path:"/colaboracao",element:r.jsx(le,{children:r.jsx(de,{children:r.jsxs("div",{className:"text-center py-12",children:[r.jsx("h2",{className:"text-2xl font-bold mb-4",children:"Colabora√ß√£o"}),r.jsx("p",{className:"text-gray-600",children:"Em desenvolvimento..."})]})})})}),r.jsx(te,{path:"/bi",element:r.jsx(le,{children:r.jsx(de,{children:r.jsxs("div",{className:"text-center py-12",children:[r.jsx("h2",{className:"text-2xl font-bold mb-4",children:"BI & Analytics"}),r.jsx("p",{className:"text-gray-600",children:"Em desenvolvimento..."})]})})})}),r.jsx(te,{path:"/marketing",element:r.jsx(le,{children:r.jsx(de,{children:r.jsxs("div",{className:"text-center py-12",children:[r.jsx("h2",{className:"text-2xl font-bold mb-4",children:"Marketing"}),r.jsx("p",{className:"text-gray-600",children:"Em desenvolvimento..."})]})})})}),r.jsx(te,{path:"/settings",element:r.jsx(le,{children:r.jsx(de,{children:r.jsxs("div",{className:"text-center py-12",children:[r.jsx("h2",{className:"text-2xl font-bold mb-4",children:"Configura√ß√µes"}),r.jsx("p",{className:"text-gray-600",children:"Em desenvolvimento..."})]})})})})]})}),r.jsx(xa,{position:"top-right"})]})}ms.createRoot(document.getElementById("root")).render(r.jsx(z.StrictMode,{children:r.jsx(ld,{})}));
